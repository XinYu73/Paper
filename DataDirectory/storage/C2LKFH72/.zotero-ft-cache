ATOMISTIC SPIN DYNAMICS

Atomistic Spin Dynamics
Foundations and Applications
Olle Eriksson
Department of Physics and Astronomy, Uppsala University, Box 516, SE-751 20 Uppsala, Sweden
Anders Bergman
Department of Physics and Astronomy, Uppsala University, Box 516, SE-751 20 Uppsala, Sweden
Lars Bergqvist
Department of Materials and Nano Physics, KTH Royal Institute of Technology, Electrum 229, SE-164 40 Kista, Sweden
Johan Hellsvik
Department of Materials and Nano Physics, KTH Royal Institute of Technology, Electrum 229, SE-164 40 Kista, Sweden
3

3
Great Clarendon Street, Oxford, OX2 6DP, United Kingdom
Oxford University Press is a department of the University of Oxford. It furthers the University’s objective of excellence in research, scholarship, and education by publishing worldwide. Oxford is a registered trade mark of
Oxford University Press in the UK and in certain other countries
© Olle Eriksson, Anders Bergman, Lars Bergqvist, Johan Hellsvik 2017
The moral rights of the authors have been asserted
First Edition published in 2017 Impression: 1
All rights reserved. No part of this publication may be reproduced, stored in a retrieval system, or transmitted, in any form or by any means, without the prior permission in writing of Oxford University Press, or as expressly permitted by law, by licence or under terms agreed with the appropriate reprographics rights organization. Enquiries concerning reproduction outside the scope of the above should be sent to the Rights Department, Oxford University Press, at the
address above
You must not circulate this work in any other form and you must impose this same condition on any acquirer
Published in the United States of America by Oxford University Press 198 Madison Avenue, New York, NY 10016, United States of America
British Library Cataloguing in Publication Data Data available
Library of Congress Control Number: 2016938429
ISBN 978–0–19–878866–9
Printed and bound by CPI Group (UK) Ltd, Croydon, CR0 4YY
Links to third party websites are provided by Oxford in good faith and for information only. Oxford disclaims any responsibility for the materials
contained in any third party website referenced in this work.

Preface
The purpose of this book is to provide a theoretical foundation and an understanding of atomistic spin dynamics and to give examples of where the atomistic Landau–Lifshitz– Gilbert equation can and should be used. The choice of an atomistic description of magnetization dynamics, instead of using a continuous vector ﬁeld, as is done in micromagnetic simulations, has several advantages. First, as argued in this book, the building block of materials is the atom, and hence a description of magnetism in an atomistic way is very natural and allows for an interpretation of experimental results in a deeper and clearer way. This description also allows for calculations, from ﬁrst principles, of all parameters needed to perform the spin dynamics simulations, without using experimental results as input to the simulations. In addition, atomistic spin dynamics simulations experience no problems with treating anti ferromagnets or ferri magnets. The contents presented in this book involve a description of density functional theory both from a fundamental viewpoint as well as a practical one, with several examples of how this theory can be used for the evaluation of ground-state properties like spin and orbital moments, magnetic form factors, magnetic anisotropy, Heisenberg exchange parameters, and the Gilbert damping parameter. This book also outlines how interatomic exchange interactions are relevant for the effective ﬁeld used in the temporal evolution of atomistic spins. The equation of motion for atomistic spin dynamics is derived, starting from the quantum mechanical equation of motion of the spin operator. It is shown that this leads to the atomistic Landau–Lifshitz–Gilbert equation, provided a Born–Oppenheimer-like approximation is made, where the motion of atomic spins is considered slower than that of the electrons. It is also described how ﬁnite temperature effects may enter the theory of atomistic spin dynamics, via Langevin dynamics. Details of the practical implementation of the resulting stochastic differential equation are provided, and several examples illustrating the accuracy and importance of this method are given. Examples are given of how atomistic spin dynamics reproduce experimental data for magnon dispersion of bulk and thin ﬁlm systems, the damping parameter, the formation of skyrmionic states, all-thermal switching motion, and ultrafast magnetization measurements.
On a historical note, early and seminal steps were taken by Antropov et al. (1995, 1996) and by Stocks et al. (1998). There were also independent developments by Nowak et al. (2005) and Kazantseva et al. (2008), as reviewed by Evans et al. (2014) and Skubic et al. (2008). The results presented in this book reliy on the initial methodology, and subsequent improvements, of the UppASD method presented by Skubic et al. (2008). Among more recently developed methods for solving the atomistic spin dynamics problem, one may note the method developed by Thonig (2013). It is also noteworthy that other textbooks covering modern magnetization dynamics have been published (see e.g. Stöhr and Siegmann, 2006; Bertotti et al., 2009).

Acknowledgements
We would like to acknowledge fruitful discussions and a great collaboration with the following colleagues (in alphabetical order):
I. A. Abrikosov, B. Alling, G. Andersson, Y. Andersson, V. Antropov, P. Bessarab, S. Blügel, N. Bondarenko, A. Burlamaquie-Klautau, J. Chico, R. Chimata, M. Costa, R. de Almeida, I. di Marco, P. H. Dederichs, E. Delczeg, A. Delin, H. Ebert, A. Edström, S. Engblom, C. Etz, N. Fejes, J. Fransson, L. Genovese, A. Grechnev, O. Grånäs, J. Henk, B. Hjörvarsson, D. Ius¸an, A. Jacobsson, B. Johansson, K. Kádas, O. Karis, M. I. Katsnelson, A. Kimel, A. Kirilyuk, R. Knut, K. Koumpouras, G. Kreiss, J. Kudrnovský, Y. Kvashnin, A. I. Lichtenstein, J. Lorenzana, S. Mankovsky, D. Meier, J. H. Mentink, K. Modin, P. Nordblad, L. Nordström, T. Nystrand, P. Oppeneer, F. Pan, S. Panda, M. Pereiro, S. Picozzi, M. Poluektov, Th. Rasing, D. Rodriques, J. Rusz, B. Sanyal, B. Skubic, A. Stroppa, P. Svedlindh, A. Szilva, L. Szunyogh, A. Taroni, D. Thonig, P. Thunström, I. Turek, L. Udvardi, L. Vitos, J. Werpers, J. M. Wills, D. Yudin, and J. Åkerman
The authors also acknowledge support from the Swedish Research Council (VR), eSSENCE, the Swedish e-Science Research Centre (SeRC), the Knut and Alice Wallenberg (KAW) Foundation (grants 2012.0031 and 2013.0020), and the Göran Gustafsson Foundation (GGS).

Contents

Part 1 Density Functional Theory and its Applications to Magnetism

1 Density Functional Theory

3

1.1 Background of the many-electron problem

3

1.2 The Hartree–Fock theory

4

1.3 The Hohenberg–Kohn theorems

6

1.4 The Kohn–Sham equation

9

1.5 Non-collinear magnetism, and time-dependent density functional theory 14

2 Aspects of the Solid State

17

2.1 Crystal systems and space groups

17

2.2 The Born–von Karman boundary condition, and Bloch waves

18

2.3 A variational procedure to obtain eigenvalues

20

2.4 Density of states

24

2.5 Relativistic effects

25

2.6 Green’s function formalism, Heisenberg exchange, and a

multiscale approach to spin dynamics

29

3 Applications of Density Functional Theory

33

3.1 Cohesive and structural properties

33

3.2 Spin and orbital moments, and the magnetic form factor

40

3.3 Magnetic anisotropy energy

44

3.4 Heisenberg exchange parameters

47

3.5 Non-collinear magnets

49

Part 2 Equation of Motion for Atomistic Spin Dynamics

4 The Atomistic Spin Dynamics Equation of Motion

55

4.1 A few introductory comments

55

4.2 Spin dynamics from ﬁrst principles

56

4.3 Equations of motion for the spin and charge densities

57

4.4 Local coordinate systems and the adiabatic approximation

59

4.5 The atomic moment approximation and constraining ﬁeld

62

4.6 Damping motion and relaxation

64

4.7 The relation between the Landau–Lifshitz and the Landau–

Lifshitz–Gilbert equations

67

4.8 The magnetic Hamiltonian

69

viii Contents

5 Spin Dynamics at Finite Temperature

73

5.1 Langevin dynamics

73

5.2 Stochastic differential equations

76

5.3 Finite difference approximations to stochastic differential

equations and the choice of stochastic calculus

78

5.4 Fluctuation–dissipation relations for the stochastic Landau–

Lifshitz equation

79

5.4.1 The stochastic Landau–Lifshitz equation in the form of

the Langevin equation

80

5.4.2 The Fokker–Planck equation

80

5.4.3 Fluctuation–dissipation relations with quantum

corrections

83

5.5 Conservation properties of the Landau–Lifshitz equation

83

5.6 Finite temperature exchange

86

5.7 Some ﬁnal comments

88

6 The Damping Term, from First Principles

89

6.1 Background

89

6.2 The breathing Fermi surface

90

6.3 The torque correlation model

93

6.4 The linear response formulation

96

6.5 Inclusion of disorder and temperature effects

98

6.6 Symmetry analysis of the damping tensor

102

7 Implementation

104

7.1 UppASD

104

7.2 The effective magnetic ﬁeld

105

7.2.1 Neighbour lists

105

7.2.2 Contributions to the effective ﬁeld

107

7.3 Spin-transfer torque

108

7.4 Numerical integration of the Landau–Lifshitz and stochastic

Landau–Lifshitz equations

109

7.4.1 Properties of integrators

110

7.4.2 Overview of stochastic Landau–Lifshitz integrators

111

7.4.3 The dimensionless and normalized SLLG equation

112

7.4.4 Heun with projection

114

7.4.5 The geometric Depondt–Mertens method

115

7.4.6 The IMP method

116

7.4.7 The McLachlan–Modin–Verdier SMP method

117

7.4.8 Mentink’s SIB method

118

7.4.9 Comparison of solvers

119

7.4.10 Random number generation, and statistics

119

7.5 Extraction of observables 7.5.1 Trajectory-based observables 7.5.2 Correlation functions 7.5.3 Correlation functions and Fourier transforms 7.5.4 Sampling, averaging, and post-processing 7.5.5 Thermodynamic observables
7.6 Aspects of efﬁciency and optimization 7.7 Parallelization approaches
7.7.1 Shared memory parallelization 7.7.2 Distributed memory parallelization 7.7.3 GPU parallelization
Part 3 Applications
8 Ferromagnetic Resonance
8.1 Experimental set-up and demagnetization ﬁeld 8.2 Kittel equations
8.2.1 Damping and anisotropy ignored 8.2.2 Including anisotropy 8.2.3 Full treatment including damping 8.3 The Smit–Suhl equation 8.4 Spin wave resonance
9 Magnons
9.1 Spin excitations in solids 9.2 Experimental methods 9.3 Adiabatic magnon spectra and the frozen magnon method 9.4 Dynamical magnetic susceptibility 9.5 Surface magnons from atomistic spin dynamics
9.5.1 Thin ﬁlms of Co on Cu substrates 9.5.2 A comparison of approaches 9.5.3 Fe on Cu(001) 9.5.4 Fe on Ir(001) 9.5.5 Fe on W(110) 9.6 Relativistic effects 9.7 Magnon lifetimes
10 Skyrmions
10.1 Background 10.2 Magnetism and topology 10.3 Magnetic skyrmions 10.4 Theoretical prediction and experimental identiﬁcation 10.5 Dimensionality and stability

Contents ix
121 121 123 126 127 128 129 131 131 132 135
139
139 141 141 143 143 151 153
154
154 158 160 167 169 170 175 175 177 178 181 182
185
185 186 187 188 190

x Contents

10.6 From lattices to individual skyrmions

193

10.7 Magnetization dynamics and modelling

194

11 Ultrafast Switching Dynamics

198

11.1 Background

198

11.2 Energy barriers, domains, and domain walls

200

11.3 Macrospin switching

202

11.4 Internal-ﬁeld-assisted switching

203

11.5 Inertia-like switching

205

11.6 Domain wall motion

207

11.7 Ultrafast demagnetization: face-centred cubic Ni as an example

208

11.8 The three-temperature model

210

11.9 All-optical magnetization reversal

212

Part 4 Conclusions and Outlook

12 Outlook on Magnetization Dynamics

219

12.1 Hierarchy of time scales and length scales

219

12.2 Non-locality in space and time

221

12.3 Exchange–correlation potentials

222

12.4 Time-dependent density functional theory,

and optimal control theory

224

12.5 Adiabatic ab initio atomistic spin dynamics

225

12.6 Longitudinal spin ﬂuctuations in atomistic spin dynamics

225

12.7 A multiscale approach to atomistic spin dynamics

226

12.8 Combined spin–lattice simulations

228

12.9 Conclusions

229

References

231

Index

253

Part 1
Density Functional Theory and its Applications to Magnetism
Density functional theory (DFT) has been an invaluable tool for understanding and analysing the magnetism of materials. In the three introductory chapters forming Part 1, we review the most central and important features of this theory and give examples of magnetic properties that are accessible with this theory. We start this description with the well-established Hartree–Fock theory, to demonstrate the principal mechanism of intra-atomic spin pairing. The master equation of DFT, the so-called Kohn–Sham equation, is derived, and we show how it can be used for spin polarized calculations of spin and orbital moments, for magnetic form factors, for magnetic anisotropy, and for inter atomic (Heisenberg) exchange parameters. We also describe special considerations of this equation when applied to the solid state. We cover both translational and rotational symmetries, as well as complications that emerge when spin–orbit coupling is included in the calculations. Also outlined in Part 1 of this book is how concepts from DFT can be used for a multiscale approach to atomistic spin dynamics simulations. Hence, Part 1 shows how DFT calculations of only a few atoms can be used to enable simulations of billions of atomic spins. Throughout these three chapters, theoretical results are compared to existing experimental data, and the level of agreement between theory and observation is discussed.

1 Density Functional Theory

Density functional theory has been established as a very practical platform for modelling, from ﬁrst principles, the electronic, optical, mechanical, cohesive, magnetic, and structural properties of materials. Starting from the Schrödinger equation for the manybody system of electrons and nuclei, an effective theory has been developed allowing for material-speciﬁc and parameter-free simulations of non-magnetic as well as magnetic materials. In this chapter, an introduction will be given to density functional theory, the Hohenberg–Kohn theorems, the Kohn–Sham equation, and the formalism for how to deal with spin polarization and non-collinear magnetism.

1.1 Background of the many-electron problem

The basic problem in calculating the electronic structure and related properties of a material concerns how to deal mathematically with the interactions of a very large number of particles. To be more detailed, the Hamiltonian, in the non-relativistic case, can be written in terms of coordinates of electrons and nuclei and their kinetic energy in the following way:

Hˆ = – h¯2 2

I

∇I2 + 1

1 ZI ZJe2 – h¯2

MI 2 I =J 4π 0 |RI – RJ | 2m

i

∇i2

1 +

1 e2 –

1 ZI e2 ,

2 i=j 4π 0 |ri – rj | i,I 4π 0 |ri – RI |

(1.1)

where the indices i, j denote electrons; I, J are for atomic nuclei; and the masses are
denoted MI for nuclei, and m for electrons. Furthermore, RI and ri stand for nucleus and electron coordinates, respectively, whereas ZI denotes atomic number. In the following, we will adopt Hartree atomic units, that is, e = m = h¯ = 4π 0 = 1. Since nuclei are much heavier than electrons, one may adopt the Born–Oppenheimer approximation and
assume that the nuclei are ﬁxed, while the electrons are dynamic objects. This allows, one to deal with electron states separately from the atomic nuclei. Thus, we are left ’only’

Atomistic Spin Dynamics. Olle Eriksson, Anders Bergman, Lars Bergqvist, Johan Hellsvik. First Edition. © Olle Eriksson, Anders Bergman, Lars Bergqvist, Johan Hellsvik 2017. First published in 2017 by Oxford University Press.

4 Density Functional Theory

with the description of the electron system, and the Hamiltonian acting on the electrons is written as

Hˆ

=

1 –

2

i

∇i2

+

1 2

i =j

1 –
|ri – rj|

i,I

|ri

ZI – RI |

= Tˆ

+Wˆ

+Vˆ ext.

(1.2)

Here, Tˆ is the kinetic energy operator of the electrons, Wˆ is the operator determining the Coulomb energy of electron–electron interactions, and Vˆ ext is the external poten-
tial accounting for the Coulomb interactions between the electrons and the nuclei. The corresponding total energy E is the expectation value ofHˆ , that is

E = Hˆ = T + W + d3r Vext(r)n(r),

(1.3)

with T and W denoting the expectation values of the kinetic energy and electron– electron interaction operators, respectively, and n(r) denoting the electron charge density.

1.2 The Hartree–Fock theory

The Hartree–Fock theory, discussed in several textbooks, (e.g. in Atkins and Friedman, 2005), assumes that electrons interact in a mean ﬁeld fashion; it follows from approximating the many-electron wave function with a single Slater determinant constructed from the single-particle wave function ψ in the following way:

1 (x1, x2, . . . , xi, . . . , xN ) = √ det[ψi(xj)],
N

(1.4)

where x is a composite coordinate of space and spin of an electron, N is the number of electrons, and we have used a compact expression for the Slater determinant. Forming the expectation value of the electron Hamiltonian with this approximate manyelectron wave function yields an expression of the total energy. Minimization of this energy expression with respect to the single-particle wave functions that compose the Slater determinant gives the Hartree–Fock equation:

⎛

⎝–

1 2

∇i2

+

Vext(r)

+

i =j

⎞

dr

ψ∗j (x |ri

)ψj (x – rj|

)⎠

ψi (x)

–
i =j

dr

ψ∗j (x |ri

)ψi (x – rj|

)

ψj

(x)δsi

sj

=

i ψi (x),

(1.5)

where Vext represents the electron–nucleus interaction. This equation is similar to the Schrödinger equation for electrons that move in a potential and, in fact, the ﬁrst two

The Hartree–Fock theory 5
terms that follow the kinetic energy in Eqn (1.5) represent the effective potential that an electron experiences because of its attractive interaction with the nucleus and its repulsive interaction with all other electrons in the system (this interaction is referred to as the Hartree term; Atkins and Friedman, 2005). The last term on the left-hand side of Eqn (1.5) is referred to as the exchange interaction; it is active only if the spins of electrons i and j are the same, and is hence a term that lowers the energy if as many spins as possible have the same direction. This spin pairing (Jorgensen, 1962) is responsible for the fact that most atoms of the Periodic Table have a ground-state electronic conﬁguration with a maximized number of parallel spins, provided that, the Pauli exclusion principle is obeyed. This microscopic mechanism behind Hund’s ﬁrst rule follows, interestingly, from a Hamiltonian that has no spin-dependent terms in it, Eqn (1.2). It is entirely quantum mechanical in nature and follows from the requirement that the wave function should be antisymmetric with respect to permutation of the coordinates of any two electrons. Note that, in Eqn (1.5), we have explicitly kept electron i from

Spin-pairing energy (eV)

10

Lanthanides

Actinides

9

8

7

6

5

4

3

2

1

1 2 3 4 5 6 7 8 9 10 11 12 13 Figure 1.1 Spin-pairing energy of actinides

Number of f-electrons

and lanthanides.

6 Density Functional Theory
interacting with itself, thus adopting a physically meaningful approach. If, however, we allow for the summations in Eqn (1.5) to also include terms where i = j, we would not introduce an error, since then the extra interaction in the Hartree term would be cancelled exactly by the extra interaction of the exchange, or Fock, term. This is easily seen by setting i = j in the subscript of the wave functions of Eqn (1.5). This is normally described as the lack of self-interaction in the Hartree–Fock equation, and is relevant when discussing approximations to density functional theory, as will be discussed in Section 1.4. It should also be noted that the interactions in the Hartree–Fock equation are non-local, meaning that they involve interactions over distances described by |ri – rj|.
In order to illustrate the strength of the spin-pairing energy as deﬁned by Jorgensen (1962), Fig. 1.1 shows the experimental values of the spin-pairing energy of lanthanides and actinides for the f -shell (Nugent, 1970). Note that the energies involved can be rather large, of the order of 10 eV. Hence, discussions of, for example, ultrafast demagnetization using intense laser pulses must take these strong intra-shell couplings into consideration. It is also clear from the ﬁgure that spin pairing is slightly larger for the lanthanide series than for the actinide series, because the 4f wave function is less extended in the lathanide series than in the actinide series and thus forces the electrons of the 4f shell to occupy a smaller volume than those in the 5f shell do. For this reason, the exchange energy is larger for the lanthanides than for the actinides, as may be seen from Eqn (1.5).

1.3 The Hohenberg–Kohn theorems

Using the Hartree–Fock theory is a rather time-consuming approach, especially when dealing with electronic structures of large systems and when dealing with solids. For this reason, other approaches have been explored, where maybe the most successful one is that provided by density functional theory (Hohenberg and Kohn, 1964; W. Kohn and Sham, 1965). This theory allows the use of the charge density, n(r), and magnetization density, m(r), of a system to be used as the key quantities that describe the ground-state properties. In this way, one avoids having to work with a many-electron wave function. Instead, one can resort to the single-electron theory of solids as is described in Sections 1.3 and 1.4. We give ﬁrst, however, the foundation of density functional theory, which is based on the following two theorems.

Theorem 1.1 The total energy of a system is a unique functional of the ground–state electron density.

To demonstrate this, we consider the expectation value of Eqn (1.3). We evaluate the ground-state many-body wave function gs(r1, r2, . . . , rN ) for N electrons and their energy from the equation

Hˆ gs = Egs gs. The electron density of this ground-state can be calculated from

(1.6)

The Hohenberg–Kohn theorems 7

N
ngs(r) =
i=1

d3ri | gs(r1, r2, . . . .rN ) |2 δ(r – ri).

(1.7)

We will now demonstrate that using two different external potentials in Eqn (1.3), for
example, Vext and Vext, gives rise to two different ground-state electron densities: ngs and ngs, respectively. For simplicity, we consider ﬁrst a non-spin polarized system, with m = 0. To show this, we note ﬁrst that, for the system with external potential Vext, we have

Hˆ gs = Egs gs.

(1.8)

From the variational principles, it follows that

Egs = gs Hˆ gs < gs Hˆ gs .

(1.9)

To estimate the energy of the rightmost term of Eqn (1.9), we add and subtract Vext to the expectation value so that

gs Hˆ gs = gs Hˆ + Vext – Vext gs = gs Hˆ + Vext – Vext gs .

(1.10)

This allows us to write

gs Hˆ gs = Egs + ngs(Vext – Vext) d3r.

(1.11)

Note that, in this expression, we have, for simplicity, omitted to write out the rdependence of the external potential and density. Combining Eqns (1.9) and (1.11) yields the relationship

Egs < Egs + ngs(Vext – Vext) d3r.

(1.12)

We could start all over from Eqn (1.9) and, going to Eqn (1.11), arrive at an expression similar to Eqn (1.12) but with all primed and unprimed symbols being interchanged, that is, the following expression would also follow from the variational principle:

Egs < Egs + ngs(Vext – Vext) d3r.

(1.13)

If we now assume that ngs = ngs, an absurd relationship follows, since we can replace ngs in Eqn (1.12) with ngs and then add Eqns (1.12) and (1.13) together to obtain

Egs + Egs < Egs + Egs + ngs(Vext – Vext) d3r + ngs(Vext – Vext) d3r,

(1.14)

8 Density Functional Theory

V V´

n n´

V-space

n-space

Figure 1.2 Schematic ﬁgure showing the connection between external potential (V -space) and ground-state density (n-space).

from which it would follow that Egs + Egs < Egs + Egs. This is clearly a result that is incorrect. Since deriving it follows from the rules of quantum mechanics, plus one assumption, we must conclude that this initial assumption was wrong, that is, that ngs and ngs cannot be equal. Figure 1.2 shows a schematic of the relationship between external potential and electron density, following the above analysis of density functional theory. According to this ﬁgure, two different external potentials can never point to the same ground-state density; they exclusively will identify unique and separate groundstate densities. In addition, there are no points in n-space that cannot be reached from a point in V -space. Mathematically, such mappings are called bijective.
So far in this discussion, we have made the derivation following the direction of the arrows in Fig. 1.2, namely, starting from different potentials in V -space always results in unique positions in n-space. In principle, it is possible to follow these arrows backwards, starting from the ground state density and ending up in a unique spot of V -space, with this spot uniquely establishing the external potential where this density came from. Since the expressions for kinetic energy and electron–electron interaction are the same for any system, it is the form of the external potential which makes the Hamiltonian unique and hence speciﬁes it. The arguments of density functional theory thus make the following claim: knowing ngs implies we know which external potential was used in the Hamiltonian. This, in turn, speciﬁes the full Hamiltonian and, from it, all states, even the excited ones. Thus we establish electron density as a property which describes a system, and we formally allow the use of electron density in place of a many-electron wave function. In particular, we are now able to express the following functional relationship between the ground-state energy of the Hamiltonian, and the ground-state electron density:

E[n(r)] = T [n(r)] + W [n(r)] + Vext[n(r)].

(1.15)

The three terms in Eqn (1.15) are the same as those deﬁned in Eqn (1.3). Using similar, straightforward arguments, one can arrive at the second important theorem underlying density functional theory:

Theorem 1.2 The exact ground-state density minimizes E[n(r)] in Eqn (1.15).

The Kohn–Sham equation 9
If we had an explicit form for E[n(r)], we could go ahead and minimize it with respect to the electron density and in this way calculate the ground-state energy. The expression for Vext[n(r)] is straightforward, but those for T [n(r)] and W [n(r)] are more difﬁcult. Attempts have been made at formulating such expressions, for example, Thomas–Fermi theory, but this theory comes short when compared to the topic of the next section, the Kohn–Sham approach, when results are compared to, for example, measured magnetic and cohesive properties.

1.4 The Kohn–Sham equation

The theorems described above are also valid for non-interacting systems where the part of the Hamiltonian that describes electron–electron interaction, W , is absent. In this case, electrons which move in the ﬁeld of an external potential which we, for reasons that will be obvious, call Veff, are solutions to a one-electron Schrödinger equation,

–

1 2

∇2

+

Veff(r)

ψi(r) =

i ψi (r).

(1.16)

From this equation, which in the density functional theory community is also referred to as the Kohn–Sham equation, one can calculate an electron density from the occupied one-particle (op) states. Since no direct electron–electron interactions are considered when evaluating this density, it is referred to as a one-particle density:

nop(r) = |ψi(r)|2 ,
occ

(1.17)

where the sum is over occupied states. In this case, the energy functional which describes the total energy may be written as

Eop[nop(r)] = Top[nop(r)] + Veff[nop(r)] =

=

ψi (r)

–1∇2 2

ψi (r)

+

occ

nop(r)Veff(r) d3r,

(1.18)

and the electron density which minimizes this functional is obtained from the requirement that the energy functional is stationary for small variations of the electron density around the ground-state density, that is Eop[nop + δn] – Eop[nop] = 0, which also can be written as

δTop[nop(r)] + δn(r)Veff(r) d3r = 0.

(1.19)

Carrying out this minimization, using Eqn (1.18) for the kinetic energy, leads to Eqn (1.16), and we have shown that non-interacting electrons which are the solutions

10 Density Functional Theory

to Eqn (1.16) result in an electron density which minimizes the total energy of this system via the functional in Eqn (1.18). The basic principle of the Kohn–Sham approach is the assumption that one can ﬁnd an effective potential Veff such that its density nop is the same as the ground-state density of the fully interacting system, ngs. The assumption is proven to hold for a homogenous electron gas and small deviations from it but no practical experience shows that the assumption holds in the general case. Nevertheless, since we know the coupling between potential and density, as described, for example, in Fig. 1.2, it seems like an efﬁcient route to get the ground-state density of the interacting system, by careful selection of an effective potential, even if it is from a one-particle system.
The question now is, how do we determine Veff so that nop becomes equal to ngs? In order to ﬁnd a way to do this, we ﬁrst recast the energy functional in Eqn (1.15) to the form

E[nop(r)] = Top[nop(r)] + nop(r)Vext(r) d3r

+

nop(r) · nop(r ) d3r d3r r–r

+ Exc[nop(r)].

(1.20)

In Eqn (1.20), we have introduced the one-particle kinetic energy functional Top instead of the true kinetic energy functional, and we have introduced the Hartree electrostatic interaction instead of the true electron–electron interaction. Hence in order to make Eqn (1.20) equal to Eqn (1.15) we must introduce a term that corrects for this, and this is what the exchange and correlation energy Exc[nop(r)] does. Since the ﬁrst three terms on the right-hand side of Eqn (1.20) can be calculated numerically, we have moved the complexity of the fully interacting system to ﬁnding the exchange and correlation functional. For a uniform electron gas, one can, however, calculate Exc[nop(r)] for all values of the electron density, and parameterized forms of Exc[nop(r)] as a function of nop(r) are available. For uniform densities, it is hence possible to evaluate Eqn (1.20) with excellent accuracy, and obtain the total energy using the electron density as the decisive variable of the system.
The local density approximation (LDA; Hedin, 1965; Hedin and Lundqvist, 1971; Barth and Hedin, 1972; Ceperley and Alder, 1980) assumes that the parameterizations used for the uniform electron gas work even in cases where the electron gas is not uniform, and is applicable to molecules, solids, surfaces, and interfaces. This is done by assuming that locally, at a given point in space of, for example, a solid or molecule, one may consider the density as uniform and hence use the parameterized version from the uniform electron gas. This means that one uses the following expression for the exchange–correlation energy:

Exc[nop(r)] = xc[nop(r)]nop(r) d3r,

(1.21)

where xc[nop(r)] is the exchange–correlation energy density; in a parameterized form, its dependence on nop(r) is relatively simple. We now have an expression for the

The Kohn–Sham equation 11

energy functional that can be minimized with respect to the electron density, using an expression similar to Eqn (1.19) but now including electron–electron interaction via the Hartree term and the exchange–correction functional. This minimization results in a one-electron Schrödinger-like equation similar to Eqn (1.16). However, the minimization procedure leads to an explicit form of the effective potential Veff from Eqn (1.16):

Veff(r) = Vext(r) +

nop(r ) |r–r |

d3r

+ μxc[nop(r)],

(1.22)

where

μxc[nop(r)]

=

∂{

xc[nop(r)]nop(r)} ∂ nop (r)

=

xc[nop(r)]

+

∂{ nop(r)

xc[nop(r)]} . ∂ nop (r)

(1.23)

We now can evaluate the total energy of a system, using electron density as the key vari-

able that determines things. In practice, this means solving Eqn (1.16) with the effective

potential speciﬁed by Eqn (1.22). Since the effective potential to be used in Eqn (1.22)

depends on electron density, which is the property we want to calculate, one has to per-

form a self-consistent ﬁeld calculation where an initial electron density is guessed and

an effective potential is calculated from Eqn (1.22). This potential is then used to solve

Eqn (1.16), and a new electron density is calculated from Eqn (1.17), which is then

put back into Eqn (1.22). This procedure is repeated until convergence is obtained,

that is, until the density does not change appreciably with successive iterations. Once a

self-consistent electron density has been found, one can calculate the ground-state en-

ergy of the Kohn–Sham LDA energy functional, via Eqn (1.20). We comment here on

the evaluation of the kinetic energy in Eqn (1.20). Since an accurate expression of it in

terms of the electron density is missing, one evaluates it from

occ

ψ|

–

1 2

∇ 2 |ψ

by using

Eqn (1.16), moving Veff to the right-hand side of the equation and multiplying from the

left with ψ| on both sides, yielding

Top =

ψi |

–

1 ∇2|ψ 2

=

i–

occ

occ

d3r Veff(r)nop(r).

(1.24)

The last term on the right-hand side of this equation is sometimes referred to as the double-counting term, which is not to be confused with the double counting used in the (local density approximation + Hubbard parameter) LDA + U extension of density functional theory.
One of the effects that the exchange interaction Eqn (1.5) or the exchange–correlation interaction Eqn (1.21) has is that one electron can dig out a hole in the surrounding density provided by all the other electrons. This hole is normally referred to as the exchange–correlation hole (Gunnarsson and Lundqvist, 1976), in the density functional

12 Density Functional Theory

theory literature and, in fact, the exchange–correlation energy can be expressed as the energy due to interaction of an electron with its exchange–correlation hole.
It has been shown that only the spherical average of the exchange–correlation hole contributes to Exc (Gunnarsson and Lundqvist, 1976). Hence, it may be argued that, even if the exact exchange–correlation hole may in general be strongly aspherical and non-local, it is not necessary for approximate functionals, for example, in LDA, to describe the non-spherical parts. Consequently, approximate functionals often do not experience major obstacles in evaluating materials properties with good accuracy, as will be described in Chapter 3.
Other differences between approximate functionals, like LDA, and exact functionals or even the Hartree–Fock theory are well known, in particular, that the self-interaction of the Hartree term cancels exactly the self-interaction of the Fock term. This means that one may include terms i = j in the summations of Eqn (1.5) without causing an error. This could, for example, be done in order to make the Hartree–Fock theory more comparable to density functional theory, in which the contributions from all electrons are used to evaluate the density. Including all electrons in the terms of the Hartree–Fock theory therefore does not introduce an error, and one may say that the Hartree–Fock theory does not have a self-interaction error. However, most approximations of the exchange–correlation term of density functional theory do not generate a self-interaction-free functional and, in many cases, this deﬁciency has been known to cause unacceptable errors. Attempts to overcome this self-interaction error have been made; the most popular form is given by Perdew and Zunger (1981). It has been pointed out that this correction only partially removes the self-interaction (Lundin and Eriksson, 2001), and truly self-interaction-free functional forms of density functional theory have been suggested. However, the functionals suggested so far have not been shown to drastically improve the results of, for example, Perdew and Zunger (1981).
Parametrizations of μxc(nop(r)) in Eqn (1.22), in terms of electron density, are available, where the exchange part is proportional to n1op/3. This was done by, for example, Hedin and Lundqvist (1971) and is discussed in several textbooks (e.g. in Ashcroft and Mermin, 1976; Marder, 2010). Extensions of this analysis of the exchange–correlation properties of the uniform electron gas to spin polarized situations allow majority spin-up (α) and minority spin-down (β) densities to not be the same, thus enabling calculations of ﬁnite magnetic moments. The exchange–correlation potential for electrons of a speciﬁc spin density nα is shown from the work of Barth and Hedin (1972) to be

1

μαxc[nα(r), nβ(r)] = A[nop(r)]

nα(r) nop(r)

3
+ B[nop(r)],

(1.25)

with a corresponding expression for nβ, where nop = nα + nβ. In Eqn (1.25), both A(nop(r)) and Bop(n(r)) are negative for all densities (Barth and Hedin, 1972). Hence, majority spin-up and minority spin-down electrons travel through, for example, a crystal experiencing the separate effective potentials Veαff and Veβff; for magnetic materials, with

The Kohn–Sham equation 13

spin polarization, one must treat the Kohn–Sham equation, Eqn (1.16), separately for the majority spin-up and minority spin-down states.

–

1 2

∇2

+

Veαff(r)

ψiα(r) =

i ψiα (r),

–

1 2

∇2

+

Veβff(r)

ψiβ(r) =

i ψiβ (r),

(1.26)

respectively. The effective potential for the majority spin channel becomes a little deeper than that for the minority spin channel, which is why an imbalance between majority and minority spin states emerges in the ﬁrst place. The difference between the effective potential of majority spin states and that of minority spin states often amounts to a constant shift between the electron states of the two spin channels. This shift is referred to as exchange splitting. It can be seen from Eqn (1.25) that the exchange contribution to the effective potential is proportional to the ‘local density’ of spin-up and spin-down states, and again a spin polarized calculation has to be done self-consistently, as described above, but now for each spin channel. Alternatively, one may express this as self-consistency which has to be achieved both for the charge density n = nα + nβ and for the magnetization density m = nα – nβ. The latter description is to be preferred since, in the self-consistent cycle, a larger mixing of densities can be used for m than for n. Spinpolarized parameterizations of the LDA, normally referred to as the local spin density approximation (LSDA), have been established for some time (Barth and Hedin, 1972). The LSDA is known to give accurate total energies for many bulk systems. This theory is also known to reproduce with great accuracy the magnetic spin moments of most transition metals and their alloys. As an example, we show in Fig. 1.3 the measured and

Magnetic moment per atom (μB)

2

bcc

fcc

hcp 1

Fe

alloy

Co

Figure 1.3 Measured and calculated spin moments of FeCo alloys. Calculations represented by lines, and measurements by symbols. Note that data is shown for body-centred cubic (bcc), face-centred cubic (fcc), and hexagonal close-packed (hcp) phases in different symbols. Reprinted ﬁgure with permission from James, P., Eriksson, O., Johansson, B., and Abrikosov, I. A., Phys. Rev. B, 59, 419, 1999. Copyright 1999 by the American Physical Society.

14 Density Functional Theory
calculated (using LSDA) spin moments of Fe-Co alloys (James et al., 1999). Note that we have calculated spin moments by multiplying the integrated spin density with the electron g-factor. This corresponds to the standard formulation in quantum mechanics, where the size of the spin moment of one electron is calculated from ms = gssz, where gs = 2.002319, to get moments in units of magnetic moment per atom (μB; used throughout this book). The phase diagram of the alloys in Fig. 1.3 shows that the crystal structure is body-centred cubic (bcc), for almost all concentrations. Only for the very Co-rich alloys does the hexagonal closed packed (hcp) crystal structure become stable. Also, for some concentrations, the face-centred cubic (fcc) phase has been stabilized, as precipitates in an fcc matrix of Cu. In Fig. 1.3 we see that, for the bcc phase, the measured and calculated magnetic moments (per ‘average’ atom of the alloys) agree with good accuracy. Theory is even found to reproduce the maximum value of the spin moment, the Slater–Pauling maximum, at ∼25 % Co. For the fcc and hcp phases, theory also reproduces observation, for cases where a comparison can be made.

1.5 Non-collinear magnetism, and time-dependent density functional theory

In systems with a collinear magnetization and in which spin–orbit coupling is neglected, spin-up and spin-down states are orthogonal, and hence the density matrix is diagonal. This allows for the formulation of spin polarized density functional theory, with one Kohn–Sham equation for the majority (α) spin channel, and one for the minority (β) spin channel, as shown in Eqn (1.26). The majority and minority spin channels are connected only through the spin dependence of the exchange–correlation part of the effective one-particle potential. The more general situation is when the electronic magnetization density has a spin texture that is both non-collinear and time dependent, and the density matrix contains off-diagonal elements (Barth and Hedin, 1972; Nordström and Singh, 1996; Sandratskii, 1998; Kübler, 2009). Extending the spin polarized density functional theory formalism discussed, to the case of non-collinear magnetism and time dependence, the density matrix can be written as a 2 × 2 matrix:

ρ(r, t) =

ψiα(r, t)ψ∗iα(r, t) ψiα(r, t)ψ∗iβ(r, t) ,

i∈occ ψiβ(r, t)ψ∗iα(r, t) ψiβ(r, t)ψ∗iβ(r, t)

(1.27)

where the wave functions are two-component, time-dependent Pauli spinors; ψi(r, t) = [ψ∗iα(r, t), ψ∗iβ(r, t)]T; and the summation is over the occupied Kohn–Sham orbitals. The charge density and the magnetization density are calculated as traces of the density
matrix:

n(r, t) = Tr[ρ(r, t)], m(r, t) = Tr[σˆρ(r, t)],

(1.28)

Non-collinear magnetism, and time-dependent density functional theory 15

where σˆ = (σˆx, σˆy, σˆz) is a vector of Pauli matrices. Reciprocally the density matrix can be expressed in terms of n(r, t) and m(r, t) as

ρ(r, t) = 1 n(r, t)1 + m(r, t) · σˆ , 2

(1.29)

where 1 is the 2 × 2 identity matrix. Note that in relationship to Eqn (1.26), we have now made a generalization in that we consider non-collinear arrangements of magnetic moments, and hence the Kohn–Sham equation must be written in a somewhat more general form. However, before doing this, we note that Eqn (1.28) also contains the time dependence of the charge and magnetization density, and hence we should consider the time-dependent Kohn–Sham equation, normally written as a Pauli–Schrödinger-type equation,

i ∂ψiα(r, t) ∂t

=

Hαβψiβ(r, t),

(1.30)

for single-particle orbitals ψiα(r, t). Note that, in Eqn (1.30), we have used the Einstein convention of implicit summation over repeated indices. If an external magnetic ﬁeld
Bext is included together with the spin–orbit coupling, the Hamiltonian for the electron system is written as

Hˆ αβ

=

∇2 –
2

δαβ

+

Vαeβff(r,

t)

+

1 σˆ · Beff(r, t)

2c

αβ

+

1 4c2 σˆ ·

∇V eff(r, t) × i∇

,
αβ

(1.31)

where c is the speed of light in vacuum. The effective non-magnetic potential

Vαeβff(r, t) = V ext(r, t)δαβ + V H(r, t)δαβ + μxαcβ(r, t)δαβ

(1.32)

consists of the external potential V ext(r, t), the Hartree potential V H(r, t), and the non-
magnetic part of the exchange–correlation potential μxαcβ(r, t). The effective magnetic ﬁeld

Beff(r, t) = Bext(r, t) + Bxc(r, t)

(1.33)

can be decomposed into the weaker external magnetic ﬁeld Bext and the stronger exchange–correlation magnetic ﬁeld Bxc(r, t). The scalar and magnetic exchange–
correlation potentials are calculated, following Eqn (1.23), as the functional derivatives
of the exchange–correlation energy

16 Density Functional Theory

μxc(r, t)

=

δExc[n, m] ,
δn(r)

Bxc(r,

t)

=

–

δE xc [n,

m] .

δm(r)

(1.34) (1.35)

We have in this section provided the most general form of a practical scheme to calculate magnetic properties from density functional theory, in the sense that no restriction on the shape of the charge or on the magnetization direction is imposed and that time dependence is included. From this formalism, one can evaluate the ‘direction’ of the magnetization density, by diagonalization of the density matrix Eqn (1.27) (Nordström and Singh, 1996; Sandratskii, 1998; Kübler, 2000). This is described in Chapter 4, where we connect Eqn (1.31) to the concepts of atomistic spin dynamics. For most materials, the ‘direction’ of the magnetization density does not vary over regions where it is large; typically, this region is centred on each atomic nucleus, within a radius that is signiﬁcantly smaller than interatomic distances. Examples of this are given in Chapter 2, and we note that this property implies that a collinear atomic description is meaningful in such a region (Sandratskii, 1998; Kübler, 2000), although examples of the opposite property have been discussed (Nordström and Singh, 1996). Before entering the discussion of how to derive from Eqn (1.31) the relevant equations of atomistic spin dynamics, we describe in Chapter 2 those aspects of a solid that are important when one solves the Kohn–Sham equation. We also give some examples of the magnetic properties of materials and how theory compares with observations (Chapter 3).

2
Aspects of the Solid State
Symmetries play an important role in the theory of the solid state. As will be developed in this chapter, density functional theory (DFT) calculations for crystalline materials are commonly performed for k-points in the irreducible part of the ﬁrst Brillouin zone (BZ), an approach which relies on the use of translational and pointgroup symmetries. Two central properties that result from a calculation in reciprocal space are the wavevector-resolved energy spectra, that is, the so-called band structure or band dispersion, and the energy-resolved density of states. For magnetic materials, atomic magnetic moments can be deﬁned and calculated, as well as effective interatomic exchange interactions. In this chapter, the essential aspects of such calculations are described.
2.1 Crystal systems and space groups
Normally, calculating of the electronic structure of materials is an application of DFT, that is, one tries to ﬁnd a solution to the Kohn–Sham equation, wish was discussed in Chapter 1, to a crystalline environment. This means that one considers an inﬁnite object with the effective potential described in Eqns (1.16) or (1.26). A crystal is characterized by its translational invariance, with a periodicity deﬁned by the Bravais lattice vectors. The lattice points R for which the environment is identical are hence deﬁned by R = n1R1 + n2R2 + n3R3, where n1, n2, and n3 are integers, and Rj, where j = 1, 2, 3, is the Bravais lattice vector. A crystal is made up of one or several atoms per unit cell. The symmetry properties of a crystal lattice are of great importance, since the computational cost may be reduced signiﬁcantly when utilizing these symmetries. For a three-dimensional material, there are in general seven crystal systems (shown in Table 2.1) and 14 Bravais lattices. As an example, we mention that the group of cubic crystal systems contains three Bravais lattices; the body-centred cubic (bcc) lattice, the face-centred cubic (fcc) lattice and the simple cubic lattice (sc). The symmetry properties of a crystal are described by the space group, which in three dimensions is made from combinations of 32 crystallographic point groups combined with translations. The combination of all symmetry operations of a three-dimensional lattice results in a total of 230 space groups describing all possible crystal symmetries.
Atomistic Spin Dynamics. Olle Eriksson, Anders Bergman, Lars Bergqvist, Johan Hellsvik. First Edition. © Olle Eriksson, Anders Bergman, Lars Bergqvist, Johan Hellsvik 2017. First published in 2017 by Oxford University Press.

18 Aspects of the Solid State

Table 2.1 Table showing the seven crystal systems.

Crystal system

Point-group symmetry requirements

Cubic Hexagonal Trigonal Tetragonal Orthorhombic
Monoclinic Triclinic

4 threefold axes of rotation 1 sixfold axis of rotation 1 threefold axis of rotation 1 fourfold axis of rotation
Either 3 twofold axes of rotation, or 1 twofold axis of rotation and 2 mirror planes
Either 1 twofold axis of rotation, or 1 mirror plane All cases not satisfying the requirements of any other system

2.2 The Born–von Karman boundary condition, and Bloch waves

Due to the periodic symmetry of bulk materials, several simpliﬁcations evolve. A discussion of this can be found in standard textbooks on solid state physics (Ashcroft and Mermin, 1976; Marder, 2010). First of all, the effective potential which the electrons move in is periodic, a fact which enables the identiﬁcation of a Bravais lattice vector. In the Kohn–Sham equation, this means that Veff(r) = Veff(r+R), where R is a Bravais lattice vector of the materials. The Born–von Karman boundary condition for the wave function of the electron states is then introduced:

ψk(r + NR) = ψk(r),

(2.1)

where N is a (large) integer. It is then possible to show that electrons moving through an inﬁnite, periodic crystal must obey Bloch’s theorem (Ashcroft and Mermin, 1976; Marder, 2010), that is, that the one-electron wave function (e.g. the solution to the Kohn–Sham equation) must obey

ψk(r + R) = eik·Rψk(r).

(2.2)

A vector k has been introduced in this expression. This is a vector of reciprocal space.1 In self-consistent DFT-based calculations one has only to consider k-vectors which lie inside the ﬁrst BZ for the calculation of charge and magnetization density. The BZ is deﬁned as the Wigner–Seitz primitive cell of the reciprocal lattice and, as an example, we show in Fig. 2.1 the BZ for the bcc crystal structure. Note that a smaller region is marked that describes the so-called irreducible wedge of the BZ. Most crystal structures can undergo a rotation along one or several axis, such that the rotated geometry is identical to the starting geometry. These rotations deﬁne the point group of the crystal, and we give one example of a point group below. The point group operations imply, importantly,

1 Reciprocal space is spanned by the vectors Gi, deﬁned as Gi · Rj = 2πδij .

The Born–von Karman boundary condition, and Bloch waves 19

P

Γ

H

N

Figure 2.1 Example of a Brillouin zone (BZ). The BZ is shown for a body-centred cubic crystal structure. In the ﬁgure, highsymmetry points and lines are marked and labeled with , P, N, and H. The irreducible wedge is marked with thick lines.

that any k-point of the full BZ can be generated from k-points inside the irreducible wedge of the BZ. Kohn-Sham eigenvalues of k-points that are connected by point-group operations are the same, and therefore one only need to consider k-vectors inside the irreducible wedge of the BZ when performing DFT calculations of crystalline materials. As this discussion has involved point-group operations, we consider as an example the different point-group operations of a cubic structure. We illustrate this structure as a cubic building block in Fig. 2.2. This building block is common for the sc, bcc, or fcc structure. The simplest symmetry operation which leaves the cube invariant is the identity operation. In the ﬁgure, the three arrows indicate the relevant axes for which we can perform rotations which leave this cubic building block invariant. Around the axis aligned along the 100 direction, it is possible to perform three 90◦ rotations, resulting in angles of 90◦, 180◦, and 270◦, respectively. The fourth rotation, 360◦, is identical to the identity. There are three axes of such rotations (100, 010, and 001) and hence there

Figure 2.2 Symmetry axes of a cubic building block.

20 Aspects of the Solid State
are nine rotations of this kind. Around the 111 axis, it is possible to make two 120◦ rotations, since the third such rotation is identical to the identity. There are four such axes, so eight rotations of this kind. Finally, the arrow along the 110 direction allows for one 180◦ degree rotation, since a second such rotation is identical to the identity. There are six such axes, and hence six rotations of this kind. Summing up the identity and all possible rotations hence yields 24 symmetry operations. All these 24 operations can, for the sc, fcc, or bcc crystal structure, be combined with a subsequent inversion of the lattice, thus leading to an additional 24 allowed symmetry operations. Some of these latter symmetry operations are equivalent to a reﬂection of the lattice through a plane, but some of them cannot be described as such, and are referred to as roto-inversions or improper rotations. Altogether, there are hence 48 point-group operations for a cubic material with an sc, fcc, or bcc crystal structure. However, a Bravais lattice sc, fcc, or bcc and which has more than one atom in the primitive cell (more than one atom in the crystallographic basis) may have a lower number of point-group operations. An example of this type of lattics is the zinc blende (diamond) structure, which has two atoms per unit cell: one at (0, 0, 0), and one at (1/4, 1/4, 1/4). Si is an example of a material that crystallizes in this structure. This material has no inversion symmetry, which means that there are only 24 allowed point-group operations.

2.3 A variational procedure to obtain eigenvalues

In section 2.2, we showed that the Kohn–Sham equation must be solved for a number of k-vectors which, for a given cycle in the self-consistent loop, may be treated as independent of each other. However, the toughest part of the problem is to actually ﬁnd a solution to the Kohn–Sham equation for any selected k-point. One approach is to expand the unknown Kohn–Sham wave function in a set of known basis functions as follows:

lmax
ψk(r) = clkχlk(r).
l

(2.3)

Note that l is here used as a compound index that involves the principal quantum number, the orbital angular momentum quantum number, and the magnetic quantum number. For compounds with several atom types, this index also has to incorporate atom type. There are several choices of basis functions, which have given rise to different electronic structure methods with different names, such as LCAO (linear combination of atomic orbitals), LAPW (linear augmented plane waves), PAW (projector augmented waves), and LMTO (linear mufﬁn-tin orbitals). The sum in Eqn (2.3) is truncated after sufﬁciently many basis functions χlk(r) have been included; the coefﬁcients clk are, via the Rayleigh–Ritz principle (Atkins and Friedman, 2005), determined from the equation system

lmax
Hll – kOll clk = 0,
l

(2.4)

A variational procedure to obtain eigenvalues 21

with the Hamiltonian matrix

Hll =

χ∗lk(r)
c

–∇ 2 2 + Veff

χl k(r) d3r ≡

χ∗lk(r)hˆ effχl k(r) d3r
c

and the overlap matrix

(2.5)

Oll = χ∗lk(r)χl k(r) d3r,
c

(2.6)

and the integral is over the unit cell ( c). Once Hll and Oll have been evaluated, the eigenvalues k are determined from the secular equation (Atkins and Friedman, 2005)

det |Hll – kOll | = 0,

(2.7)

which is a standard numerical eigenvalue problem. In this stage of approximation,
Eqn (2.7) can be solved separately for effective potentials of majority and minority spin states. Hence, eigenvalues and eigenstates are commonly written as αk and ψαk, respectively with a corresponding expression for states with β spin projection. The one-electron density, discussed in Chapter 1, is then calculated as a sum over all possible k-vectors and occupied eigenstates. This can be done for each spin channel separately:

occupied
nα(r) =

ik

occupied
nβ(r) =

i

k

ψαik(r) 2 , ψβik(r) 2 ,

(2.8) (2.9)

from which the electron and the magnetization densities are obtained through

n(r) = nα(r) + nβ(r), m(r) = nα(r) – nβ(r),

(2.10) (2.11)

respectively. Note that the sums only have to be carried out over the k-points of the irreducible wedge of the BZ and multiplied by the corresponding k-point weight; for this reason, a higher point-group symmetry of the crystal requires a smaller part of the BZ to be sampled and hence a smaller computational effort. A popular way to display the result of an electronic structure calculation is to plot the eigenvalues of the Kohn– Sham equation as a function of the k-point, preferably along high-symmetry lines and high-symmetry points in the BZ. An example of such an electronic structure, or band plot, is shown in Fig. 2.3 for bcc Fe. Here it may be seen that the eigenvalues of the Kohn–Sham equation depend more or less strongly on k, a phenomenon that is referred to as band dispersion. In this ﬁgure, we show bands for spin-up states on the left-hand

22 Aspects of the Solid State
side, and spin-down states on the right-hand side. The ﬁgure shows that, due to the exchange splitting, as discussed in Chapter 1, the spin-down states are typically shifted up in energy, compared to spin-up states. This yields a higher number of occupied spin-up states, compared to the number of occupied spin-down states; a ﬁnite magnetic moment; and a difference in the spin-up and spin-down densities, with the latter leading, via Eqn (1.25), to a difference around the Fermi level effective potentials of the two spin projections. In Fig. 2.3, it is clear that, for both spin-up and spin-down electrons, the lowest band has a minimum at the -point, around which the dispersion is essentially quadratic in k, similar to the result of the free-electron model. This is because the lowest band is essentially dominated by 4s orbitals. These states are quite extended in space and hence have a free-electron-like dispersion. However, the lowest eigenvalue at the H-point is dominated by 3d states, and the character of the lowest band when going from to H hence changes gradually from being 4s dominated to being 3d dominated. Note from Fig. 2.3 that the highest occupied energy, the Fermi level, is marked as a horizontal dashed line. Electron states below this energy are hence occupied, and the states above are unoccupied. It is the occupied states that contribute to the charge and magnetization density in Eqns (2.8) and (2.9). A further inspection of Fig. 2.3 shows that the exchange splitting seems to be strongest around the Fermi level. This is due to that the bands around the Fermi level are dominated by the Fe 3d orbitals, which experience

Spin up

Spin down

8

8

4

4

Energy(eV) Energy(eV)

0

0

–4

–4

–8

–8

Γ

H

N

Γ

P

Γ

H

N

Γ

P

Figure 2.3 Band structure of body-centred cubic Fe, with spin-up states to the left, and spin-down states to the right. The Fermi energy is marked as a dashed horizontal line. Picture kindly provided by Dr. Swarup Panda.

A variational procedure to obtain eigenvalues 23
the largest effect of the exchange interaction and hence have the largest exchange splitting. The data shown in Fig. 2.3 yield a magnetic spin moment that almost perfectly coincides with the experimentally observed magnetic moment, and it is found that more than 95 % of the calculated magnetic moment comes from the Fe 3d states. Figure 2.3 also shows that Kohn–Sham eigenvalues cut the Fermi level at speciﬁc points of k-space. If one moved in a circuit around the BZ via a path connecting all the k-points that had a Kohn–Sham eigenvalue equal to the Fermi level, one would trace out the shape of the Fermi surface. This has been done many times for transition metal elements and compounds. It is found that, for most of the calculations, the theoretical Fermi surface agrees with measurements, for example, as provided by the de Haas-van Alphen experiments or angular resolved photoemission spectroscopy (Ashcroft and Mermin, 1976; Marder, 2010), despite the fact that the eigenvalues in Kohn–Sham theory, strictly speaking, do not have any physical meaning. Eventual disagreements between observed and calculated Fermi surfaces are often ascribed to an inaccuracy of the effective potential used in Eqn (1.22) and have led to the development of more sophisticated methods of treating electron–electron repulsion in a solid. A description of these methods, is however, outside the scope of this book.
In Fig. 2.4, we show as an additional example of the output of an electronic structure calculation based on DFT; the magnetization density m(r) of bcc Fe. In this cut of the crystal, there are atoms positioned at the corners of the plot. It can be seen that the magnetization density is largest around these atoms, as is natural, since most of the magnetic moment is due to exchange splitting of the 3d orbitals that are centred on these atoms. It can also be observed that the shape of the magnetization density, even when close to the atomic nuclei, deviates somewhat from spherical symmetry, as may be seen, for example, in the dark lobes in Fig. 2.4. However, this inﬂuence of the crystal geometry on the magnetization density is consistent with the point-group symmetry of the
Bcc Fe

001

Figure 2.4 Magnetization density of body-

centred cubic (bcc) Fe in a plane spanned by the

100 and 001 vectors of the bcc crystal struc-

ture. Increase in density is indicated by an

100

increase in the darkness of the colour.

24 Aspects of the Solid State
lattice, as is also clear from the ﬁgure. It can also be seen that the magnetization density is quite localized in space around the atomic nuclei. This property is not unique for bcc Fe but is found in most magnetic materials. It is, however, interesting that, although the magnetization density and magnetic moment seem rather localized in space, as illustrated in Fig. 2.4, the microscopic reason for the magnetism is due to exchange splitting of delocalized electron states with signiﬁcant band dispersion, as shown in Fig. 2.3. Nevertheless, the pronounced localization in space of the magnetization density, and hence the magnetic moments, means that it is meaningful to treat magnetic excitations, for example, magnons, with an effective spin Hamiltonian. Such a Hamiltonian may be of the Heisenberg or extended Heisenberg type and will be discussed in more detail in Chapter 4.

2.4 Density of states
One of the more popular outputs of an electronic structure calculation, apart from total energy, energy bands, magnetic moments, and magnetization density, as discussed in Section 2.3, is the density of states of the electronic structure. This is a property which is very useful for analysing and understanding calculations. A derivation of the density of states may be found in most textbooks on solid state physics (Ashcroft and Mermin, 1976; Marder, 2010) and so is not repeated here. Instead, we use the result, that the density of states of spin-up (α) states can be calculated from

Dα(E) =

i

1 (2π)3

δ(E – iαk) dk,
BZ

(2.12)

with a corresponding expression for spin-down (β) states. The Fermi level can now be calculated from the density of states via the expressions

EF

Nvαal =

Dα(E) dE,

–∞

Nvβal =

EF
Dβ(E) dE,

–∞

Nval = N α + N β,

(2.13) (2.14) (2.15)

where EF stands for Fermi energy, and Nval is the number of valence electrons considered in the calculation. As an example, we show in Fig. 2.5 the density of states of the spin polarized electronic structure of bcc Fe. Here, the larger occupation of spin-up states, compared to that of spin-down states is clearly seen, as well as the fact that most of the features of the two spin channels are similar, apart from an exchange splitting primarily of 3d states and which is approximately 2 eV in size.

30 Spin up
20

Relativistic effects 25
Bcc Fe

DOS (states/Ry)

10

0

–10 Spin down
–20

–30

–0.6

–0.4

–0.2

0.0

0.2

0.4

Energy (Rydberg)

Figure 2.5 Density of states of body-centred cubic Fe. Spin-up states (dark grey) are shown in the upper panel, and spin-down states (light grey) are reﬂected and shown in the lower panel. The Fermi level is at 0, and energies in Rydbergs (1 Ry equals 13.6058 eV)

2.5 Relativistic effects

The symmetry properties of a spin polarized electronic structure calculation which in-

cludes spin–orbit coupling requires some discussion since, in this case, there is coupling

between spin degrees of freedom, and orbital space. This can most easily be seen by

noting that, in the simplest form, spin–orbit coupling enters as ξl · s to the Kohn–Sham

equation, Eqn (1.16), where s is an angular momentum operator of spin space, and l is

an angular momentum operator of orbital space. The strength of the coupling between

spin

space

and

real

space

is

given

by

ξ

∝

1 r

dVeff dr

(r)

,

where

Veff

is

the

effective

potential

of

Eqn (1.16). For a 3d transition metal, the value of ξ for the d-orbital ranges between 10

and 100 meV whereas, for the 4d and 5d elements, this value is in the range of 20–200

meV and 150–600 meV, respectively (Christensen, 1984; Popescu et al., 2001). For the

4f orbitals of the lanthanides, ξ reaches values of 80-100 meV, whereas the 5f shell of

the actinides experiences a spin–orbit coupling of the order of 200–300 meV (Schadler

et al., 1986). The consequence of this coupling is that the spin and the orbital degrees

of freedom become coupled and hence that the magnetization direction is locked to spe-

ciﬁc crystallographic orientations. This will be discussed in more detail in Chapter 3,

Section 3.3. As regards symmetries, the inﬂuence of spin–orbit coupling is maybe best

26 Aspects of the Solid State

analysed using the example of a cubic crystal, described in Section 2.1. Here we dis-

cussed the 48 point-group operations which are allowed for a cubic crystal structure if

magnetism is neglected. If we, for instance, consider a material where the magnetization

(M) is pointing along the 001 axis (bcc Fe is an example of this, since the 001 axis is the easy magnetization axis of this element), a 180◦ rotation around the x- or y-axis is no longer allowed, since this rotates the magnetization direction 180◦, and hence M → –M. In a similar fashion, a 120◦ rotation around the 111 axis rotates the magnetization from

the 001 direction to the 010 direction, and again the original magnetic structure is not

recovered. A further example of an operations which would be allowed if the coupling

between spin space and real space were ignored but that otherwise would not be allowed is a 90◦ rotation around the x- or y-axis. In both of these cases, the magnetization would

also be rotated away from the 001 direction. As a matter of fact, in the particular example

of bcc Fe with (M) aligned in the 001 direction, the only operations that preserve M are

the identity operation and three 90◦ rotations around the 001 axis, as well as the inver-

sion operation following these four operations (since M is a pseudo-vector, it does not

change sign after an inversion operation). There are hence eight point-group operations

that preserve the bcc lattice with a magnetization along the 001 direction, correspond-

ing to tetragonal symmetry. Fortunately, any operation which changes M → –M can be

followed by the time reversal operator, which changes the sign of the magnetization, so

we end up with an allowed compound symmetry operation. The inclusion of additional

symmetry operations for magnetic materials, for example, compound operations con-

taing both rotations and the time reversal operator, deﬁnes the so-called double group,

which is described in detail, for example, by Bradley and Cracknell (1972). In practice,

for our example of bcc Fe with M oriented along the 001 direction, the inversion leads

to 8 additional operations that are allowed, and thus a total of 16 double-group oper-

ations. In general, a lattice with a magnetization direction oriented in a speciﬁc direction

has a reduced symmetry, compared to the same lattice for a non-magnetic material or

when spin–orbit coupling is neglected. Direct consequences of this reduction in sym-

metry are that the irreducible wedge of the BZ is larger than shown in Fig. 2.1 and that

the evaluation of densities in Eqns (2.8) and (2.9) have to be done over a larger num-

ber of k-points because the irreducible BZ for the magnetic system is larger than the

irreducible BZ for the non-magnetic system.

When spin–orbit coupling is added to the Kohn–Sham Hamiltonian, Eqn (1.16), it is

no longer possible to obtain independent solutions for majority and minority spin states.

The reason for this can be seen from the fact that ξl · s can be written as ξ (lxsx + lysy +

lzsz)=ξ

[

1 2

(l+s–

+

l–s+)

+

lzsz].

Since

the

terms

involving

s+

and

s–

mix

spin

states,

one

has

to generalize the expression in Eqn (2.3) to the following:

lmax
ψk(r) = clσkχlσk(r),
lσ

(2.16)

where the index σ indicates a sum over spin components, and the trial wave function χ explicitly has a component of a spinor function, leading to a doubling of the matrix size in

Relativistic effects 27

Eqn (2.4). In addition, the presence of that component means that the eigenstates of the Kohn–Sham equation are no longer pure spin states but admixtures of spin-up and spindown components, similar to those in the non-collinear case, Eqn (1.27). For a system like bcc Fe, spin–orbit coupling is signiﬁcantly weaker than exchange splitting, so one of the two spin-components still dominates each Kohn–Sham eigenvalue, a situation that is quite similar to the case in Fig. 2.3, where all states have pure spin quantum character.
An additional direct consequence of adding spin–orbit coupling to the Kohn–Sham equation is that an orbital moment now emerges as a property. Since both spin and orbital moments may be measured experimentally in magnetic materials, for example, from ferromagnetic resonance experiments (see Chapter 8), or from neutron scattering experiments, it is important to be able to theoretically analyse these separate contributions to magnetism. In most applications of DFT, the spin and orbital moments are evaluated from the expressions

occupied

ms =

ik

occupied

ml =

i

k

ψik σj ψik , ψik lj ψik ,

(2.17) (2.18)

where j = {x, y, z}. Normally, one of the j-components dominates the expressions for spin and orbital magnetism in Eqn (2.17); consequently, spin moments and orbital moments are frequently reported only from this component, normally chosen as the z-component. There are, however, cases where the x- and y-contributions to the expectation values in Eqn (2.17) are also signiﬁcant, sometimes even leading to there being a small angle between the calculated total spin moments and the calculated total orbital moments (Solovyev, 2005; Grånäs et al., 2014), that is, to their being non-collinear.
The way to include spin–orbit coupling, as discussed so far in this section, is to add it to the Kohn–Sham equation, Eqn (1.16). We have also discussed the consequences this has for the symmetry of the lattice; but, for valence states, this interaction is actually not the strongest relativistic correction. The most accurate Schrödinger-like (or Kohn– Sham-like) equation also includes relativistic terms labelled mass velocity and Darwin shift. These corrections follow from a transformation of the one-particle Dirac equation to an effective one-particle Pauli–Schrödinger equation (Foldy and Wouthuysen, 1950; Andersen, 1975; Koelling and Harmon, 1977). For Coulomb potentials, the Darwin term is ﬁnite only for l = 0, that is, s orbitals. The negative mass-velocity correction is a term which decreases in magnitude with increasing l. Adding these two terms to Eqn (1.16), while ignoring the spin–orbit interaction, is normally referred to as the scalar relativistic approximation.
Physically, the Darwin term is a result of the increase of the wave function at the nuclear site. A consequence of this enhanced localization in space, arguing from the view point of the Heisenberg uncertainty principle, is an increase of the electron momentum, and hence the kinetic energy. Since, in Schrödinger-like equations, only s states

28 Aspects of the Solid State
have a non-vanishing amplitude at r = 0, the Darwin shift appears only for l = 0. The mass-velocity term is caused by the relativistic mass enhancement of fast particles, as this enhancement reduces the importance of the kinetic energy, hence leading to a contraction of the electron orbits; in addition, when the electrons move to regions where the potential is more attractive, the one-particle energy becomes lowered. An alternative to adding relativistic corrections to Eqn (1.16) is to consider the solution to the Dirac equation, in an effective potential given by Eqn (1.22). This is also an effective one-electron treatment, with the advantage that it is formally and practically the most precise description, since relativistic effects are naturally included. It is relevant to compare solutions of the Dirac equation to solutions given by Eqn (1.16) with relativistic corrections added, in order to estimate errors of the latter treatment. For this reason, we show in Fig. 2.6 the density of states of one of the heaviest elements of the Periodic Table, Pu, where relativistic effects are expected to be most important (Figure redrawn from O. Eriksson, 1989). In the upper panel, the Dirac equation has been solved, using an effective potential based on local density approximation whereas, in the lower panel,
Dirac equation
Pauli–Schrödinger equation including spin–orbit coupling
0.7 0.8 0.9 1.0 1.1 1.2 1.3 1.4 1.5 Energy (Ry)
Figure 2.6 Density of states of face-centred cubic Pu for a Wigner-Seitz radius of 3.10 a.u. The Fermi level is marked by a vertical solid line, and energies are given in Rydbergs (1 Ry equals 13.6058 eV). Figure redrawn after Eriksson, O., (1989), ‘Electronic Structure, Magnetic and Cohesive Properties of Actinide, Lanthanide and Transition Metal Systems’, PhD thesis, Uppsala University, Uppsala.

DOS (arbitrary units)

Green’s function formalism, Heisenberg exchange, and a multiscale approach 29
the density of states from a Kohn–Sham equation of the same form as in Eqn (1.16), albeit with relativistic corrections, is shown. It may be seen that the two approaches result in extremely similar density of states functions, thus illustrating that adding relativistic corrections to Eqn (1.16) is indeed an excellent approach in most cases. Most modern computational software for solving the Kohn–Sham equation has the ability to include relativistic effects, in either of the two methods discussed above.
2.6 Green’s function formalism, Heisenberg exchange, and a multiscale approach to spin dynamics
In Fig. 2.7, the result of a self-consistent calculation of magnetization density is shown for a typical itinerant ferromagnet, bcc Fe (the same result was also shown at a different scale in Fig. 2.4). It may be seen that the magnetization density is located primarily around the atomic nuclei and that the interstitial region contributes negligibly to the magnetic moment. This makes it possible to replace the quantum mechanical description, as provided by DFT, where the relevant information is provided by the difference of spin-up and spin-down densities, with an atomistic description of the magnetism, as shown in the upper right corner of Fig. 2.7 and represents a crucial step in a multiscale description of magnetization dynamics, where a property over some part of space, for example the magnetization density, is replaced by an averaged or integrated property, for example, the magnetic moment. It is desirable to take this step in such a way that dynamical properties are the same, or very similar, on the two length scales, thus making it possible to carry out simulations for larger systems, without loss of accuracy. In Chapters 4 and 5, such an approach will be derived, but we note here that one of the key properties needed in this process is the effective exchange interaction between any two atomic spins, for example, as shown in the upper right corner of Fig. 2.7. Before we continue, let us make a comment on time scales. The magnetization density in Fig. 2.7 is
Figure 2.7 Schematic illustration of multiscale spin dynamics. Darker regions inside spheres centred at atomic nuclei represent high magnetization density, and lighter regions represent low magnetization density. The homogenous grey region in the interstitial region between these spheres represents the lowest magnetization density (that in some cases even becomes negative). Integration of the magnetization density (coloured contours) over an ‘atomic volume’ can conceptually be replaced by atomic moments, as shown in the upper right corner of the ﬁgure, that then hold the relevant magnetic information of a material. Picture kindly provided by Prof. Olof Karis.

30 Aspects of the Solid State
generated by electrons moving through the material, where, for a spin polarized material, some regions of space contain more spin-up, or majority, electrons, than spin-down, or minority, electrons. If the time-dependent Kohn–Sham equation, Eqn (1.30), had been used to generate this, the ﬂuctuations around the time-independent density shown in Fig. 2.7 would be apparent. One might ask with which frequency such ﬂuctuations occur. This depends, of course, on the system at hand, and whether its magnetization is driven by an external stimulus, like a laser. Without an external driving force, the frequency of such ﬂuctuations must come from the electrons as they travel through the lattice, spending some time at one atomic site before jumping over to the next. Since the magnetization density is generated by the electrons, the answer to the question about the typical frequencies of the oscillations of the magnetization density, Eqn (1.28), should be given by the frequencies with which electrons typically enter or leave an atomic site. In order to estimate this, we note that a typical distance between atoms in Fig. 2.7 is a few Ångströms, and the typical drift velocity is of the order of a percent of the speed of light. From these estimates of distance and velocity, one can conclude that, approximately once every tenth of a femtosecond, an electron will leave or enter an atomic site. If we now are interested in the magnetization dynamics of atomic spins, according to Fig. 2.7, over time scales larger than 10–100 fs, an atomistic description should be valid. In this case, we can ignore the smaller, faster ﬂuctuations of the magnetization density, adopt a Born–Oppenheimer-like (adiabatic) approximation for the magnitude and direction of the atomic spins, and let these two quantities evolve in time. In Chapter 4, we return to details of how this is done. The dynamics of atomic spins is to a large extent governed by the interatomic exchange interaction, and hence the calculation of this interaction from DFT is a crucial step in establishing a method for atomistic spin dynamics simulations. The possibility of calculating the interatomic exchange interactions of an effective spin Hamiltonian, for example, of Heisenberg form, in a materials-speciﬁc way, via DFT theory, was shown by Liechtenstein, Katsnelson, and Gubanov (1984) and Liechtenstein, Katsnelson, Antropov and Gubanov (1987). They demonstrated that the parameters of an effective spin-Hamiltonian of the form

1

HHeis

=

– 2

Jij mi · mj ,

i =j

(2.19)

can be evaluated from a multiple scattering formulation of DFT. In Eqn (2.19), mi denotes an atomic magnetic moment of a particular site, i. The interatomic exchange parameter, denoted Jij, describes the energy change of the system when two moments at site i and j are rotated from their original orientation, for example, that of a collinear ferromagnetic alignment. As we will see in Chapter 4, an inter atomic exchange ﬁeld is responsible for the time evolution of each atomic spin (see Eqn (4.1)). This exchange ﬁeld can be obtained from an effective spin Hamiltonian, such as the one in Eqn (2.19). Hence, the ability to evaluate from DFT all terms of this effective spin Hamiltonian is crucial in the multiscale approach that forms the basis of modern atomistic spin dynamics simulations.

Green’s function formalism, Heisenberg exchange, and a multiscale approach 31

Since the arguments behind the derivation of interatomic exchange interactions and their connection to concepts from DFT are based on Green’s functions of quantum systems (Economou, 1979), we brieﬂy recapitulate some of the more important aspects of these objects. In Eqn (2.5), the Kohn–Sham equation is written as an effective operator, heff, acting on Kohn–Sham orbitals. For a Hermitian, time-independent operator that has a complete set of eigenstates, one can derive the relationship (Economou, 1979)

(z – hˆeff)Gˆ (z) = 1,

(2.20)

where z is a complex energy variable whose real part is the energy E, as shown, for example, on the x-axis in the plots in Figs 2.5 and 2.6. Here, the Green’s function G(z) enters and is seen to basically be the inverse of the complex energy minus the Kohn– Sham operator. The real space representation of the Green’s function is obtained via

G(r, r , z) = r|G(z)|r ,

(2.21)

and, using this representation, it is possible to deﬁne a Green’s function that connects two sites that are the centre of an atomic nucleus, at position Ri and Rj as G(Ri, Rj, z) or Gij(z) for short. For spin polarized electronic structures, one obtains effective Hamiltonians for spin-up and spin-down states, Eqn (1.26), and corresponding Green’s functions as

(z – hˆαeff)Gˆ α(z) = 1, (z – hˆβeff)Gˆ β(z) = 1.

(2.22)

It was shown, after some algebra associated to multiple scattering theory, that the leading
orders of the changes of the total energy, when any two atomic sites have the orientation of the magnetic moment modiﬁed with some small angle θ from the ground-state conﬁguration, are proportional to θ2 (Liechtenstein, Katsnelson, and Gubanov, 1984; Liechtenstein, Katsnelson, Antropov, et al., 1987). For small values of θ, Eqn (2.19) also results in energy excitations proportional to θ2, and hence it was demonstrated that
the interaction strength, Jij, between two magnetic moments, deﬁned in Eqn (2.19), follows from multiple scattering theory, yielding the expression

Im Jij = 4π

EF
Tr

δi (E )Giαj (E )δj (E )Gjβi (E )

–∞

dE,

(2.23)

where the trace is over orbital indices, and Giσj is the Green’s function that connects sites i and j for electrons with spin σ. The quantity δi(E) has units of energy and yields the local exchange splitting between spin-up and spin-down states, at site i. In transition metals, the exchange splitting δi is largest for the d states, and hence these states normally dominate the interatomic exchange interaction, according to Eqn (2.23), at least for
short-range exchange. It should be noted that the derivation by (Liechtenstein, Katsnel-
son, and Gubanov, 1984; Liechtenstein, Katsnelson, Antropov, et al., 1987) was made

32 Aspects of the Solid State
for a non-relativistic treatment of a collinear magnetic system. Hence, the expression for interatomic exchange, Eqn (2.23), is in principle not relevant for a magnetic material at ﬁnite temperature, where the magnetic ordering typically is non-collinear. However, as we shall see in Chapters 7, 8, and 9, using exchange parameters from Eqn (2.23) for ﬁnite temperature simulations of the magnetization dynamics is often a very good approximation. We note, however, that generalizations of Eqn (2.23) to non-collinear situations (Szilva et al., 2013) and to relativistic cases (Udvardi et al., 2003) have been presented. The latter is important, since it leads to the Heisenberg exchange, as well as to the Dzyaloshinskii–Moriya interaction. We will show some examples of exchange parameters in Chapter 3, where we also will discuss their behaviour and microscopic origins.
We ﬁrst end this chapter with a comparison of the forces between particles in molecular dynamics simulations, and the forces or torques between atomic moments in atomistic spin dynamics simulations, described in detail in Chapters 4 and 7. In molecular dynamics simulations, the forces are obtained by connecting information from the electronic structure, via the Hellman-Feynman force, which then allows for a dynamical treatment and time evolution of the nuclei (or atoms) that constitute the solid. In atomistic spin dynamics simulations, the corresponding information is provided by Eqn (2.23), which hence may be seen as the spin dynamics version of the Hellmann–Feynman theorem.

3
Applications of Density Functional Theory
In this chapter, we give examples of how density functional theorey (DFT) describes some of the most basic magnetic properties of a material. This involves spin and orbital moments, Heisenberg exchange parameters, and magnetic form factors. Relativistic effects couple spin and orbital space and make magnetic materials anisotropic, which means that the ground-state magnetization has a preferred orientation, which is most frequently parallel to a high symmetry-direction of the crystalline structure. We also illustrate how well DFT describes cohesive properties and how magnetism inﬂuences these properties. These examples serve to give a general picture of how well DFT, as described in Chapters 1 and 2, can reproduce relevant features of magnetic materials, as well as to illustrate how the onset of spin polarization can have a drastic inﬂuence on all the properties of a material.
3.1 Cohesive and structural properties
We start by discussing how magnetism inﬂuences chemical bonding and phase stability. In order to do this, it becomes relevant to compare the properties of magnetic materials with those of iso electronic non-magnetic materials. Hence, we show in Fig. 3.1 the nearest-neighbour distance of the 3d, 4d, and 5d transition metals (Janthon et al., 2014). Note that, for simplicity, the α-phase of Mn, with a basis of 29 atoms (D. Young, 1991) is not shown in this ﬁgure. This complex magnetic material was studied with the use of ﬁrst-principles theory by Sliwko et al. (1994), who observed good agreement between measured and calculated moments; however, this study is not discussed further here. Figure 3.1 reﬂects the typical size of an atom and compares theoretical data with measurements. It may be seen that, overall, there is good agreement between theory and the measurements. This is the case for both non-spin polarized materials and spin polarized, magnetic materials. The trend of the nearest-neighbour distance, when a transition metal series is traversed, is that the curve follows a more or less well-deﬁned parabolic trajectory. This reﬂects the ﬁlling of bonding orbitals in the early part of the series, and anti-bonding states for the heavier elements of a given series, a trend which may be
Atomistic Spin Dynamics. Olle Eriksson, Anders Bergman, Lars Bergqvist, Johan Hellsvik. First Edition. © Olle Eriksson, Anders Bergman, Lars Bergqvist, Johan Hellsvik 2017. First published in 2017 by Oxford University Press.

34 Applications of Density Functional Theory

3.60

3.50

Theo. Exp.

3d

3.40

4d

5d 3.30

3.20

NN distance (Å)

3.10

3.00

2.90

2.80

2.70

2.60

2.50

2.40

Sc/Y

V/Nb/Ta

Mn/Tc/Re

Co/Rh/Ir

Cu/Ag/Au

Ti/Zr/Hf

Cr/Mo/W

Fe/Ru/Os

Ni/Pd/Pt

Figure 3.1 Nearest-neighbour (NN) distances of 3d, 4d, and 5d transition metal elements. Theoretical (Theo.) data given as ﬁlled symbols, and experimental, (Exp.) data as open symbols. Picture kindly provided by Debora Carvalho de Melo Rodrigues.

explained by the Friedel model (Harrison, 1989). Comparing different transition metal series, one can observe that the nearest-neighbour distances, or equivalently the atomic volumes, of the 3d elements in general are signiﬁcantly smaller than the isoelectronic counterparts of the 4d and 5d series. This is due to the signiﬁcantly smaller radial extent of the 3d wave function, as compared to the 4d and 5d wave functions. Since the 4d wave functions are required to be orthogonal to the 3d states, which are the ﬁlled core states for the 4d elements, they are forced to be more extended. Similarly, the 5d wave function is required to be orthogonal to the 3d and the 4d core levels and hence becomes even more extended. Consequently, the valence electron bands of the 5d elements are wider than those of the 4d elements, which in turn are wider than those of the 3d elements, although, in the latter case, the difference is not so dramatic. This also is part of the reason why the volumes of the 3d elements are smaller than those of isoelectronic 4d and 5d elements. Calculated electronic density of state (DOS) values can be structures and found in publically available databases.1

1 e.g. the Electronic Structure Project (http://gurka.fysik.uu.se/ESP) and the Materials Project (http://materialsproject.org).

Cohesive and structural properties 35

A similar comparison can be made between the lanthanide and actinide series, where

the 4f wave function of the lanthanides has signiﬁcantly smaller radial extent, com-

pared to the 5f wave function of the actinides. The effect of magnetism is also visible

for the equilibrium volumes of Fe, Co, and Ni. For the late 4d and 5d elements, the

Friedel model results in a rather sharp upturn of the nearest-neighbour distances, since

anti-bonding states start to become ﬁlled. This is seen from Fig. 3.1 to give a distinct

minimum at Ru and Os. For the isoelectronic 3d element Fe, the minimum is much

less conspicuous. In fact, the nearest-neighbour distances of Fe, Co, and Ni are rather

similar to each other, giving a trend without a marked minimum, in contrast to the trend

of the 4d and 5d series. This difference is caused by the onset of magnetism and spin-

polarization of the electron states, which reduces the strength of the chemical bonding,

leading to a magnetovolume effect, with increased nearest-neighbour distances. Had Fe,

Co, and Ni been non-magnetic or non-spin polarized materials, they would have had

stronger chemical binding with a resulting smaller nearest-neighbour distance than that

shown in Fig. 3.1, and this would have led to a marked minimum for Fe. However, the

large gain in exchange energy of body-centred cubic (bcc) Fe, hexagonal close-packed

(hcp) Co, and face-centred cubic (fcc) Ni prevents this from happening and, instead,

spin polarization sets in. For bcc Cr, which orders antiferromagnetically (to be precise,

bcc Cr has a spin density wave, as described by Fawcett et al. (1994)) with relatively

small exchange splitting in relation to the band width, the magnetovolume effect is less

visible.

The total energy is, in density functional theory, composed of a kinetic part and the

electrostatic electron–electron and electron–nucleus interactions, as well as the exchange

energy, as discussed in Chapter 1. The presence or absence of magnetism in itinerant

electron systems can to a good description be analysed as the balance between kinetic

and exchange energy, which both depend on the spin polarization to a greater extent

than the electron–electron and electron–nucleus interaction energies. In fact, these two

interactions only depend on the electron density, and not the magnetization density, so

it is possible to neglect them when analysing the possibility of the spin polarization of

a material (Mohn, 2003). In order to illustrate this we consider a simpliﬁcation of the

DOS, namely the square shape, as shown in Fig. 3.2. The kinetic energy can be cal-

culated from Eqn (1.24), where the sum of eigenvalues is evaluated from the integral EF D · E dE and, for the spin-degenerate case, as shown in the upper part of Fig. 3.2, we

choose for simplicity a reference level of the energy so that the double-counting contri-

bution to Eqn (1.24) becomes 0. In this way, we get for the spin-degenerate case a kinetic

energy of D(EF2 – W 2). For the spin polarized case, the integration of one-electron energies is straightforward, but since this corresponds to a case where an exchange splitting

± appears in the effective potential of states with spin down and spin up, respect-

ively, one has to include this in the double counting of Eqn (1.24). The resulting

kinetic energy is in this case D(EF2 – W 2) + D 2. The exchange splitting of the spin polarized case results in a spin polarization, m = 2D . This spin polarization lowers

the exchange and correlation energy, and in an approximate expression presented by

M.

Brooks

and

Johansson

(1983),

the

energy

is

found

to

be

lowered

by

Im2 4

,

where

I

is the Stoner exchange parameter. Note that this mathematical form is consistent with

DOS

36 Applications of Density Functional Theory
Atomic reference energy D
–W

Energy

–W–∆ D

Atomic reference energy, spin up

DOS

Energy
–W+∆ Atomic reference energy, spin down
Fermi energy
Figure 3.2 Square-shaped density of states, of a spin-degenerate situation (upper panel) and a spin polarized situation (lower panel). The constant value of the DOS is D, and W is the bottom of the DOS for the spin-degenerate case. For the spin polarized case, the spin-up states are shifted down with , and the spin-down states are shifted up with , so that the Fermi energy is the same as in the spin-degenerate case. In the ﬁgure, the atomic reference energy, which separates bonding from anti-bonding states, is also drawn.
the spin-pairing energies shown in Fig. 1.1. Balancing the increase of the kinetic energy with the reduction of exchange energy leads to the established Stoner criterion: I · D = 1, signalling a situation where kinetic and exchange energy are equal, at least for small values of . If the Stoner product, I · D, is larger than 1, exchange interaction dominates the kinetic contribution, and ferromagnetism occurs. This happens for systems with narrow bands, where the value of D becomes sufﬁciently large and spin polarization sets in spontaneously to form a ferromagnetic state. Although based on simple arguments, the Stoner criterion is surprisingly accurate in predicting whether a material is ferromagnetic, simply by inspection of the DOS at the Fermi energy and with knowledge of the Stoner exchange integral. Accurate tables of the latter can be found in the work by M. Brooks and Johansson (1983). Among all the transition metal elements, it is only bcc Fe, hcp Co, and fcc Ni that have a Stoner product that exceeds 1, in agreement with

Cohesive and structural properties 37
their experimentally observed ferromagnetic states. An example of an element that has a Stoner product close to 1 is fcc Pd. For this reason, it is possible to induce large magnetization clouds in Pd by doping with a magnetic impurity, for example, Fe. As a matter of fact, huge induced moments have been observed in a Pd matrix doped with Fe, as every Fe impurity is associated with a magnetic spin moment of 10–12 μB (Craig et al., 1962). This large moment is then induced in the Pd matrix, forming an extended spin cloud with a radius of ∼10 Å and which involves signiﬁcant moments several shells away from the Fe impurity. Stoner theory has been used in the past and is still used, with arguments such as the ones presented for Fig. 3.2, being generalized for the multi-orbital case (M. Brooks et al., 1988) as well as for a fully relativistic scenario (O. Eriksson et al., 1989).
The kinetic energy of a solid is connected to the dispersion of the electron states, that is, the degree to which electrons jump around from one lattice point to another, and thus provides a mechanism of stability for a material, since the energy is lower when the states are dispersive than when all the electrons stay put on an atomic site. This can be seen from Fig. 3.2 by comparing the energy of all electrons located at the atomic reference energy, that is, in the non-bonding case for an atom, to that obtained when the states from the bottom of the band to the Fermi energy are occupied, as the latter is clearly lower. The kinetic energy of the band situation is hence always lower than that of the non-binding case and provides a very strong mechanism for chemical bonding. However, the example in Fig. 3.2 shows that the lowering of the kinetic energy becomes less pronounced when spin polarization sets in. The simplest way to see this is to analyse how bonding and anti-bonding states are ﬁlled. In the upper part of Fig. 3.2, a situation is drawn where all the bonding states are ﬁlled while only some of the anti-bonding states are ﬁlled, for both spin-up and spin-down states. In the spin polarized case, shown in the lower panel of Fig. 3.2, a larger fraction of anti-bonding states are ﬁlled for the spin-up states than for the spin-down states. As analysed above, this increases the kinetic energy by the amount D 2, compared to the spin-degenerate situation. This is the microscopic explanation of the magnetovolume effect displayed in Fig. 3.1. Since Fe has a larger moment than Co or Ni, its value of is larger, and hence its kinetic energy is inﬂuenced the most, with a correspondingly large magnetovolume effect. For Co the effect is slightly smaller and, for Ni, it is smaller yet. The balance between the magnetovolume effect and the expected parabolic trend of the nearest-neighbour distance of non-spin polarized states of 3d elements leads to Fe, Co, and Ni having very similar atomic volumes, as shown in Fig. 3.1.
If one subtracts the total energy of the atom from the total energy of the solid, one obtains the cohesive energy. This energy can also be compared directly to experimental data, as is done in Fig. 3.3 for the 3d, 4d, and 5d elements. It should be noted here that such calculations must be made with some care since the electronic conﬁguration, that is, the numbers of s, p, and d electrons, of the atom may differ from that of the solid. As seen in Fig. 3.3, DFT reproduces experimental data with good accuracy, for all three transition metal series. As expected from the Friedel model, the trend of the cohesive energy is parabolic, with a maximum value in the middle of the series, since all bonding states are ﬁlled while anti-bonding states are empty. For the late 3d series, the inﬂuence of magnetism and spin polarization is clear, since the trend is drastically different compared

38 Applications of Density Functional Theory
10.00 9.00 8.00

Theo.

Exp. 3d 4d 5d

Cohesive energy (eV/atom)

7.00

6.00

5.00

4.00

3.00

2.00

Sc/Y

V/Nb/Ta

Mn/Tc/Re

Co/Rh/Ir

Cu/Ag/Au

Ti/Zr/Hf

Cr/Mo/W

Fe/Ru/Os

Ni/Pd/Pt

Figure 3.3 Cohesive energy of 3d, 4d, and 5d transition metal elements. Theoretical (Theo.) data are given as ﬁlled symbols, and experiment al (Exp.) data as open symbols. Picture kindly provided by Debora Carvalho de Melo Rodrigues.

to the isoelectronic 4d and 5d elements. Again, this is easily understood from the analysis of Fig. 3.2, where spin polarization is shown to diminish the inﬂuence of the kinetic energy.
We now turn our attention to the structural properties, since it is here that magnetism is very clearly inﬂuential. We start by commenting on the work of Skriver (1985), who showed that the crystal structures observed for all elements of the Periodic Table are, with very few exceptions, reproduced by DFT, that is, the approach described in Chapters 1 and 2. More importantly, it was pointed out that the distinct features of the DOS function of any crystal structure, for example, bcc, lead to an easy understanding of the crystal’s structural stability. From this analysis, it was argued that isoelectronic elements, for example, from among the transition metals, should have identical crystal structures. This is, indeed, also the case for most elements that do not spontaneously develop magnetic ordering. For example, the trivalent elements Sc, Y, and Lu form in the hcp structure, as do tetravalent Ti, Zr, and Hf. The Group V elements V, Nb, and Ta all form in the bcc structure at low temperatures, as do the isoelectronic elements Cr, Mo, and W. For the late transition elements, the similarities of crystal structures among isovalent elements hold well for the 4d and 5d series. However, for the 3d series,magnetism disrupts this trend. For instance, Tc and Re have the same crystal structure, that is, hcp,

Cohesive and structural properties 39
and this structure is also shared by Ru and Os. For the heavier 4d and 5d transition metals, the trend of isoelectronic elements having similar structures continues, as elements in Groups IX–XI all have the same crystal structure: fcc. As Fe is isoelectronic with Ru, it would for this reason be expected to crystallize in the hcp phase, in contrast to the observed bcc structure. Co is isoelectronic with Rh and is hence expected to crystallize in the fcc structure, not in the observed hcp structure. It was pointed out by Söderlind et al. (1994) that, since Fe, Co, and Ni are ferromagnetic, their structures cannot be expected to be the same as those of their non-magnetic, isoelectronic counterparts, since the ﬁlling of the DOS function in ferromagnetic elements is different from that in non-magnetic elements. Taking bcc Fe as an example, we may see from Fig. 2.5 that the spin-up states are essentially ﬁlled, in such a way that both bonding and anti-bonding states are ﬁlled. A major chemical activity of this spin channel is hence not expected. However, the spin-down states are essentially half ﬁlled, so that the Fermi energy ends up in a pseudogap. This is a very favourable situation, since the eigenvalue sum used to calculate the kinetic energy, Eqn (1.24), is particularly low when much of the weight of the DOS function is located at lower energies, away from the Fermi energy. The band ﬁlling of the spin-down band of bcc Fe is in fact similar to the band ﬁlling of the degenerate spin-up and spin-down states of Nb, Mo, Ta, and W, all elements that form in the bcc structure. Hence, Fe should, from a structural point of view, not be compared to isoelectronic elements but rather to the Group V and VI elements. This is illustrated in Fig. 3.4. One may conclude that the electronic structure of spin polarized Fe dictates the stability of the bcc structure whereas, in the absence of spin polarization, the hcp phase should be stable. As a matter of fact, at high applied pressures, where the kinetic energy of band formation dominates over the spin-pairing energy, such that the Stoner criterion is not fulﬁlled, Fe is observed in the hcp structure (Saxena et al., 1994). In a similar fashion, the shape of the DOS and the band ﬁlling of spin polarized Co is similar to the situation in paramagnetic Tc, Ru, Re, and Os, and the observed hcp phase appears naturally. The connection of band ﬁlling of the 3d and 4d/5d elements is shown schematically in Fig. 3.4.

Bcc Hcp Fcc

3d Fe

Co

Ni

4d Nb Mo Tc Ru Rh Pd

5d Ta W Re Os

Ir

Pt

Bcc

Hcp

Fcc

Figure 3.4 The connection between band ﬁlling in spin polarized 3d elements and that in non-magnetic 4d/5d elements, and the coupling of band ﬁlling with crystal structure stability. Filling spin-down states in spin polarized body-centred cubic (bcc) Fe gives a band ﬁlling similar to that of non-magnetic Nb, Mo, Ta, and W. The common bcc crystal structure is hence natural. The same connection is made for hexagonal closed-packed (hcp) Co and Tc, Ru, Re, and Os; and for face-centred cubic (fcc) Ni and Rh, Pd, Ir, and Pt.

40 Applications of Density Functional Theory
3.2 Spin and orbital moments, and the magnetic form factor
In Fig. 1.3, we saw one example of how theoretically obtained magnetic spin moments compare to experimental ones. In this section, we broaden this discussion and make a similar comparison for several classes of materials. These results are shown in Table 3.1, where we have collected spin and orbital moments of some relevant materials that are discussed in detail below. We note ﬁrst that, according to Fig. 2.4, the magnetization density is distributed over the entire unit cell and not just in the region close to the nuclei. This means that, particularly for compounds involving different atomic elements, it may not be straightforward to deﬁne a moment that is uniquely associated with a speciﬁc atom or atom type. However, as Fig. 2.4 shows for bcc Fe, most of the magnetization density is located within a sphere around the nuclei; hence, an ‘atomic’ description becomes relevant. For most materials, over 95 % of the magnetic spin moment is located in this sphere, with the rest representing a diffuse magnetism distributed over the interstitial region. The orbital moment often has an even more dominant contribution from a smaller region close to the nuclei, since it is a spin–orbit driven entity and, as discussed in Section 2.5, the spin–orbit coupling is dominated by contributions close to the nuclei. Hence, it is relevant to describe the magnetism of a material as being composed of a main atomic part and a smaller, diffuse part, as we will do below. It should be remembered, however, that the distribution of atomic and diffuse moments depends to some extent on the volume of the region used when integrating the magnetization density and that it is suitable to make this volume as large as possible. The total moment, that is, the sum of the atomic and the diffuse parts is, however, not sensitive to this choice.
In Table 3.1, we show calculated and experimentally derived spin moments and orbital moments for selected elements and compounds. For the elements, the total spin and orbital moments, including the atomic and diffuse parts are shown whereas, for the compounds, we only show the atomic contribution since, as mentioned, it is difﬁcult to associate different diffuse contributions with different atomic types. For the magnetic transition metals bcc Fe, hcp Co, and fcc Ni (Stearns, 1984; Daalderop et al., 1991; Hjortstam et al., 1996) as well as for the rare-earth element hcp Gd (Moon et al., 1972; Roeland et al., 1975; M. Brooks et al., 1992), the agreement between theory and experiment is good for all elements concerning the spin moment. Gd is seen to have the largest spin moment, which primarily is due to the seven 4f electrons that are essentially atomiclike and form a spin moment of 7 μB/atom. These spin polarized 4f electrons couple their exchange ﬁeld, via the local spin density approximation (LSDA) potential, to the itinerant s-, p-, and d-valence electrons, inducing a non-negligible theoretical moment of 0.65 μB/atom. This induced moment can be compared to a corresponding experimental value obtained as the difference between the measured total moment of 7.62 μB/atom, and the moment expected for the 4f shell, 7 μB/atom. It is clear that theory and experiment agree rather well for the induced magnetic moment of the valence states of Gd, and it may also be noted that this moment is essentially as large as the magnetic moment of fcc Ni. The level of agreement between theoretical and measured spin moments shown in Table 3.1 for elements also holds for the spin moments of ferromagnetic compounds

Spin and orbital moments, and the magnetic form factor 41

Table 3.1 Calculated and experimentally derived atom-projected spin and orbital moments for selected transition metal elements and compounds, as well as the rare-earth element Gd. The local spin density approximation calculations for NiO are derived from work by Norman (1991) and Fernandez et al. (1998).

Element/compound
Bcc Fe (theory-LSDA) Bcc Fe (expt) Hcp Co (theory-LSDA) Hcp Co (expt) Fcc Ni (theory-LSDA) Fcc Ni (expt) Hcp Gd (theory-LSDA) Hcp Gd (expt) Hex Fe2P site I (theory-LSDA) Hex Fe2P site I (expt) Hex Fe2P site II (theory-LSDA) Hex Fe2P site II (expt) L10 FePt (theory-LSDA) L10 FePt (expt) NiO (theory-LSDA) (1) NiO (theory-LSDA) (2) NiO (theory-LSDA+DMFT) NiO (expt) Bcc Cr (theory) Bcc Cr (expt)

µs
2.19 2.13 1.59 1.52 0.61 0.57 7.65 7.62 0.96 1.03 2.04 1.91 Fe 2.93/Pt 0.36 Fe 2.92/Pt 0.47 1.08 1.59 1.85 1.90 0.5 (LSDA) 0.9–1.4 (GGA) 0.6

µl
0.05 0.08 0.08 0.14 0.05 0.05 — — — — — — Fe 0.067/Pt 0.45 Fe 0.2 0.15 — — 0.32 — —

Note: DMFT = dynamical mean ﬁeld theory; expt = experimental; GGA = generalized gradient approximation; LSDA = local spin density approximation; μl = orbital moment; μs = spin moment. Source: Fernandez, V., Vettier, C., de Bergevin, F., Giles, C., and Neubeck, W. (1998). Observation of orbital moment in NiO. Phys. Rev. B, 57, 7870–6; Norman, M. R. (1991). Crystal-ﬁeld polarization and the insulating gap in FeO, CoO, NiO, and La2CuO4. Phys. Rev. B, 44, 1364–7.

like Fe2P (Fujii et al., 1979; Wäppling et al., 1975; Ishida et al., 1987; O. Eriksson et al., 1988) and FePt (Daalderop et al., 1991; Staunton et al., 2004; Burkert et al., 2005; C. Sun et al., 2006; Antoniak et al., 2009), compounds with relatively wide bands, where electron–electron interaction is expected to be reproduced well by LSDA. In the Fe2P crystal structure, space group P6¯ 2m (Fujii et al., 1979), there are two Fe sites—one in the octahedral position, and one in the tetrahedral position—and experiments show that there is quite a drastic difference between the magnetic moments of these atoms. It is rewarding that theory, as Table 3.1 shows, can predict this large difference, as two atoms

42 Applications of Density Functional Theory
of the one and the same element experience a seemingly similar crystallographic environment. We note also that the P atom in Fe2P only has a tiny moment which is due to exchange interaction with the magnetic Fe atoms and which is an induced moment that is not discussed further here. Another magnetic compound listed in Table 3.1 is FePt, space group P4/mmm, which is of technological interest due to its large magnetic anisotropy. It has a reported spin moment for both the Fe and the Pt sites, as Table 3.1 shows and, for both sites, the agreement between measured and observed values is good. The largest uncertainty of the measured moments of FePt is for the Pt site, and it is not clear if the difference between measurements and calculations are due to inaccuracies of the theory. The element speciﬁc probe used by Antoniak et al. (2009) is the so-called Xray magnetic circular dichroism (XMCD) technique, which is known to sometimes give measured values that need calibration against values obtained with other techniques. It therefore becomes meaningful to compare the atomic resolved moments of FePt, listed in Table 3.1, to the total magnetic moment, which is obtained from magnetometry and which naturally incorporates all contributions to the magnetic moment, both atomic and interstitial. Measured values of the total moment of FePt, using magnetometry, have been reported to be ∼3.4 μB/f.u. (Daalderop et al., 1991 and references therein). This moment coincides with the sum of XMCD values of the spin moments of Fe and Pt and is in good agreement with the calculated value from theory (3.3 μB/f.u.).
Many more examples of comparisons between measured and LSDA calculations of spin moments have been published, with similar good agreement between theory and observed spin moments, as shown in Table 3.1. However, exceptions exist to this excellent trend where theory and experiment normally agree with errors not exceeding 5–10 %. For instance, for antiferromagnetic NiO, the measured (Norman, 1991; Fernandez et al., 1998) and LSDA-calculated spin moments are in poor agreement, as Table 3.1 shows (Cheetham and Hope, 1983). The experimentally determined spin moment is signiﬁcantly larger than the spin moment from an LSDA calculation. For NiO, the 3d levels form a narrow set of bands and, for such systems, mean ﬁeld theories like LSDA do not capture well the energetics of electrons jumping around from lattice site to lattice site and causing ﬂuctuations of the electron occupation of, for example, the Ni site, and involving large Coulomb energies of the order of 7–10 eV, which is the an estimated energy of repulsion between two electrons residing on the same Ni site in NiO. However, a treatment which includes correlations in a more direct way, like dynamical mean ﬁeld theory (DMFT Metzner and Vollhardt, 1989; Anisimov et al., 1997; Kotliar et al., 2006), performs much better, as Table 3.1 shows (Kvashnin et al., 2015).
Next, we discuss a particularly difﬁcult element, bcc Cr (Fawcett, 1988; Singh and Ashkenazi, 1992). As Table 3.1 shows, different parametrizations of the exchange and correlation energy result in drastically different magnetic moments, some of which agree with the measured values, and some that deviate very much. Although LSDA is formally expected to be a less accurate approximation than generalized gradient approximation (GGA), it is clear from Table 3.1 that LSDA performs better than any of the GGA functionals tested by Singh and Ashkenazi (1992) and which are quoted in Table 3.1. There is no clear reason why theory should describe bcc Cr so much worse than it does for Fe, Co, and Ni and, for this reason, bcc Cr is in some sense an unsolved mystery, at least from a DFT point of view. The 3d bands of Cr are not narrower than the 3d

Spin and orbital moments, and the magnetic form factor 43
bands of Fe, Co, and Ni, and hence electron correlations are not expected to be more important for bcc Cr. It is, however, important to note that experimental studies show that bcc Cr is an antiferromagnetic spin density wave where nearest-neighbour magnetic moments are coupled antiferromagnetically: a magnetic structure that is superimposed with a long wavelength modulation. The theoretical results listed in Table 3.1 are for a normal antiferromagnetic phase without long wavelength modulation and hence do not correspond exactly to the experimental conﬁguration. However, it has been argued (Singh and Ashkenazi, 1992) that the long wavelength modulation of the spin density wave of Cr cannot explain the large difference between calculated and measured moments for this intriguing element.
As concerns the orbital moment, it should ﬁrst be noted that, for Fe, Co, and Ni, it is very small compared to the spin moment. This quenching of the orbital moment is explained by the crystal ﬁeld effect, which arises in a crystal and results in electron states with equal admixtures of positive and negative magnetic quantum numbers. Spin–orbit coupling breaks this equal admixture and, as a result, a small orbital moment develops. As Table 3.1 shows, theory gives the right order of magnitude of the orbital moment and, for fcc Ni, it even gives the correct value. However, for bcc Fe and hcp Co, the calculated orbital moment is ∼40 % smaller than the measured values. Recent calculations based on DMFT by Chadov et al. (2008) give improved orbital moments for these elements: 0.08 for bcc Fe, 0.15 for hcp Co, and 0.06 for fcc Ni. Thus, using DMFT drastically improves the agreement between theory and observations; this result highlights the importance of using corrections to the regular exchange and correlation functional described the Chapter 1, in order to obtain accurate orbital moment for these elements, a fact which was also pointed out by O. Eriksson et al. (1990).
Another level of comparing experiments with theory is via the so-called magnetic form factor, which is available from polarized neutron scattering experiments and represents essentially the Fourier component of the magnetization density (Marshall and Lovesey, 1971), shown, for example, in Fig. 2.4. An example of a comparison between measured and theoretical form factors is shown in Fig. 3.5 for Gd. In this ﬁgure, the measured magnetic form factor (Moon et al., 1972) obtained for hcp Gd is compared to a form factor calculated by using a spin density from a Gd atom (Koelling and Harmon, 1977). Since the localized 4f density dominates the spin density, it is a valid approximation to consider the 4f states of an atom as representative of those of a solid and, as Fig. 3.5 shows, the agreement between calculation and measurement is good. This is evidence that the magnetization density has the correct shape or, in the case of a magnetization density obtained from an atomic calculation, the correct radial extension, since otherwise the agreement in Fig. 3.5 would not be observed. One may also note from the ﬁgure that, for low values of momentum transfer, the theoretical contribution to the form factor is lower than the experimental (ﬁtted) values, a result which is to be expected since here the more diffuse contribution (non-4f ) to the magnetization density becomes important and, in the calculations, this contribution had not been considered. In principle, it is possible to generate an experimental magnetization density that is similar to the theoretical one in Fig. 2.4, by measuring of the form factor for many momentum transfers and then performing an inverse Fourier transform to obtain the magnetization density in real space.

44 Applications of Density Functional Theory

Magnetic formfactor

1.0

Hcp Gd

Expt.

0.8

Theo. 4f

Fitted

0.6

0.4

0.2

0.1 0.2 0.3 0.4 0.5 0.6 0.7 sin θ/ λ
Figure 3.5 Calculated and measured magnetic form factors of hexagsonal close-packed (hcp) Gd versus momentum transfer. The experimental (Exp.) curve is normalized to a measured total moment of 7.62 μB/atom (dashed line), while the theoretical (Theo.) 4f contribution (solid line) is normalized to 7.00 μB/atom. Figure redrawn after Koelling, D. D., and Harmon, B. N., (1977), A technique for relativistic spin-polarised calculations, J. Phys. C, 10, 3107–14.

3.3 Magnetic anisotropy energy
In Section 2.5, we discussed how the spin–orbit coupling locks the orientation of the magnetization to certain crystallographic directions. This has the effect that the energy of the magnetic crystal is lowest when the magnetization is pointing along a speciﬁc direction called the easy axis. As an example, we note that bcc Fe has the 001 direction as the easy axis. Each material has a unique easy or hard magnetization axis. For fcc Ni, the 111 direction is an easy axis whereas, for hcp Co, the easy axis is 0001 . An applied ﬁeld along any other direction can force the magnetization away from the easy axis into a hard-axis direction (Chikazumi, 1997), and because the energy of the crystal depends on the orientation of the magnetization, it is referred to as magnetic anisotropy energy. For the 3d elements, magnetic anisotropy energy causes the energy differences between easy and hard directions to be in the range of a few to ∼100 μeV/f.u. As an example, we note that bcc Fe has an energy difference of the order of 1.4 μeV/f.u., which is equivalent to 0.05 MJ/m3, between the 001 and the 111 axes. In contrast, in the most commonly used permanent magnet, Nd2Fe14B, where the energy difference between the easy and the hard magnetization directions is required to be high, the energy difference is 4.9 MJ/m3. Typically, these numbers are absolutely tiny when compared to most other energies that are relevant of a material. For instance, the energy gained

Magnetic anisotropy energy 45
when the crystal is formed, the cohesive energy, is of the order of 2–10 eV/atom for the transition elements, as shown in Fig. 3.3. Despite being small compared to the cohesive energy, magnetic anisotropy energy has enormous relevance when the performance of a magnet is evaluated. Considerable effort is spent in designing materials with as large magnetic anisotropy as possible to produce so-called hard magnets, which are used in, for example, generators and electrical motors. ‘Soft’ magnets are also used, for example, for transformers; in this case, it is a low magnetic anisotropy that is desired.
The bcc phase of Fe allows for six different easy-axis orientations, whereas fcc Ni has eight different easy-axis orientations. Despite this difference, they are both examples of materials with cubic magnetic anisotropy, in contrast to hcp Co, which has uniaxial anisotropy, where the magnetization prefers to be either parallel or antiparallel to the c-axis of the hexagonal crystal structure. Mathematically the energy dependence of the direction of the magnetism is for uniaxial materials often expressed as

EMAE = K1u sin2 θ + K2u sin4 θ,

(3.1)

where MAE stands for magnetocrystalline anisotropy energy. Here, θ is the angle be-
tween the magnetization direction and the easy-axis direction, whereas the coefﬁcients K1u and K1u are the (uniaxial) anisotropy constants. For materials with cubic crystal structure, the expression often used is

EMAE = K1(α21α22 + α22α23 + α23α21) + K2(α21α22α23),

(3.2)

where, instead of the angle θ, we have used the direction cosines α1, α2, α3 of the magnetization with regard to the crystallographic axes and, as in Eqn (3.1), the coefﬁcients K1 and K2 are the (cubic) anisotropy constants.
The microscopic mechanism behind the size and sign of the anisotropy constants in Eqns (3.1) and (3.2) can be found in the details of the electronic structure, as described in Chapter 2. The total energy difference relevant for the magnetic anisotropy energy is something which, in principle, DFT should describe well, since it involves differences of ground states with different symmetry. Early theories of magnetic anisotropy energy and how it couples to electronic structures can, for example, be found in the work by H. Brooks (1940); Fletcher (1954); Slonczewski (1962); Kondorsky and Straube (1972); Kondorsky (1974); Bruno (1989), and Daalderop et al. (1991). Typically, the small strength of the spin–orbit coupling, when compared to other terms in the Kohn–Sham Hamiltonian, allows for a treatment involving perturbation methods. As an example, we mention that, for uniaxial magnets, the leading term is of second order in the spin–orbit interaction. This has been analysed, for example, by Bruno (1989) and Andersson et al. (2007) in a rather general situation which describes the magnetic anisotropy energy of a compound built up of several elements. Using perturbation theory, the following expression of energy differences for a system with different directions (nˆ 1 and nˆ 2) of the magnetization was derived:

46 Applications of Density Functional Theory EMAE ∝ qss Essos c,q(nˆ 1) – Essos c,q(nˆ 2),

(3.3)

where

Essos c,q(nˆ ) = –
kij q

Akis,ql,q l Akjs ,q l ,ql .
{l}

qls|ξql · s|ql s q l s |ξq l · s|q l s . kj – ki (3.4)

In this expression, k is the wavevector, whereas i, j are indices of occupied and un-

occupied Bloch states, respectively. The spin indices s and s denote the spin of

the Kohn–Sham states i and j. The index {l} represents a set of quantum numbers of

the wave function expansion in Eqn (2.16), whereas l · s is, as discussed in Section 2.5,

the interaction between orbital and spin angular momentum operators. In addition,

ki, kj are Kohn–Sham energies of the unperturbed system, that is, ones without spin– orbit interaction. Finally, the coefﬁcients Akis,ql,q l = ck∗is,qlckis,q l , where the c-coefﬁcients
are the expansion coefﬁcients of the electron wave function Eqn (2.16), and the spin–

orbit strength of atom q is denoted ξq in Eqn (3.4). Having Eqn (3.4) is useful, since it makes it possible to analyse the magnetic anisotropy of complex systems such as com-

pounds with more than one atom type. An obvious observation is that states that are

close in energy but on different sides of the Fermi energy contribute maximally to the

magnetic anisotropy energy. In addition, since heavy elements have larger spin–orbit

coupling than lighter ones do, it is possible that compounds composed of lighter elem-

ents at site q, such as a 3d element that provides a large exchange splitting and magnetic

moment, and heavier elements at site q may develop a large magnetic anisotropy. Ac-

cording to Eqn (3.4), a heavy element provides a large value of ξq in Eqn (3.4) and,

if the hybridization of electron states is large, that is, if Akis,ql,q l is signiﬁcant, a large

magnetocrystalline anisotropy is possible. An example of such a material is FePt.

In order to illustrate the inﬂuence of the denominator in Eqn (3.4), we discuss the

magnetic anisotropy energy of hcp Gd. In Fig. 3.6, we show the calculated and measured

magnetic anisotropy energy of hcp Gd. It can be seen that experiment gives an easy axis

which is at an angle approximately 30◦ away from the c-axis. The theory also gives an easy axis which is tilted away from the c-axis and which has a minimum at 30◦ from

the c-axis and an energy which is ∼2 μeV/atom lower compared to when the moment

is parallel to the c-axis. It should be remembered here that the theory shown in Fig. 3.6

treats the 4f shell as part of the core, and all contributions to the theoretical magnetic

anisotropy energy come from a relativistic treatment including spin–orbit interaction

of the spin polarized, itinerant valence band, something called ‘band contribution’ in

Fig. 3.6. When the classical dipole contribution is added to the ‘band contribution’ of hcp Gd, the calculated easy axis is at an angle of 20◦ from the c-axis (Colarieti-Tosti et al.,

2003). Hence, theory reproduces this peculiar feature in Gd, where the easy axis is not

aligned along a crystallographic direction but is pointing away from the c-axis. However,

the angle is somewhat underestimated in the calculations, and this result illustrates that

it is difﬁcult to achieve accuracy at the level of microelectron volts per atom. The data in

Heisenberg exchange parameters 47

40

ky Expt.
30

EA (μeV/atom)

Total

kx

Band contribution

20

Low energies

Dipole contribution 10

Around EF

0

0

20

40 60

80

θ (deg)

Figure 3.6 Calculated magnetic anisotropy of hexagonal close-packed Gd. The reference energy (zero energy) is when the magnetization is parallel to the 0001 direction. The right side shows ﬁrst-principles results, the classical dipole contribution to the magnetic anisotropy, as well as experimental data. The left side shows the contribution to the magnetic anisotropy from different energy regions as well as for different regions of the Brillouin zone, for a plane where kz = 0. Darker colours indicate larger contributions; EA, magnetic anisotropy energy; EF, Fermi energy.

Fig. 3.6 also show that additional terms in Eqn (3.1) are needed in the phenomenological expression for the magnetic anisotropy energy, for an accurate description of hcp Gd (Colarieti-Tosti et al., 2003). In order to analyse the importance of the denominator in Eqn (3.4), we show in the left part of Fig. 3.6 the contribution to the magnetic anisotropy energy, as it is broken up into different contributions, for example, from states which are close to the Fermi energy, and for states with energies lower in energy. This is shown for different regions in k-space, on the left side of Fig. 3.6. It may be seen in the ﬁgure that the majority of the contribution to the magnetic anisotropy energy comes from states close to the Fermi energy, as is expected from Eqn (3.4). Hence, in a sense, a calculation of the magnetic anisotropy energy of a material is, to a large extent, a matter of very accurately resolving the Fermi surface of that material.

3.4 Heisenberg exchange parameters
There are by now several implementations of Eqn (2.23), in different electronic structure software packages, that allow for accurate calculations of the Heisenberg exchange

48 Applications of Density Functional Theory

Figure 3.7 Exchange interaction J of hexagonal close-packed Co as a function of the distance. The grey and black circles correspond to atoms lying in even and odd (0001) planes, respectively; d is the distance between two Mn atoms, and a is the lattice constant. Figure redrawn after Turek I., Kudrnovský, J., Drchal, V., and Bruno, P., (2006), Exchange interactions, spin waves, and transition temperatures in itinerant magnets, Philos. Mag., 86, 1713–52.

J (mRy)

1.0

Hcp Co

0.5

0.0

1

2

3

4

5

6

7

d/a

parameters (e.g. in Liechtenstein, Katsnelson, and Gubanov, 1984; Liechtenstein, Kat-

snelson, Antropov and Gubanov, 1987; Frota-Pessôa et al., 2000; Turek et al., 2003;

Udvardi et al., 2003; Belhadji et al., 2007; Szilva et al., 2013; Kvashnin et al., 2015). As

an example of such calculations, we show in Fig. 3.7 the results for hcp Co (Turek et al.,

2003). This is a typical example of exchange interactions of a metallic ferromagnet,

where the interaction is dominated by near-range contributions but where, nevertheless,

long-range interactions, up to a length of three lattice constants, are signiﬁcant and may

not be ignored. Note also that, since hcp Co does not have an ideal c/a ratio, there are, for

each atom i, two sets of nearest-neighbour atoms j that are located almost, but not iden-

tically, at the same distance from i. These two sets of atoms are seen in Fig. 3.7 to have

quite different strengths of interatomic exchange interaction: atoms in the same 0001

plane have a different interaction than those in different 0001 planes. The magnon

curves and the spin wave stiffness constant calculated from exchange parameters ob-

tained via ﬁrst-principles electronic structure theory by using Eqn (2.23) are in general

in good agreement with observations, for example, as reviewed by Etz et al. (2015) and

as will be discussed in Chapter 9. In Fig. 3.8, exchange parameters for a dilute sys-

tem, that is, Mn-doped fcc Cu, are shown. Only interactions between Mn atoms are

shown, since these are the only atoms that carry signiﬁcant magnetic moment in this

system (Sato et al., 2010). Note that the ﬁgure contains results for various concentra-

tions of Mn, including the extreme limit of two interacting impurities (in the inset). In

this plot, the exchange interaction is multiplied by (d/a)3 (d is the distance between two

Mn atoms, and a is the lattice constant), since it is expected that the RKKY interaction

should dominate the exchange interaction in this system. The RKKY interaction scales

asymptotically

as

∼

cos(2kF R) R3

,

where

R

is

the

distance

between

the

magnetic

moments,

and kF is a so-called caliper vector (Pajda et al., 2001) that connects two different parts

of the Fermi surface. If the material has many such vectors with equal length and direc-

tion, a situation referred to as nesting occurs, which leads to a distinct contribution to the

cosine function of the RKKY interaction. Multiplying the exchange interaction with R3

(or d3) should then lead to a clear oscillatory behaviour. Figure 3.8 does indeed display

Non-collinear magnets 49

Fcc-Cu doped with Mn 30 20 10

0.5 % Mn 2.0 % Mn 5.0 % Mn

(d/a)3 J (mRy)
(d/a)3 J (mRy)

0

–10 –20 –30
5

200 150 100 50
0 –50 –100 –150 –200

Dilute interaction 10 20 30 40 50 60 70 80 90

15

25

35

45

55

65

75

d/a

Figure 3.8 Exchange interaction J along the dominating 110 direction in CuMn alloys for 0.5, 2.0, and 5.0 % Mn concentrations. Interactions are multiplied by the factor (d/a)3, where d is the distance between two Mn atoms, and a is the lattice constant. Exchange interactions between
two isolated impurities in a face-centred cubic (fcc) Cu host are shown in the inset. Figure
redrawn after Turek, I., Kudrnovský, J., Drchal, V., Bruno, P., and Blügel, S., (2003), Ab initio theory of exchange interactions in itinerant magnets, Phys. Status Solidi (b), 236, 318–24.

such behaviour and provides a very good example of RKKY interaction, which, according to Fig. 3.8, seems to be present for all Mn concentrations and is particularly clear in the extremely dilute limit of two impurities interaction (shown in the inset). The period shown in Fig. 3.8 reﬂects very well the caliper vectors of the Fermi surface of fcc Cu.

3.5 Non-collinear magnets
So far, we have given examples of collinear magnets, which can be analysed theoretically using the Kohn–Sham equation, as described in Section 1.4. We end this chapter with one example of a non-collinear magnet, IrMnSi, space group Pnma. To analyse this material theoretically, one must use the non-collinear formulation of DFT, as described in Section 1.5. Before entering the discussion about the electronic structure and the magnetism of IrMnSi, we note that the theory of non-collinear magnetism dates back to the work of Herring (1966) and that the ﬁrst practical theories were pioneered by

50 Applications of Density Functional Theory
50

Energy (mRy)

0

–50 50

Energy (mRy)

0 Ir Si Mn

c

ba

–50 –Z

γ

Z

Figure 3.9 (Left) The crystalline and magnetic structure of IrMnSi. The magnetic moment of each Mn atom is marked with an arrow. (Right) Band structure of collinear (upper panel) and non-collinear (lower panel) magnetic structures of IrMnSi. The Fermi level is marked with a horizontal line. Reprinted ﬁgure with permission from Eriksson, T., Bergqvist, L., Burkert, T., Felton, S., Tellgren, R., Nordblad, P., Eriksson, O., and Andersson, Y., Phys. Rev. B, 71, 174420, 2005. Copyright 2005 by the American Physical Society.

Kübler and co-workers (Kubler et al., 1988; Kübler, 2009). Generalizations to these earlier works were published by Nordström and Singh (1996), and an extensive review on non-collinear magnetism was published by Sandratskii (1998).
IrMnSi has a cycloidal magnetic structure, that is, it has a non-collinear, magnetic structure, as was observed by T. Eriksson et al. (2005). The crystalline and the magnetic structures are displayed in Fig. 3.9. It may be seen from the ﬁgure that the Mn atoms carry a sizeable magnetic moment, while Ir and Si essentially are non-magnetic. Neutron scattering experiments have determined the size of the Mn moment to be 3.8 μB/atom, which can be compared to the 3.2 μB/atom obtained from DFT calculations (T. Eriksson et al., 2005). As the left side of Fig. 3.9 shows, the conventional chemical unit cell contains three sets of Mn atoms that are coupled in a non-collinear fashion, where the atoms closer to the edges of the cell point primarily along the b-axis while the Mn atoms in the centre of the unit cell are essentially antiparallel to each other and at an approximately 90◦ angle to the Mn atoms close to the cell edges. To complicate

Non-collinear magnets 51
things further, in the next unit cell along the c-axis, the directions of all the Mn moments are more or less reversed with respect to those in the unit cell below. This results in a magnetic propagation vector along the (0, 0, qc) direction. If all the Mn moments in the top cell were reversed by 180◦ with respect to those in the bottom cell, the value of qc would be 0.5. This was observed to almost be the case for IrMnSi: the measured value of qc was 0.453 (T. Eriksson et al., 2005). This value of the propagation vector was reproduced well by DFT calculations, which gave a value of 0.43 (T. Eriksson et al., 2005). Hence, both experiment and theory indicate that IrMnSi is a material with complex non-collinear structure inside every conventional unit cell, a magnetic structure that is modulated along the c-axis in a way that is incommensurate with the underlying crystal structure.
One may ask why magnetic moments of any material would prefer such a complex orientation as that shown in Fig. 3.9. A possible explanation could lie in the analysis of the Heisenberg exchange parameters, which potentially may have competing ferromagnetic and antiferromagnetic interactions. This, of course, could shine some light into complex magnetic orderings, but this analysis immediately opens up questions concerning the microscopic background underlying why the Heisenberg interactions of a material like IrMnSi would be competing ferromagnetically and antiferromagnetically. A slightly different way to analyse complex magnetic orderings would be to investigate band dispersion. This can be done for IrMnSI, in a manner similar to what has been done in the past for several non-collinear magnetic materials (Kubler et al., 1988; Sandratskii, 1998; Lizarraga et al., 2004; Kübler, 2009). To illustrate this, we show the band dispersion of IrMnSi, for the ground-state magnetic conﬁguration and for a hypothetical ferromagnetic conﬁguration. The bands are shown in the right side of Fig. 3.9; the ferromagnetic bands are shown in the top, and the non-collinear bands are shown at the bottom. According to Chapter 1, Section 1.5, a non-collinear formulation of the Kohn–Sham equation results in energy bands that, in general, have admixtures of spin-up and spin-down character. This is in sharp contrast to the case with a collinear formulation, where, if spin–orbit coupling is neglected, pure spin states emanate from the DFT machinery. Hence, the band dispersion of a non-collinear magnet allows for hybridization between many more levels, compared to that of a collinear magnet, where spin-up and spin-down states are orthogonal and cannot mix. If hybridization of the non-collinear magnetic conﬁguration pushes energy levels away from EF to lower energies, the total energy of the material is lowered. When comparing the two panels on the right side of Fig. 3.9, we observe that this, indeed, is the case: the ground-state magnetic conﬁguration of IrMnSi has a signiﬁcantly reduced number of bands close to EF, as compared to the ferromagnetic conﬁguration. Hence, IrMnSi is an example of a magnetic material with a complex magnetic structure that is stabilized due to the band mechanism proposed by Kübler (2009); Kubler et al. (1988); Sandratskii (1998), and Lizarraga et al. (2004).

Part 2
Equation of Motion for Atomistic Spin Dynamics
The connection between the Kohn–Sham equation and the main equation for atomistic spin dynamics, the atomistic, stochastic Landau–Lifshitz (or Landau–Lifshitz–Gilbert) equation is established in Part 2 of this book. The formal aspects of a multiscale approach for atomistic spin dynamics simulations are covered in this section, both regarding the derivation of the equation of motion of atomistic spins and the limitations and advantages this approach has, in terms of time scales and the sizes of simulation cells. In addition, it is discussed how all parameters of the atomistic Landau–Lifshitz equation can be calculated from DFT, how ﬁnite temperatures enter the theory, and how an efﬁcient and practical implementation of these equations into software form should be done. Mechanisms of dissipation of energy and angular momentum between atomic spin, lattice, and electron reservoirs are also discussed in this part of the book.

4
The Atomistic Spin Dynamics Equation of Motion

From the information obtained in density functional theory (DFT), in particular the magnetic moments and the Heisenberg exchange parameters, one has the possibility to make a connection to atomistic spin dynamics. In this chapter, the essential features of this connection are described. It is also discussed under what length and time scales this approach is a relevant approximation. The master equation of atomistic spin dynamics is derived and discussed in detail. In addition, we give examples of how this equation describes the magnetization dynamics of a few model systems.

4.1 A few introductory comments

The stochastic Landau–Lifshitz–Gilbert equation

dmi dt

= –γLmi ×

Bi + Bﬂi

–

γL

α mi

mi

×

mi ×

Bi + Bﬂi

(4.1)

is the equation of motion for atomic moments, and the derivation of this equation is the
main focus of this chapter and Chapter 5. In Eqn (4.1), mi = mi(t) is the magnetic moment of an atom at site i in the lattice, as deﬁned in Section 2.6. According to Eqn (4.1),
the atomic moment at site i experiences an effective magnetic ﬁeld Bi = Bi(t), and a stochastic magnetic ﬁeld Bﬂi = Bﬂi (t). The ﬁrst term of the equation is the precessional motion, while the second term describes the damping motion. Furthermore, γ is the
gyromagnetic ratio, while the renormalized gyromagnetic ratio is

γ γL = (1 + α2) ,

(4.2)

and α is a scalar (isotropic) Gilbert damping constant. The renormalization of the gyromagnetic ratio is a consequence of expressing the Landau–Lifshitz–Gilbert equation in

Atomistic Spin Dynamics. Olle Eriksson, Anders Bergman, Lars Bergqvist, Johan Hellsvik. First Edition. © Olle Eriksson, Anders Bergman, Lars Bergqvist, Johan Hellsvik 2017. First published in 2017 by Oxford University Press.

56 The Atomistic Spin Dynamics Equation of Motion
the same form as the Landau–Lifshitz equation. The relationship between the Landau– Lifshitz equation and the Landau–Lifshitz–Gilbert equation is analysed in detail in Section 4.6. The damping parameter and the more general forms of it will be discussed in detail in Chapter 6, especially with focus on how one can evaluate it from ﬁrst-principles electronic structure theory as described in Chapters 1 and 2. The ﬂuctuating, stochastic magnetic ﬁeld Bﬂi describes how temperature effects enter the theory of atomistic spin dynamics, in a Langevin dynamics approach. This is the topic of Chapter 5 and will not be discussed further in this chapter. We note also that, disregarding the Langevin forces Bﬂi , the form of Eqn (4.1) is identical to the micromagnetic Landau– Lifshitz equation (MMLL; L. Landau and Lifshitz, 1935), with the important difference being that, in the MMLL equation, the primary variable is a vector ﬁeld describing the magnetization density, while Eqn (4.1) describes the dynamics of the natural building block of any material, atoms and their magnetic moments.
This and the following two chapters hence contain the derivation of the stochastic Landau–Lifshitz (SLL) equation of motion from ﬁrst principles, methods for calculating of the damping parameter, and how to incorporate temperature. In the present chapter, the equations of motion for atomistic spin dynamics (ASD) will be worked out, while Chapter 5 covers ﬁnite temperature effects, and Chapter 6 presents techniques for the calculation of the Gilbert damping parameter from state-of-the-art electronic structure methods.
4.2 Spin dynamics from ﬁrst principles
Spin dynamics from ﬁrst principles is a relatively young development. In two pioneering papers from the mid-1990s, Antropov et al. (1995, 1996) developed in detail how the time evolution of the magnetization at ﬁnite temperatures can be calculated within DFT. The scheme was very extensive and included treatment of systems with substantial orbital contribution to the magnetization and opened up for simultaneous spin and molecular dynamics. Example calculations were done for γ-Fe, a crystalline phase of iron known for its complicated magnetic structure. Alternative derivations of the equation of motion for local spin magnetic moments in the adiabatic limit have also been communicated by Niu et al., (1999) Z. Qian and Vignale (2002), and Bhattacharjee, Nordström, et al. (2012). Constraining magnetic ﬁelds were used in the self-consistent calculations of adiabatic spin dynamics by Stocks et al. (1998), and Ujfalussy et al. (1999). Very recently, time-dependent DFT (TD-DFT) methods have been developed in order to investigate spin dynamics beyond the adiabatic approximation; this will be commented on in Chapter 12.
To date, the majority of theoretical studies of ASD take as their starting point a magnetic Hamiltonian (see e.g. G. Brown et al., 2001; Nowak et al., 2005; Skubic et al., 2008; Evans et al., 2014). The Heisenberg exchange and other parameters in the Hamiltonian (see Section 4.8) can either be calculated from ﬁrst principles by means of DFT methods (Skubic et al., 2008), or be ﬁtted to experimental data from, for example, neutron

Equations of motion for the spin and charge densities 57
scattering and Raman spectroscopy measurements or to reproduce values of more aggregated properties such as the critical temperature and the spin wave stiffness. The former approach is the route taken in the UppASD software (http://www.physics.uu.se/uppasd).

4.3 Equations of motion for the spin and charge densities

Omitting the spin–orbit coupling terms, the Kohn–Sham Hamiltonian Eqn (1.31) reduces to

HαKβS

=

–

1 2

∇

2δαβ

+

veαfβf(r, t)

+

1 σˆ · Beff(r, t) ,

2c

αβ

(4.3)

where the index KS stands for Kohn–Sham. From this Hamiltonian, the equations of motion for the charge and spin densities, deﬁned from the eigenstates of Eqn (4.3) as n(r, t) = ψ†(r, t)ψ(r, t) and s(r, t) = ψ†(r, t)sˆψ(r, t), respectively, can be derived in several ways. The most compact derivation proceeds over the Heisenberg equation of motion for operators. The alternative derivation by means of the Pauli–Schrödinger equation and its complex conjugate is more lengthy, but has the advantage that the complex conjugations of operators and wave functions are more transparent. In the following presentation, a mixture of the two approaches is used.
Suppressing the orbital index and the spin index, the Pauli–Schrödinger Kohn–Sham equation and its complex conjugate are written compactly as

∂ψ(r, t) i

=

H KSψ(r, t);

∂t

∂ψ†(r, t)

–i

=

H KSψ(r, t) † .

∂t

(4.4)

The time evolution of the charge density n(r, t) = ψ†(r, t)ψ(r, t) is straightforwardly calculated as

∂n(r, t) ∂ =

ψ†(r, t)ψ(r, t)

=

ψ†(r,

∂ ψ(r, t)

t)

+

∂ψ†(r, t) ψ(r, t)

∂t

∂t

∂t

∂t

1 =

ψ†(r, t)H KSψ(r, t) – [H KSψ(r, t)]†ψ(r, t)

i

=

1 ∇·

[∇ψ†(r, t)]ψ(r, t) – ψ†(r, t)∇ψ(r, t)

2i

= –∇ · Jp,

(4.5)

where the paramagnetic charge current density has been deﬁned as

Jp

=

1 {ψ†(r, t)[∇ψ(r, t)(r)] – [∇ψ†(r, t)]ψ(r, t)(r)}. 2i

(4.6)

58 The Atomistic Spin Dynamics Equation of Motion

Similarly, the time evolution of the spin density s(r, t) = ψ†(r, t)sˆψ(r, t) proceeds as

∂s(r, t) ∂ =

ψ†(r, t)sˆψ(r, t) = ψ†(r, t)sˆ ∂ψ(r, t) + ∂ψ†(r, t) sˆψ(r, t)

∂t

∂t

∂t

∂t

1 =

ψ†(r, t)σˆ H KSψ(r, t) – H KSψ(r, t) † σˆψ(r, t)

2i

= 1 ∇ · [σˆ∇ψ†(r, t)]ψ(r, t) – ψ†(r, t)σˆ ∇ψ(r, t) – γs × Beff 4i

= –∇ · Js – γs × Beff,

(4.7)

where Beff is the magnetic part of the effective Kohn–Sham potential, see Eqn (4.3). The spin current density, a tensorial quantity formed from the direct product of orbital and spin space, is deﬁned as

Js

=

1 {ψ†(r, t)[σˆ ∇ψ(r, t)] 4i

–

[σˆ∇ψ†(r,t)]ψ(r, t)},

(4.8)

to analog the paramagnetic charge current density. We note that the deﬁnition of the spin current has been a matter of some debate. A profound difference between the charge and the spin current is that whereas electronic charge is a preserved quantity obeying a continuity equation, Eqn (4.5), spin is not necessarily conserved. Some authors (G. Sun and Xie, 2005) refer to the quantity deﬁned by Eqn (4.8) as the linear spin current, and the precession of the spin as the angular spin current.
The divergence operator in the last part of Eqn (4.7) acts on the orbital space. The action of the spin currents on the magnetization is the mechanism behind spin-transfer torque (Ralph and Stiles, 2008), which has received much attention since the seminal works of Slonczewski (1996) and Berger (1996). The mechanism is also important as it contributes to the relaxation of the magnetization. To conclude this part, we note that, in compact form, the TD-DFT equations for the charge and spin densities, in the absence of stochastic damping mechanisms, are written as

∂n(r, t) ∂t = –∇ · Jp,

∂s(r, t) ∂t

=

–∇

·

Js

– γs × Beff.

(4.9) (4.10)

If we omit the current term and integrate the expression for spin density over, for example, an atomic sphere at site i, the so-called atomic moment approximation (see Fig. 2.7), so that we can do the replacement s(r, t) → mi(t), we arrive at the precessional term of Eqn (4.1). However, this requires a separation of the time-scale of electron motion from that of the atomic spins, an issue addressed in Chapter 2, Section 2.6. Before proceeding with this analysis, we ﬁrst make a small comment on alternative ways of deriving Eqns (4.9) and (4.10). Wieser (2015) recently explored how equations for dissipative quantum dynamics can be derived if one takes as the starting point a non-Hermitian Hamiltonian

Local coordinate systems and the adiabatic approximation 59

H = H0 – iλ

(4.11)

and calculates the time evolution of the expectation value of the density matrix through
the Liouville or Heisenberg equation; H0 is a Hermitian Hamiltonian of the quantum system, γ is a non-Hermitian Hamiltonian describing dissipation processes, and λ ∈ R+0 . The norm of the wave function was preserved by replacing γ with γ– γ (Wieser, 2015).
Working with the Schrödinger equation

i d |ψ(t) = (H – iλ [ – ]) |ψ(t) , dt

(4.12)

it is possible to arrive at the equation of motion for the expectation value of the spin operator,

d sˆ dt = sˆ × Beff – λ sˆ × sˆ × Beff ,

(4.13)

which yields both the precessional term, as found also in Eqns (4.9) and (4.10), as well as a damping term that appears as the second term on the right-hand side of Eqn (4.13).

4.4 Local coordinate systems and the adiabatic approximation
Atomistic spin dynamics simulations, using the SLL equation, are commonly pursued for the order of 104 to 109 atomic magnetic moments. A direct calculation of the spin polarized TD-DFT equations of motion for such large number of atoms is not yet feasible due to the excessive computational effort required, and Eqn (4.1) has to be used instead. For the case of a few atoms (<10), pioneering TD-DFT studies have very recently been pursued, which will be discussed as an outlook on ab initio spin dynamics, in Chapter 12. The step taken to avoid the complications with solving a time-dependent Kohn–Sham equation is a separation of slower and faster time scales, where the slower developing variables are regarded as frozen on time scales on which the faster degrees of freedom evolve. This was discussed loosely in Chapter 2 and is further elaborated upon here. The starting point for the adiabatic approximation is to assume that the timeindependent Schrödinger equation holds at any instant of time for an effective potential that depends parametrically on time. For slow enough time evolution of the potential, the eigenvalues will depend on time in such a way that no levels cross and transitions to other levels do not occur. The most well-known example of the adiabatic approximation is the Born–Oppenheimer approximation, in which the time scales for electronic and ionic motion in a crystal or molecule are separated. The Born–Oppenheimer approximation relies on the difference in mass of heavy ions and light electrons and can be worked out in a systematic manner (Ashcroft and Mermin, 1976). For the dynamics of a spin polarized density matrix, the slow variable is the evolution in time of the local

60 The Atomistic Spin Dynamics Equation of Motion

Figure 4.1 A pictorial illustration of the dynamics in a two-component magnetic solid. Femtosecond-time-scale fast dynamics occur for the charge density and the magnitude of the magnetization, which both, in the local coordinate frame deﬁned by Eqn (4.14), are diagonal in the density matrix. Transversal ﬂuctuations of the magnetization correspond to the slower dynamics of the off-diagonal parts of the density matrix, a dynamics which on atomic length scales nevertheless is in the multiples of teraherz regime. Figure kindly provided by Dr. Diana Ius¸an.

direction of the magnetization, which typically is relevant for time scales of picoseconds or longer, while the dynamics of the electrons is many orders of magnitude faster (of the order of 0.1 fs as was discussed in Chapter 2, Section 2.6), as is schematically shown in Fig. 4.1.
Before giving the full details for establishing a connection between Eqns (4.9), (4.13), and (4.1), we outline how a straightforward time evolution of the TD-DFT equations may be obtained. We start by considering the density matrix in a general form, where due to, for example, a non-collinear magnetic conﬁguration, the density matrix is nondiagonal and hence has components ραβ that are non-zero, Eqn (1.27). It is however possible to ﬁnd a local coordinate system at any point in space and at any time, where a diagonal representation of the density matrix can be formed, by a unitary transformation (Sandratskii, 1998; Kübler, 2000):

ρ↑(r, t) 0 0 ρ↓(r, t)

=

Uαα(r, t) Uβα(r, t)

Uαβ(r, t) Uββ(r, t)

ραα(r, t) ρβα(r, t)

ραβ(r, t) ρββ(r, t)

Uαα(r, t) Uβα(r, t)

Uαβ(r, t) Uββ(r, t)

†
,

(4.14)

where ρ↑ and ρ↓ are the components of majority ‘spin-up’ and minority ‘spindown’ densities, respectively, deﬁned locally in space and time. In this equation, Uαβ[θ(r, t), φ(r, t)] is a spin half-rotation matrix:

Local coordinate systems and the adiabatic approximation 61

Uαβ(θ(r, t), φ(r, t)) = –eexxpp((iiφ2φ2))csoins((2θ2θ)) eexxpp((––iiφ2φ2))scions((2θ2θ)) .

(4.15)

The rotation matrix U (θ, φ) is speciﬁed to diagonalize ραβ, and hence the required angles θ, φ that deﬁne U (θ, φ) and describe the direction of the magnetization can be evaluated from ραβ as

tan φ = – Im(ραβ) , Re(ραβ)

2 tan θ =

(Re(ραβ))2 + (Im(ραβ))2 .

(ραα – ρββ)

(4.16)

In the adiabatic limit, one can freeze the magnetization direction at each point in space, and via, for example, the local density approximation, obtain an effective potential in which the directions that specify ‘spin up’ and ‘spin down’ vary in space. A selfconsistent calculation of the density matrix using Eqn (1.27) can be obtained from solutions to the time-independent Kohn–Sham equation, Eqn (1.26), generalized to the non-collinear case (Sandratskii, 1998; Kübler, 2000):

∇2 – 1+
2

Vαeαff(r) Vβeαff(r)

Vαeβff(r) Vβeβff(r)

ψiα(r) ψiβ(r)

=i

ψiα(r) ψiβ(r)

.

(4.17)

Note that, in this equation, the wave function is written in a general spinor form, the effective potential in Eqns (1.32) and (1.33) is written in matrix form, and 1 is the 2 × 2 identity matrix. For a collinear magnetization density, the off-diagonal elements of the effective potential, Vαeβff in Eqn (4.17), are equal to 0, and we can solve the Kohn–Sham equation separately for ψiα and ψiβ, that is, we recover Eqn (1.26).
Schematically, the evolution in time of the fast and slow degrees of freedoms in a magnetic solid is shown in Fig. 4.1. In the adiabatic approximation of TD-DFT the complete set of equations for a new direction of the magnetization density is obtained from the density matrix evaluated from Eqn (4.17) and (1.27), together with Eqn (4.16). In presence of a driving ﬁeld, that is, a time-dependent component of the ﬁeld Beff in Eqn (4.9), new magnetization directions should be updated at each time step. The calculation of the evolution of the magnetization and charge densities from a time t to t + t then becomes a two-step procedure. The ﬁrst step is to solve Eqn (4.17) until selfconsistency is obtained. This step involves a constraining ﬁeld so that the atomic moment directions are ﬁxed along some direction. The second step is to evolve the equation of motions for the slow degrees of freedom (i.e. the magnetization direction according to Eqn (4.9)) in a time interval t. This step requires the calculation of a local ﬁeld, Beff, which can be evaluated from Kohn–Sham wave functions. With the new directions for the atomic magnetic moments, Eqn (4.17) is solved anew, with an updated constraining ﬁeld, and the process is iterated.

62 The Atomistic Spin Dynamics Equation of Motion
4.5 The atomic moment approximation and constraining ﬁeld

In general, the magnetization density can show non-collinearity also on intra-atomic length scales, as exempliﬁed by deviations from purely collinear magnetism in ferromagnetic fcc Pu (Nordström and Singh, 1996) and non-collinear deviations from an antiferromagnetic Néel structure in unsupported Cr monolayers (Sharma et al., 2007). For many materials and situations, it is reasonable to approximate the full noncollinearity of the density matrix by assuming that the magnetization density is locally collinear in the vicinity of an atom (Sandratskii, 1998; Kübler, 2000). In this atomic moment approximation, the volume one integrates over becomes an issue but, as will be discussed in Chapter 9, this is in practice seldom a problem (Andersen and Jepsen, 1984; Turek et al., 1997). Regardless of how the partitioning of space is done, an atomic magnetic moment can be deﬁned for each lattice site i as the integral of the magnetization density over the region i,

mi = m(r) dr.
i

(4.18)

A general non-collinear magnetic conﬁguration does not constitute a ground state within DFT. The iteration of Eqn (4.17) towards self-consistency for the electronic structure would by itself drift towards the ground state, for example, a collinear ferromagnetic state. To prevent this, constraining ﬁelds can be included. The technique used in practice is to use additional constraints in the form of Lagrangian multipliers (Dederichs et al., 1984; Schwarz and Mohn, 1984), in order to constrain some quantity, such as the total particle number of the unit cell, the l-projected charge inside a mufﬁn-tin or atomic sphere, or the size of the magnetic moment (Mohn, 2006). For self-consistent ﬁeld ASD, the directions of the atomic magnetic moments should be ﬁxed during the calculation of the electronic structure. This can be achieved by the addition of a constraint:

m(r, t) × eci on dr = 0, ∀i.
i

(4.19)

The cross-product form of the constraint ensures that the atomic magnetic moment has no components normal to the direction of the prescribed magnetization direction eci on. An important observation was done by (Stocks et al., 1998), who realized that the magnetic ﬁeld that is used to constrain the direction of the magnetic moment can be used to construct the effective ﬁeld that gives the correct precession torque on the local magnetic moment, a torque that is needed to perform self-consistent ﬁeld calculation spin dynamics simulations. The technique, called the constrained local moment approach (CLM), has, for example, been used to investigate the canted magnetism of a ﬁnite Co chain along a Pt(111) surface step edge (Újfalussy et al., 2004). We will now discuss this method further with respect to how it works in practice, closely following the original discussion by Stocks et al. (1998).

The atomic moment approximation and constraining ﬁeld 63

Using the atomic moment approximation, introduced in Chapter 2 and in Eqn (4.18), we deﬁne a unit vector ei of the local magnetization ei = mi/|mi|. Expressed in terms of the unit vectors, the equation of motion reads (Antropov et al., 1996)

dei dt

= –2ei × Bi({ei}),

(4.20)

where Bi({ei}) is the effective magnetic ﬁeld on each site given by the expression

Bi ({ei

})

=

–

∂

E ({ei ∂ mi

})

,

(4.21)

where E({ei}) is not an energy calculated from a parametrized magnetic Hamiltonian but instead a DFT energy functional. In the CLM approach, the Kohn–Sham equation, Eqn (4.17) is solved in the presence of constraining ﬁeld on each atomic moment in order to ensure that the local magnetic moment is kept ﬁxed using Eqn (4.19).
The constraint is achieved by adding a penalty energy functional to the normal energy functional, Eqn (1.20), which is thus generalized to noncollinear magnetic states (Section 1.5) such that the total energy functional becomes

Econ ρ(r); m(r); Bcon(r) = E [ρ(r); m(r)] + m(r) · Bcon(r).

(4.22)

The effective ﬁeld appearing in the Kohn–Sham Hamiltonian for non-collinear magnetic states, Eqn (4.3), including the constraining ﬁeld, then reads (Stocks et al., 1998)

Bei ff = Bxi c[m(r)] + Bci on(r) = eiBixc + Bci on(r). Self-consistency is enforced by the following three conditions:

(4.23)

n(r) = Tr[ρˆ(r)], m(r) = ei ei · Tr[σˆρ(r)] ,

(4.24) (4.25)

∂Econ ρ(r); m(r); Bcon(r)

∂ ei

= 0, ∀i.

(4.26)

Given that the atomic moment approximation was used from the very start, it is possible to use the following functional form for the constraining ﬁeld:

Bci on(r) = ciBxc(r),

(4.27)

where ci denotes a constraining factor. With the above constraints and functional form for the constraining ﬁeld, the effective ﬁeld to be used in conjunction with the equation of motion, Eqn (4.20), comes out as

64 The Atomistic Spin Dynamics Equation of Motion

Bi

=

– ci mi

m(r)Bxc(r) dr.
i

(4.28)

In order to ﬁnd the constraining ﬁeld according to the self-consistency conditions, an
iterative procedure was proposed by Stocks et al. (1998): as the zeroth step of the iteration, a trial initial constraining ﬁeld ciin is chosen; then, in subsequent iteration steps, the constraining ﬁeld is obtained according to

cni ew = ciin – ciin · ei ei – eoi ut – eoi ut · ei ei ,

(4.29)

a procedure similar to schemes for charge density mixing to achieve self-consistency in normal density functional calculations. Eqn (4.29) guarantees that eoi ut converges to the constrained orientation and that ciin converges to ci.

4.6 Damping motion and relaxation

With the atomic moment approximation introduced in Section 4.5, and in Section 2.6, we can now focus on the master equation of ASD, Eqn (4.1). The ﬁrst term on the righthand side of this equation describes the conservative dynamics of an ideal spin system that does not exchange energy with its environment. If this were the only driving term of the magnetization dynamics, the system would, for example, not respond to changes in the temperature of its environment. Mechanisms describing dissipation of energy and angular momentum are found in the second term on the right-hand side of Eqn (4.1), and are referred to as damping. We will devote Chapter 6 to a detailed description on how to calculate the damping from ﬁrst principles, but we make a shorter analysis here on its effects and the mechanisms that are responsible for it.
Landau and Lifshitz included a relaxation term in the equation of motion, already in their original paper (L. Landau and Lifshitz, 1935) on magnetization dynamics. They proposed a double-cross-product damping term in addition to the precession term, yielding the equation known as the Landau–Lifshitz equation:

∂m ∂t

=

–γm × B –

λ m × (m × B). m

(4.30)

The damping torque is seen from this equation to be perpendicular to the precession torque, and its relative contribution is determined by the parameter λ. To illustrate the effects of the precessional term and the damping contribution, we show in Fig. 4.2 the motion of a single spin exposed to an external magnetic ﬁeld, B. Note that, in this ﬁgure, we have replaced λ with γα for reasons that will be clear below. The dynamics outlined in Fig. 4.2 is seen to be a spiralling motion where the spin eventually aligns with the ﬁeld.
In classical mechanics, the friction force acting on a particle moving through a viscous media is to ﬁrst-order approximation proportional to, and negative in direction to, its velocity (Goldstein et al., 2002). Gilbert (2004) introduced an analogous damping force for magnetization dynamics, thus creating the Landau–Lifshitz–Gilbert equation:

Damping motion and relaxation 65

B

−γ

α
m

m × (m × B)

−γ m × B m

Figure 4.2 Motion described by the Landau–Lifshitz equa-

tion. The atomic magnetic moment m (thick black arrow)

revolves in damped precessional motion around the effective

magnetic ﬁeld B (thick grey arrow). The thin black arrow

shows the tangent vector of the precessional motion –γmi × B,

and the dashed thin black arrow shows the tangent vector of

the

damping

motion

–γ

α m

m

×

(m

×

B).

For

a

scalar

Gilbert

damping α parameter, the damping motion is perpendicular

to the precessional motion; γ is the gyromagnetic ratio. Figure

kindly provided by Dr. Danny Thonig.

∂m ∂t

=

–γm × B +

αm× m

∂m ∂t .

(4.31)

As for the Landau–Lifshitz damping torque, the Gilbert damping torque is perpendicular to the precession torque. In the limit of small damping, the solutions of the Landau–Lifshitz and the Landau–Lifshitz–Gilbert equations are close to each other. For larger damping, the discrepancy is signiﬁcant. As will be shown in Section 4.7, the Landau–Lifshitz and the Landau–Lifshitz–Gilbert equations are identical in the case of isotropic damping, provided a renormalized gyromagnetic ratio is introduced. In the micromagnetic community, the Gilbert form of damping has been the more popular choice, and it was indeed shortcomings of the Landau–Lifshitz equation for damping that motivated Gilbert’s research.
In Fig. 4.3, we illustrate, with a simple but realistic example, how the precession torque and the damping term of the SLL equation contribute to the time evolution of magnetism. The system under consideration is a thin ﬁlm of a ferromagnetic material, a monolayer of Fe on a W(110) surface, where all magnetic interactions are described by Heisenberg exchange calculated using multiple scattering theory as described in Section 3.4 and as reported by Bergman et al. (2010). Initially, this ferromagnetic system has one of its atomic spins reversed to align antiparallel to its neighbours, as shown in the upper left part of Fig. 4.3, where the increased coloured contrast in the ﬁgure indicates the degree of deviation from ferromagnetic alignment. At t = 0 ps, it is only the spin in the middle of the simulation cell that has a reversed orientation. However, as time passes, other atomic spins that are in the vicinity of the original ﬂipped atomic spin start to have their orientations deviate from collinear ferromagnetic order. This can be seen in, for example, the spin conﬁguration at t = 0.5 ps, where a ‘spin cloud’ has developed. The simulations shown in Fig. 4.3 have been done without damping, and therefore energy and angular momentum do not leave the simulation cell. The time evolution of the spin cloud is therefore not the result of a global energy minimization but may be seen as a local energy minimization in which the exchange energy is spread out between more and more atomic spins. With time, the spin cloud continues to grow, but as it does so it becomes more and more diffuse, that is, with a less pronounced deviation from the ferromagnetic ground state. This is clear from the snapshots of the simulation at t = 1,

66 The Atomistic Spin Dynamics Equation of Motion

0.0 ps

0.5 ps

1.0 ps

2.0 ps

3.0 ps

4.0 ps

Figure 4.3 Simulated snapshots of the relaxation of a single ﬂipped spin in a monolayer of Fe on a W(110) surface. The ﬁrst panel shows a single ﬂipped spin in the centre of the ring, which is added for clarity. Here, no damping is included in the simulation, and the system does thus not relax to the equilibrium ferromagnetic state, but the excitation gets more and more smeared out across the system over time.

2, and 3 ps, as these have less and less colour contrast as the spin cloud becomes larger and larger time over. An interesting feature that can be seen in Fig. 4.3 is also that the ‘cloud’ of distorted spins does not propagate isotropically across the sample; ﬁrst, it extends in the horizontal (001) direction and, after some time, it extends more in the vertical (11¯ 0) direction. This is caused by the fact that, owing to the symmetry of the surface, the exchange interactions differ along the different surface directions. An effect that can be inferred from this anisotropic distribution of the spin cloud is that the group velocity of magnons on this surface would also behave anisotropically and depend on their propagation direction. The inﬂuence of damping is shown in Fig. 4.4. Here, all parameters are kept the same as for the simulation in Fig. 4.3, with the only difference being the presence of a Gilbert damping parameter of α = 0.01. It may be noted that initially the results in Fig. 4.4 are similar to those in Fig. 4.3; for example, a spin cloud develops and grows with time. However, in Fig. 4.4, energy and angular momentum can dissipate from the system and, as a consequence, the system relaxes to its global energy minimum, that is, the ferromagnetic state. For this reason, the spin-cloud becomes more and more diffuse in time, as is clear in Fig. 4.4, and, eventually, it disappears completely.
We end this section with a short comment on Eqn (4.13), which naturally introduces a damping term in the equation of motion of spin operators. Hence, damping is seen to naturally emerge from a microscopic theory of quantum mechanical operators. If one adopts the atomic moment approximation, damping emerges in an equation of motion of atomic spins and is not an ad hoc interaction that simply is added to the Landau–Lifshitz equation.

The relation between the Landau–Lifshitz and the Landau–Lifshitz–Gilbert equations 67

0.0 ps

0.5 ps

1.0 ps

1.5 ps

2.0 ps

3.0 ps

Figure 4.4 Simulated snapshots of the relaxation of a single ﬂipped spin in a monolayer of Fe on a W(110) surface. The ﬁrst panel shows a single ﬂipped spin in the centre of the ring, which is added for clarity. Here, a ﬁnite damping is included in the simulation, and the system relaxes to the equilibrium ferromagnetic state within a few picoseconds.

4.7 The relation between the Landau–Lifshitz and the Landau–Lifshitz–Gilbert equations
The Landau–Lifshitz equation (Eqn (4.30)), and the Landau–Lifshitz–Gilbert equation (Eqn (4.31)), are closely related. In the case of isotropic damping, they are identical if a renormalized gyromagnetic ratio is introduced, as will be shown in this section. That the Landau–Lifshitz and the Landau–Lifshifz–Gilbert equations are not identical in the case of anisotropic damping is discussed by Steiauf and Fähnle (2005). The precession torque and the damping torque, whether in the Landau–Lifshitz form or the Gilbert form, preserve the magnitude of the magnetization m. This is easily proved by ﬁrst observing that this is equivalent to the statement that

Since

∂ m2 ∂t ≡ 0.

(4.32)

∂ m2

∂m

= 2m · ,

∂t

∂t

(4.33)

we should proceed with a scalar multiplication with m and its time derivative, here for the Landau–Lifshitz–Gilbert equation,

68 The Atomistic Spin Dynamics Equation of Motion

m · ∂m = –γm · (m × B) + α m · m × ∂m

∂t

m

∂t

=

–γB

·

(m

×

m)

+

α m

∂m ∂t

·

(m

×

m)

=

0,

(4.34)

which proves Eqn (4.32). The derivation using the Landau–Lifshitz equation is very similar.
We now proceed to establish a connection between the Landau–Lifshitz and the Landau–Lifshitz–Gilbert equations. Starting from the Landau–Lifshitz–Gilbert equation, the Landau–Lifshitz equation can be obtained after multiplication with m from the left:

m×

∂m ∂t

=

–γm × (m ×

B)

+

α m × (m × m

∂m ∂t )

= –γm × (m × B) + α m

m(m

·

∂m ∂t

)

–

∂m ∂t

(m

·

m)

.

(4.35)

Using

now

the

relation

m

·

∂m ∂t

=

0,

derived

in

Eqn

(4.34),

we

get

m × ∂m = –γm × (m × B) – αm ∂m .

∂t

∂t

(4.36)

This is substituted into the right-hand side of the Landau–Lifshitz–Gilbert equation:

∂m ∂t

=

–γm

×

B

–

α m

γm

×

(m

×

B)

+

αm

∂m ∂t

= –γm × B – α γm × (m × B) – α2m ∂m .

m

∂t

The

terms

containing

∂m ∂t

are

collected

on

the

left

to

give

(1 + α2) ∂m = –γm × B – α γm × (m × B),

∂t

m

∂m ∂t

=

γ

–

m

(1 + α2)

×

B–

(1

α + α2

)m

γm

×

(m

× B)

(4.37) (4.38)

in the Landau–Lifshitz form, with the relaxation expressed as a double cross product. Using the renormalized gyromagnetic ratio deﬁned in Eqn (4.2) and expressing the Landau–Lifshitz relaxation parameter λ in units of the Gilbert damping parameter α,

λ

=

(1

γα + α2)

=

γLα,

(4.39)

The magnetic Hamiltonian 69

the Landau–Lifshitz equation can be written as

∂m

α

∂t = –γLm × B – γL m m × (m × B).

(4.40)

For isotropic damping, the Landau–Lifshitz and the Landau–Lifshitz–Gilbert equation differ only in the regard that γL = γ. A common practice is to use the Landau–Lifshitz equation but specify the damping as a Gilbert damping parameter α. In the limit of vanishing damping, α → 0, the gyromagnetic ratios become equal, γL → γ. In studies of dynamics in the presence of a time-dependent external ﬁeld, it is important that the correct gyromagnetic ratio γL is used during the simulation. In other cases, it is also possible to rescale the time after the simulation, corresponding to using a different gyromagnetic
ratio.

4.8 The magnetic Hamiltonian

A critical aspect of ASD is establishing a practical expression for Bi in Eqn (4.1). The ﬁeld Bi should naturally contain all relevant interactions that each atomic moment may experience, where the most important one naturally is the interatomic exchange interaction. Other terms like the Dzyaloshinskii–Moriya (DM) interaction, the anisotropy ﬁeld, classical dipolar interactions, and an external Zeeman term may also be considered. The most efﬁcient way to consider these interactions is to include them in an effective spin Hamiltonian, for which one may evaluate the ﬁeld Bi from the expression

∂H

Bi

=

– ∂ mi

.

(4.41)

As was described in Chapter 2, Section 2.6, it is possible to evaluate the interatomic exchange from ﬁrst-principles theory, and provided spin–orbit interaction is considered, it is possible to also obtain accurate results for the DM interaction and the magnetic anisotropy energy (see Chapter 3, Section 3.3). Suitable parametrized forms of these interactions can then be used for the total spin Hamiltonian, which then becomes one of the critical aspects of the multiscale approach used when connecting DFT results to ASD simulations. This is much in the same way as quantum mechanical forces are used in ab initio molecular dynamics simulations to evolve in time the nuclear coordinates of atoms. Most magnetic Hamiltonians can be decomposed into the following terms:

H = HHeis + HMAE + HDM + Hdd + Hext.

(4.42)

Here, the ﬁrst term represents the interatomic Heisenberg exchange interaction, the second term represents the DM interaction, the third term represents the magnetocrystalline anisotropy energy (MAE), the magnetostatic dipole–dipole interaction is included in the fourth term, and the ﬁfth term is the Zeeman energy.

70 The Atomistic Spin Dynamics Equation of Motion

From Eqn (4.17), the Kohn–Sham equation of any non-collinear conﬁguration can be evaluated, and hence also its total energy. This can be done, for example, for a ferromagnetic host in which the magnetization direction of any of its atoms is rotated by a small amount. This could for instance be done from the rotation matrix in Eqn (4.14), possibly with a constraining ﬁeld as described above, and any continuous rotation could be considered in this way. Hence, a rotation of any atoms’ or any pair of atom’s magnetization direction could be considered, and hence also the changes in total energy for these rotations. Adopting the atomic moment approximation, this then corresponds to energies of continuous rotations of atomic spins, something which is described parametrically in Eqn (2.19). Hence, it is possible to connect results from DFT to exchange interactions of the Heisenberg form, in particular for classical spins. This is indeed what was done by Liechtenstein, Katsnelson, and Gubanov et al., (1984, 1987), who used a multiple scattering formalism for the electronic structure (see also Chapter 3, Section 3.4). In addition, in these works, pair exchange was shown to be of the bilinear Heisenberg form. Hence, both the Heisenberg form of the exchange interaction, and a practical method of how to evaluate the strength of the exchange between any pair of atoms, were established. Relativistic or non-collinear generalization to this formalism yield slightly modiﬁed results, but the basic idea of all these generalizations is the same. Consequently, ﬁrst-principles theory can be used to evaluate bilinear and biquadratic exchange parameters and the DM interaction, as well as exchange interactions at ﬁnite temperatures (Liechtenstein, Katsnelson, and Gubanov et al., 1984, 1987; Udvardi et al., 2003; Szilva et al., 2013).
An important development in recent years has been advances in methods to calculate effective exchange interactions for strongly correlated systems. Kvashnin et al. (2015) reported exchange interaction parameters for body-centred cubic Fe, hexagonal close-packed Gd, and antiferromagnetic NiO, calculating these values by using a numerical scheme that combines ﬁrst-principles full-potential electronic structure theory with dynamical mean ﬁeld theory (Grånäs et al., 2012). Formalisms to address the time evolution of exchange interactions in non-equilibrium correlated systems have been communicated (Secchi et al., 2013; Mentink and Eckstein, 2014; Mentink et al., 2015), with the latter two papers reporting ultrafast quenching and reversible control of the exchange interaction in Mott insulators. To account also for the interaction of orbital magnetic moments was one motivation for the study by Secchi et al. (2015).
In the remaining part of this section, we will formulate the mathematical expressions for all the various interactions in Eqn (4.42). The typically most important interaction is Heisenberg exchange, formulated in Eqn (2.19). Compared to other contributions to the internal energy, it is dominant. One of the consequences of this is that it is mainly the Heisenberg exchange that governs the temperature dependence of the magnetic system. One kind of interaction that has previously not been considered important but has recently been shown to be relevant in systems with reduced symmetry is the DM interaction (Dzyaloshinskii, 1957; Moriya, 1960), which can be written as

1 HDM = – 2 Dij · (mi × mj),
i,j

(4.43)

The magnetic Hamiltonian 71

where the coupling constant is referred to as the DM vector, Dij.1 An important class of systems in which the DM interaction plays a role comprises thin metallic ﬁlms, in which the surface breaks the inversion symmetry, as will be treated in detail in Chapter 9. For some magnetic materials, higher-order exchange couplings could also be of relevance. An example is the biquadratic exchange coupling

1

Hbq

=

– 2

Jibjq(mi · mj )2,

i,j

(4.44)

which is important, for example, for some type II multiferroics such RMnO3 compounds (Hayden et al., 2010; Mochizuki et al., 2010b) and CuO (Yablonskii, 1990; Pasrija and Kumar, 2013; Hellsvik et al., 2014), as well as for ﬁnite temperature exchange (Szilva et al., 2013). There also have been suggestions that a biquadratic form of the DM interaction, as well as multi-site interactions such as four-spin interactions (Heinze et al., 2011; Fedorova et al., 2015), sometimes needs to be added to the Hamiltonian, in order to obtain a good description of the energetics and dynamics of the system at hand. In addition to these pair interactions, a proper description of a spin system may often also have to contain single-site contributions to the energy and effective magnetic ﬁeld. The prime example of this is MAE. For cubic bulk systems, the MAE is typically quenched, as an example, the MAE for body-centred cubic Fe is of the order of 1.4 μeV per atom. On the other hand, systems with lower symmetry and/or the presence of heavier elements, where the spin–orbit coupling is stronger, can have much larger MAE. The technologically important FePt alloy in the L10 structure has an MAE on the order of 1 meV per formula unit. Many magnetically hard materials, that is, those with large MAE, exhibit a uniaxial magnetic anisotropy.
The expressions for uniaxial anisotropy (Eqn (3.1)) and cubic anisotropy, (Eqn (3.2)), which in Chapter 3, Section 3.3, were stated in angles and directional cosines, can equivalently be formulated in terms of local magnetic moment unit vectors eˆi = mi/|mi|. For uniaxial anisotropy the leading orders read

Huni = –

Ki1(eˆi · eki )2 + Ki2(eˆi · eki )4 + · · · ,

i

(4.45)

where Kin is the uniaxial anisotropy constant of order n, and eki is the axis of the uniaxial anisotropy. The ﬁrst-order anisotropy term is typically dominant and is thus often the
only anisotropy term that needs to be included in the Hamiltonian. As was the case with
the magnetic exchange terms, there exist different conventions regarding the sign of the
anisotropy terms. A minus sign in front of the summation, as is used in Eqn (4.45), means that a positive value of K1 leads to a favoured magnetization axis, an easy axis, while a negative K1 would infer a cost in energy to align the magnetic moments along
the anisotropy axis, in which case one gets a hard axis, or easy plane, anisotropy. The

1 The needed symmetry breaking is the lack of inversion symmetry for the magnetic ions in the material.

72 The Atomistic Spin Dynamics Equation of Motion

MAE is typically very weak in cubic systems but can be modelled if needed and then expressed as

Hcub = –

Ki1(e2i,xe2i,y + e2i,xe2i,z + e2i,ye2i,z) + Ki2(ei2,xe2i,ye2i,z) + · · · ,

i

(4.46)

where, once again, care needs to be taken regarding the sign of the contributing terms. The MAE, which is a relativistic, quantum mechanical property coming from spin–
orbit coupling, is hence seen to provide coupling between the magnetic moments and the underlying lattice. A similar coupling comes from the classical magnetostatic interactions between the atomic (magnetic) dipole moments. As is the case with classical dipoles, magnetic moments interact in such a way as to minimize the magnetic stray ﬁeld from the system. The result is a set of weak but long-range dipole–dipole interactions which give rise to a demagnetizing ﬁeld in the system at hand. In micromagnetics, that is, studies of magnetization dynamics on length scales larger than what is typically accessible by atomistic magnetization dynamics, the demagnetizing ﬁeld is of critical importance. Two important effects that stem from the demagnetizing ﬁeld are worth mentioning here. First, since it strives to decrease the stray ﬁeld from a sample, the ﬁeld favours magnetization patterns that forms closed loops of the magnetic ﬁeld inside the system. This is the driving force behind the formation of magnetic domains in bulk systems. Another effect is that, for systems without spherical symmetry, the demagnetizing ﬁeld causes an additional magnetic anisotropy that depends on the shape of the system. This is called shape anisotropy and, as a rule of thumb, shape anisotropy prefers that magnetic moments lie along directions of the material that are long. As a well-known example, shape anisotropy prefers in-plane magnetization patterns in thin samples.
For the typical length scale considered with ASD, dipolar interactions are much weaker than other interactions and can thus often be neglected or at most be considered in the form of an additional shape-anisotropy contribution that can be added to the onsite magnetocrystalline anisotropy discussed above. Nevertheless, there might be instances where dipolar effects play a more important role in the atomistic magnetization dynamics and then there are several possible ways of treating them. For ﬁnite sizes, the demagnetizing ﬁeld can be calculated by ‘brute force’, that is, by simply considering the full dipole–dipole interaction matrix

Hdd

=

– μ0 4π

i ,j ,j =i

1 ri3j

3

mi · rˆij

mj · rˆij – mi · mj ,

(4.47)

where μ0 is the magnetic constant.

5
Spin Dynamics at Finite Temperature
In Chapter 4, we presented a microscopic derivation of the Landau–Lifshitz equation and its connection to ab initio results, such as that provided by density functional theory. All the analysis of Chapter 4 was done by considering the temperature T = 0 K. Since most magnetic phenomena of interest are observed at ﬁnite temperature, it is important to generalize the analysis presented above to incorporate the effects of ﬁnite temperature. In the discussion of Eqn (4.1), it was mentioned brieﬂy that ﬁnite temperature effects are incorporated in the stochastic ﬁeld Bﬂi . Details of the coupling between temperature and the stochastic ﬁeld comprise the main topic of this chapter.
5.1 Langevin dynamics
The study of equilibrium properties of quantum mechanical and classical spin models is a well-established ﬁeld of condensed matter and statistical physics. The physics that take place in the vicinity of phase transitions has for long time been of particular interest (Fisher, 1967). A large body of theoretical work has been presented, with important concepts such as ﬁnite size scaling, universality classes, and the renormalization group (Fisher, 1974; Cardy, 1996). For less technical introductions to these topics, the papers by Stanley (1999) and Delamotte (2004) are suggested reading. For atomic spin dynamics, the theory of dynamic critical phenomena (Hohenberg and Halperin, 1977) is relevant, as it encompasses phenomena such as critical slowing down (K.Chen and Landau, 1994) and the relaxation processes of frustrated systems (A. Young, 1998). The thermal equilibrium properties of a spin system modelled by a classical Hamiltonian follow Boltzmann statistics (Plischke and Bergersen, 1994). The Boltzmann statistics is an important starting point also for simulations of atomistic spin dynamics at ﬁnite temperatures. Following up on their study of static behaviour, K. Chen and D. P. Landau (1994) performed spin dynamics simulations on the Heisenberg model.
At ﬁnite temperature, atomic magnetic moments experience not only the deterministic precession torque and the damping torque connected to the effective ﬁeld Bi but also stochastic torques due to thermal ﬂuctuations. Stochastic torques can be included as ﬂuctuating ﬁelds Bﬂi in the full stochastic Landau–Lifshitz equation. As will be described in this chapter, the power of ﬂuctuating torques needs to be connected to the
Atomistic Spin Dynamics. Olle Eriksson, Anders Bergman, Lars Bergqvist, Johan Hellsvik. First Edition. © Olle Eriksson, Anders Bergman, Lars Bergqvist, Johan Hellsvik 2017. First published in 2017 by Oxford University Press.

74 Spin Dynamics at Finite Temperature

mechanisms for damping. That ﬂuctuations and relaxations are intimately connected is a very important result of equilibrium statistical physics and is expressed in the ﬂuctuation–dissipation theorem (Callen, 1951; Kubo, 1966; Plischke and Bergersen, 1994).
The ﬁrst investigations on how to include ﬂuctuations in magnetization dynamics were undertaken by William Fullet Brown, J. (1963), who let a stochastic torque contribute to both the precession and the damping motion. To ﬁnd out a relation between the strength of the ﬂuctuating ﬁeld and the rate of damping, he formulated the Fokker–Planck equation (Risken, 1989) for the stochastic version of the Landau–Lifshitz equation. The result is an equation that couples the amplitude of the stochastic ﬁeld Bﬂi to the damping parameter α and the temperature T. The form of this relation is similar to that between the ﬂuctuating forces and the diffusion constant in Einstein’s theory of Brownian motion (Einstein, 1906). Choosing to include the ﬂuctuating ﬁelds only in the precession term, Kubo and Hashitsu (1970) worked out a formalism similar to, but not identical to, Brown’s expressions. Brown and Kubo were modelling singledomain magnetic particles and single spins, respectively. It was proposed by Antropov and Harmon (1996) that the same formalism would be applicable to atomic magnetic moments.
The stochastic Landau–Lifshitz equation, which includes stochastic ﬁelds in both the precession term and the damping term, in Chapter 4, as was given in Eqn (4.1). This equation can be classiﬁed as a Langevin equation, with multiplicative noise introduced as Langevin forces (van Kampen, 2007). The term ‘multiplicative’ implies that the Langevin forces enter the equation with coefﬁcients depending on the system variables. This indeed is the case for the stochastic Landau–Lifshitz equation, as Bﬂi (t) is a noise term that occurs in a cross product or double cross product with the system variable mi. Stochastic differential equations and related aspects of stochastic processes are covered in a textbook by van Kampen (2007). As will be discussed in Section 5.4.2, for every Langevin equation, there is an equivalent Fokker–Planck equation. The Fokker–Planck equation and techniques for how to solve it are discussed in detail in the monograph by Risken (1989).
The ﬂuctuating ﬁelds are caused by a large number of weakly coupled microscopic events and follow, due to the central limit theorem, a Gaussian distribution. In principle, the noise can be correlated both in orbital space and in spin space. In the following, it is assumed that the components Biﬂ,μ, with μ = {x, y, z}, are uncorrelated and that the ﬂuctuating ﬁelds for different atomic magnetic moments mi are uncorrelated. Assuming furthermore that the average of the ﬂuctuating ﬁeld is 0, the ﬁrst two moments of the ﬂuctuating ﬁeld are given by the expressions

Biﬂ,μ(t) = 0, Biﬂ,μ(t)Bjﬂ,ν(s) = 2Dδμνδijf (t – s),

(5.1)

respectively. Note that the correlations between spins are described by the autocorrel-
ation function f (t, s), which, for the present discussion, is expressed in the form f (t – s). The ﬁrst moment, Biﬂ,μ(t) = 0, is the average value of the stochastic process and the

Langevin dynamics 75

second moment, Biﬂ,μ(t)Bjﬂ,ν(s) , is its variance, whose magnitude is described by D. Eqn (5.1) hence describes correlations that are local in space and time. A short, but
ﬁnite, correlation in time can be modelled, for example, by exponentially correlated
coloured noise (Milshtein and Tret’yakov, 1994):

Biﬂ,μ(t) = 0,

Biﬂ,μ(t)Bjﬂ,ν(s)

= b2 e(–a|t–s|). 2a

(5.2)

Fluctuations that have ﬁnite correlation time are characterized by a noise power that depends on frequency and are for this reason referred to as ‘coloured’. This can be inferred through the Wiener–Khintchine theorem (Risken, 1989), which states that the power spectrum of a stationary ﬂuctuating process can be calculated as the Fourier transform of the autocorrelation function

∞
S(ω) = f (t )eiωt dt .
–∞

(5.3)

If the stochastic process is very fast in comparison to the deterministic part of the motion, the autocorrelation function can be approximated with the product f (t ) = qδ(t ), where q is amplitude, and δ(t ) is the Dirac δ-function. That noise with zero correlation time has a ﬂat power spectrum, completely lacking dependence on frequency, is easily shown, since

∞
S(ω) = qδ(t )eiωt dt = 2q.
–∞

(5.4)

This kind of noise is called white noise, as it has the same power for all frequencies. For the reason that coloured noise is more difﬁcult to handle mathematically than white noise, the assumption of noise with zero correlation time is often used in description of ﬂuctuations in physical systems. The Langevin forces that play a role in atomistic spin dynamics are caused by microscopic events that, according to the discussion in Chapter 2, Section 2.6, can have time scales of the order of 0.1 fs.
In Fig. 5.1, we show schematically how the spin system interacts both with the reservoir of electrons as well as the lattice, and we give estimates of time scales for how information between the different reservoirs is exchanged. In a non-equilibrium situation, the temperature of the three different reservoirs may not be the same. How the temperature of each reservoir develops as the system equilibrates is normally described by the so-called three-temperature model (see e.g Beaurepaire et al., 1996), which is discussed in more detail in Chapter 11, where we describe ultrafast magnetization phenomena. We note here that the division of a material into three reservoirs is, in principle, complex. This is especially so concerning the division into a reservoir of atomic spins and an electron reservoir, since it is the electrons themselves that form the atomic spins. This has to be remembered when dealing with ultrafast phenomena in magnetization dynamics (see Chapter 11).

76 Spin Dynamics at Finite Temperature τe

Electron

τes

τep

Figure 5.1 Schematic ﬂow of energy be-

τsp

tween spin reservoirs, lattice reservoirs, and

electron reservoirs. Time scales are τep ≈ 1

Spin

ps, τsp ≈ 100 ps, and τes ≈ 0.1 fs. Figure kindly provided by Dr. Danny Thonig.

τs

Lattice
τp

5.2 Stochastic differential equations

Using the Einstein convention, with summation over repeated indices implied without writing the summation sign, the general form of a multidimensional Langevin equation may be written as

∂ Xi ∂t

= hi({Xi}, t) + gij({Xi}, t)

j (t).

(5.5)

This is a multidimensional stochastic differential equation of the Ito form with indices i, j = 1, 2, . . . , n, where n is the dimension of the equation. The large symbol Xi denotes the multidimensional stochastic variable, and t is the time variable. The ﬁrst term on the right-hand side, hi({Xi}, t), accounts for the deterministic drift; the second term represents stochastic diffusion.
To solve a stochastic differential equation, the techniques for solving ordinary differential equations must be extended with techniques for stochastic processes. The reason is that the integral forms of stochastic differential equations are not directly integrable in the standard Riemann or Lebesgue sense. Stating the Ito stochastic differential equation in integral equation form,

Xi(t + τ)

t+τ

t+τ

= Xi(t) +

hi({X (t )}, t ) dt +

gij({X (t )}, t ) j(t ) dt ,

t

t

(5.6)

we observe that the last term on the right-hand side contains the Langevin force j(t), which is not a continuous function but a stochastic variable. To proceed, the integral

Stochastic differential equations 77

which includes the stochastic variable j(t ) is replaced with an integral containing the

increment dWj(t ) =

t 0

j(t ) dt . This transforms the second integral into a Riemann–

Stieltjes integral, so that

Xi(t + τ)

t+τ

t+τ

= Xi(t) +

hi({X (t )}, t ) dt +

gij({X (t )}, t ) dWj(t ).

t

t

(5.7)

The distribution of the increment dWj(t ) has the same form as the distribution of the Langevin force does. In the case of Gaussian white noise in Eqn (5.1), the moments of dWj(t ) are given by

dWi,μ = 0, dWi,μdWj,ν = 2Dτδμνδij.

(5.8)

The integral form of the stochastic differential equation is still not a uniquely deﬁned expression, as the stochastic calculus requires a prescription on how the last term on the right-hand side of Eqn (5.7) should be evaluated. In informal wording, it must be speciﬁed for which times t , and with which weights, the term gij({X (t )}, t ) should be multiplied with the increment dWj(t ). Stochastic integrals can be calculated as the mean square limit of a sum over n terms with n → ∞. In the notation of Kloeden and Platen (1992), with w denoting speciﬁc values of the stochastic variable W , the expression for the integral is

τ

I (λ) = (λ) f (t, w) dWt(w)

0

n

= lim
n→∞

(1 – λ)f tj(n), w + λf tj(+n1) , w

j=1

(5.9) Wtj(+n)1 (w) – Wtj(n) (w) ,

with evaluation points tj(n) for partitions 0 = t1(n) < t2(n) < · · · < tn(n+)1 < τ, for which

δ(n) = max
1≤j≤n

tj(+n1) – tj(n)

→0

when

n → ∞.

(5.10)

The parameter λ determines the weights of f tj(n), w and f tj(+n)1, w . The two common choices for the stochastic integral are the Ito and Stratonovich integrals. The Ito integral is deﬁned by the choice λ = 0, and the Stratonovich integral by the choice λ = 1/2. For Langevin equations of the form of Eqn (5.5), it is often, but not always, the Stratonovich calculus that gives the solution that is related to a physical process (Kloeden and Platen, 1992; van Kampen, 2007). Both deﬁnitions are reminiscent of the standard Riemann integral in so far that they are the n → ∞ limit of a sum of n terms. In the Ito integral, only the value f tj(n), w of the integrand is included. In the Stratonovich integral, the value
f tj(+n1) , w is also used, with the values at tj(n) and tj(+n)1 contributing with equal weight.

78 Spin Dynamics at Finite Temperature

In terms of a physical process, the Ito deﬁnition describes the situation where the stochastic contribution during the time interval tj(+n1) , tj(n) does not affect the deterministic contribution during the same time interval.
For many physical processes it is more appropriate to use the Stratonovich calculus. Here, the stochastic contribution for the time interval tj(n), tj(+n)1 does affect the deterministic contribution for the same time interval. At an intermediate time ˜t, with tj(n) < ˜t < tj(+n1) , the system variable x˜t can have a different value in the presence of the stochastic force than it would have had in the absence of the stochastic force. The deterministic evolution of the system variable from time ˜t and onwards depends on the value x˜t and it is clear that the presence of a stochastic force can affect the deterministic evolution. This contribution to the otherwise deterministic drift term is called noise-induced drift, or alternatively, spurious noise. The calculation of the noise-induced drift is not trivial but is well described in textbooks on stochastic calculus (Risken, 1989; Kloeden and Platen, 1992).The expression for the drift coefﬁcient with noise-induced drift is needed for some explicit numerical schemes for integration of the stochastic Landau– Lifshitz equation and is also needed together with the diffusion constant in order to formulate the Fokker–Planck equation for the stochastic Landau–Lifshitz equation. The expressions for the drift coefﬁcient with noise-induced drift included, Di({xi}, t), and the diffusion coefﬁcient Dij({xi}, t) of the multidimensional Langevin equation are written as

Di ({xi },

t)

=

hi

({xi

},

t)

+

Dgkj ({xi },

t)

∂gij ({xi}, ∂ xk

t)

,

(5.11)

Dij ({xi}, t) = Dgik({xi}, t)gjk({xi}, t),

(5.12)

respectively, where D is the noise amplitude of the stochastic process speciﬁed by Eqn (5.8). It turns out that the Stratonovich integral, by construction, takes account for the noise-induced drift. This implies that the integrands can be used as they are with no explicit addition of a noise-induced part to the drift coefﬁcient. It can be shown (García-Palacios and Lázaro, 1998) that, for the stochastic Landau–Lifshitz equation, with Gaussian white noise, the Ito calculus gives a solution that fails to reproduce the Boltzmann distribution for the energies of the magnetic moments in the effective ﬁeld. Instead, the Stratonovich deﬁnition of the stochastic integral should be used.

5.3 Finite difference approximations to stochastic differential equations and the choice of stochastic calculus
The schemes that are used to solve ordinary differential equations can be extended to be applicable to the case of stochastic differential equations. It is important to ensure that

Fluctuation–dissipation relations for the stochastic Landau–Lifshitz equation 79

the stochastic counterpart to an ordinary differential equation integrator gives a solution that converges to the kind of stochastic calculus that has been chosen to apply to the stochastic Landau–Lifshitz that is investigated. We will brieﬂy discuss this issue here, and save a detailed discussion on numerical techniques to integrate the Landau–Lifshitz or stochastic Landau–Lifshitz equations for Chapter 7, Section 7.4. As an example, the Euler integrator will be discussed. This is the simplest form of an explicit scheme where time is discretized as t0 < t1 < t2 < · · · < tn, and the solutions are obtained as the sequences X0 < X1 < X2 < · · · < Xn. The stochastic extension of the Euler scheme for an ordinary differential equation reads

Xi(t + τ) = Xi(t) + hi({Xi}, t)τ + gik({Xi}, t)dWk,

(5.13)

where τ is the time step, and the moments of the stochastic increments are given by Eqn (5.8). To obtain the value Xi(t + τ), the Euler scheme uses only the value of Xi(t) at a time ti. By comparing this with the deﬁnition of the Stratonovich and the Ito integrals, it seems that the Euler scheme corresponds to the solution given by the Ito integral, as the deﬁnition of the Ito integral uses the value of the integrand only at tj(n) . It can be proved (McShane, 1974; Rümelin, 1982) that the Euler solution converges to the Ito integral in the quadratic mean. The Euler scheme can still be used to obtain the numerical solution in the Stratonovich sense if the integrands hi({Xi}, t) and gik({Xi}, t) are substituted with the Stratonovich calculus drift (Eqn (5.11)) and diffusion (Eqn (5.12)) coefﬁcients. The Euler scheme that converges in the quadratic mean to the Stratonovich solution is thus written as

Xi(t + τ) = Xi(t) + Di({Xi}, t)τ + Dik({Xi}, t)dWk.

(5.14)

5.4 Fluctuation–dissipation relations for the stochastic Landau–Lifshitz equation
A ﬂuctuation–dissipation relation (FDR) that speciﬁes how noise power and the dissipation coefﬁcient are related can be derived in different ways, using classical or quantum statistics. In this section, we present how an FDR for the stochastic Landau–Lifshitz equation can be derived, either by means of the Fokker–Planck equation or from a general formulation of the ﬂuctuation–dissipation theorem. We also outline how quantum effects can be incorporated.
We will, in Sections 5.4.1–5.4.3, make use of index notation for the vector algebra in which the subscripts i, j, k, l, m, n are indices for the Cartesian spin space coordinates x, y, z. Note that these includes the indices i, j, which elsewhere in this book are used as site indices. In index notation, the cross product is expressed as (A × B)i = ijkAjBk, and the BAC-CAB formula for the double cross product, A × (B × C) = B(A · C) – C(A · B), is written ijk klm = δkmδln – δknδlm, or explicitly for vectors A, B, C as ijk klmAjBkCm = BiAl Cl – CiAl Bl .

80 Spin Dynamics at Finite Temperature

5.4.1 The stochastic Landau–Lifshitz equation in the form of the Langevin equation

To write the stochastic Landau–Lifshitz equation in the form of a general Langevin equation, the terms containing Bi and Bﬂi are separated:

dm = –γm × B – γ α m × (m × B)

dt

m

–γm × Bﬂ – γ α m × (m × Bﬂ).

m

(5.15)

After some straightforward algebra, the terms hi({mi}, t) and gik({mi}, t), deﬁned in Eqn (5.5), can be identiﬁed as follows:

hi

=

–γ

ijkmj Bk

–

γ

α mi

(mi

mkBk

–

m2 Bi ),

gik

=

–γ

ijk mj

–

γ

α mi

(mi

mk

– δikmimk).

(5.16) (5.17)

5.4.2 The Fokker–Planck equation
For every Langevin equation there is a corresponding Fokker–Planck equation. The Fokker–Planck equation governs the time evolution of the probability distribution of the states (Risken, 1989). The Fokker–Planck equation for the probability density P({xi}, t) is expressed in terms of the drift coefﬁcient and the diffusion coefﬁcient:

∂P({xi}, t) = ∂t

∂

∂

– ∂xi Di({xi}, t) + ∂xixj Dij({xi}, t) P({xi}, t).

(5.18)

The drift coefﬁcient and the diffusion coefﬁcient are here the ones given by Eqns (5.11) and (5.12). Following García-Palacios and Lázaro (1998), the terms of the Fokker– Planck equation are regrouped to yield a form of the equation that will be suitable for the stochastic Landau–Lifshitz equation. First, the drift and diffusion coefﬁcients are substituted in Eqn (5.18) to give

∂P ∂ =–
∂t ∂xi

hi

+

Dgjk

∂ gik ∂ xj

∂2 P+
∂ xi ∂ xj

Dgikgjk P .

(5.19)

By taking the derivatives in the second term on the right-hand side of the equation, and by permuting dummy indices j and k, we obtain the expression

∂P ∂ =–
∂t ∂xi

hi – Dgik

∂ gjk ∂ xj

∂ – Dgikgjk ∂xj P ,

(5.20)

Fluctuation–dissipation relations for the stochastic Landau–Lifshitz equation 81

where the last equality sign deﬁnes the probability current J, so that the Fokker–Planck equation can be written in the compact form ∂P/∂t = –∂Ji/∂xi which constitutes a continuity equation for the probability density.
The expressions for hi and gik can be substituted into three terms in the square brackets of the right-hand side of the Fokker–Planck equation in the form of Eqn (5.20). The ﬁrst term in square brackets in Eqn (5.20) simply gives the contribution hiP. To evaluate the second term, we ﬁrst calculate

∂gik = ∂ ∂mj ∂mj

–γ

ijk mj

–

γ

α m

(mi

mk

– m2δikm2)

=

–γ

ijk

–

γ

α m

δij

mk

+

γ

α m

δjk

mi

,

(5.21)

and, speciﬁcally by setting i to j and noting that δii = 3, we obtain

∂ gjk ∂ mj

=

–γ

α m

2mk.

(5.22)

Inserting this in the second term of Eqn (5.20), we ﬁnd after simpliﬁcation, that the term vanishes, that is,

gik

∂ gjk ∂ xj

P = 0.

(5.23)

For the third term of Eqn (5.20), we obtain

∂P gikgjk ∂ mj

=

–γ

ijk mj

α – γ m (mimk

– m2δikm2)

= –γ2(1 + α2) m × m × ∂P ∂m i

–γ

ijkmj

–

γ

α m (mimk

–

m2δikm2)

∂P ∂ mj

(5.24)

Eventually, the Fokker–Planck equation for the stochastic Landau–Lifshitz equation, in the form of a continuity equation for the probability distribution, can be written as

∂P ∂t

=

∂ –
∂m

·

–γm × B – γ α m × (m × B) + Dγ2(1 + α2) m × m × ∂

m

m

∂m

P. (5.25)

In equilibrium, the time derivative of the probability distribution P0 should vanish, that

is,

∂ P0 ∂t

=

0, and the probability distribution should be a Boltzmann distribution that

is, P0({mi}) = e–βH({mi}), where β = (kBT )–1, and H({mi}), is a magnetic Hamilton-

ian of the type expressed in Eqn (4.42). The spatial derivative in the last term of the

82 Spin Dynamics at Finite Temperature

Fokker–Planck equation acts on the probability distribution. By recalling Eqn (4.41), the derivative can be swiftly calculated:

∂P0 = ∂ ∂m

e–βH(m) ∂m

=

–β ∂H(m) e–βH(m) ∂m

=

βBP0.

(5.26)

The last equation is inserted into the Fokker–Planck equation, resulting in an equation from which it is possible to extract the relations between D, α, and T , as is required for thermodynamic consistency:

∂ P0
∂t ∂
= –∂m

γ –βm

×

∂ P0 ∂m

–

γ β

α m
m

×

m

×

∂ P0 ∂m

+ Dγ2(1 + α2)m ×

(5.27)

m

×

∂ P0 ∂m

.

The ﬁrst term is divergence-free, as can be established by the straightforward calculation

∂ ∂m

·

γ m × ∂P0 β ∂m

=

γ β

∂

mi

(

ijkmj ∂ mkP0)

=

0,

(5.28)

and we are left with

∂ P0

∂t

∂ =–
∂m

Dγ2(1

+

α2)

–

γ β

α m

m×

m

×

∂ P0 ∂m

,

(5.29)

so that a stationary solution is found when Dγ2(1 + α2) – γ α = 0. βm

(5.30)

Solving for D and substituting for β gives the relation

D = α kBT . 1 + α2 γm

(5.31)

This equation is the Einstein-type FDR for the stochastic Landau–Lifshitz equation in the Gilbert form. The noise power, D, turns out to be frequency independent, precisely as the Wiener–Khintchine theorem had already revealed. As m is in the denominator, it follows that large magnetic moments are less susceptible to ﬂuctuations than small magnetic moments are. This derivation has been the traditional one, involving the Fokker–Planck equation. Had the corresponding derivation instead been pursued for the stochastic Landau–Lifshitz equation, the expression

Conservation properties of the Landau–Lifshitz equation 83

D = α kBT γm

(5.32)

would have been obtained. We note that the difference in the noise amplitudes for the two stochastic differential equation s is due to the renormalized gyromagnetic ratio used in the stochastic Landau–Lifshitz on the Gilbert form.

5.4.3 Fluctuation–dissipation relations with quantum corrections

The FDRs is Eqns (5.31) and (5.32) were derived using classical statistics and are asymptotically valid for higher temperatures. For lower temperatures, the quantized energy levels of quantum statistics are necessary. Following Woo et al. (2015), the ﬂuctuation–dissipation ratio η = η(T ) is deﬁned as

η

=

Dγm .

α

(5.33)

For the case of classical statistics, this ratio is nothing but η(T ) = kBT. Using quantum statistics, Woo et al. (2015) derived the following quantum ﬂuctuation–dissipation theorem (QFDR):

1 η(T) =

h¯ ω

N k exp(h¯ωk/kBT – 1)

=

∞ 0

h¯ ω exp(h¯ ωk /kB T

–

1) gm(ω, T )

dω,

(5.34)

where gm(ω, T ) is the magnon density of states at temperature T. In the limit of high temperatures h¯ω kBT, the classical limit of Eqn (5.31) is recovered. For low temperatures, the Bloch T 3/2 law is obtained.

5.5 Conservation properties of the Landau–Lifshitz equation
The Landau–Lifshitz equations for interacting spin systems are coupled non-linear differential equations. It is only for a few particular cases that exact closed analytical solutions exist, such as for a two-spin system, and for coherent rotation of coupled spins in an external magnetic ﬁeld. In general, it is necessary to resort to analytical approximation techniques or to schemes for numerical simulation of the equations of motion. Analytical solutions are rare, not only for the trajectories in time of the individual magnetic moments, but also for the trajectories in time of the average magnetization and higher moments (García-Palacios and Lázaro, 1998). An interesting development is the analytical (but not closed) solution for moments, magnetization recently derived for the

84 Spin Dynamics at Finite Temperature
stochastic Landau–Lifshitz equation (Ma and Dudarev, 2011). With a focus on slightly longer length scales than is typically the case for ASD simulations, an advanced treatise on non-linear magnetization dynamics has been provided by Bertotti et al. (2009).
For small amplitude motion where the spins oscillate around a ground-state spin conﬁguration, it is possible to linearize the Landau–Lifshitz equation to yield a system of linear equations for which analytical or numerical solutions for the eigenfrequencies and eigenmodes can be straightforwardly obtained. This approach has successfully been developed in classical theories for magnetic resonance (Kittel, 1948; Keffer and Kittel, 1952; Lax and Button, 1962; Gurevihvc and Melkov, 1996), as well as quantum mechanical theories for spin waves (Holstein and Primakoff, 1940; van Kranendonk and Van Vleck, 1958; Achiezer et al., 1968; Kittel and Fong, 1987) and will be discussed further in Chapter 8. Temperature can be introduced into this framework in the form of temperature-dependent sublattice magnetization and coupling constants.
Even though analytical solutions of the Landau–Lifshitz equation exist only for rare cases, there are a number of conservation relations that one can derive analytically, that apply also for general situations that involve numerical simulations. To start with, we note that solutions to the stochastic Landau–Lifshitz equation can be grouped into three different classes with regard to the damping parameter and the temperature.
1. α = 0, T = 0. The equation of motion for the spin systems is then the Landau– Lifshitz equation, with conservative dynamics. The internal energy U of the magnetic system is preserved, also in the presence of an external ﬁeld. No direct channel for transfer between Zeeman energy and exchange energy is allowed. A direct channel between anisotropy energy and exchange energy is possible.
2. α > 0, T = 0. The equation of motion for the spin systems is then the Landau–Lifshitz equation, with Landau–Lifshitz dissipative dynamics. Energy is transferred out from the magnetic system. The dynamics have a Lyapunov structure, which means that, in the case that the external magnetic ﬁeld does not depend on time, the free energy is monotonously decreasing (D’Aquino et al., 2005).
3. α > 0, T ≥ 0. The equation of motion for the spin systems is then the stochastic Landau–Lifshitz equation, with dissipative dynamics in the presence of a heat bath. This is the standard equation that is solved in atomistic spin dynamics simulations. Averaging over heat baths is essential, as the ﬁnite size of the simulation cells makes the evolution of the spin system sensitive to random-walk-like drift of the total angular momentum.
Atomistic spin dynamics simulations are commonly performed for the third class in the list above, involving damped dynamics at ﬁnite temperature, since this is the situation that most closely resembles an experimental situation. Many of the exact relations apply only to the conservative dynamics (Class 1). An integrator for this class should ideally preserve all or nearly all of these conservation laws identically. For small damping, where α 1 (Class 2 or 3), the dynamics can be regarded as a perturbation to α = 0 dynamics (Class 1). Therefore, a solver that performs well for the ﬁrst class is likely to be a good choice also for the second or third class.

Conservation properties of the Landau–Lifshitz equation 85

As expressed in Eqn (4.32), the lengths of individual spins are constants of motion of the Landau–Lifshitz equation. This property carries over to the stochastic Landau– Lifshitz equation (Class 3), for which preservation of spin length is the only conserved quantity. In α = 0 (Class 1) dynamics, conservation laws can exist also for the total angular momentum. If the magnetic Hamiltonian only includes isotropic exchange interactions, the total angular momentum is a conserved property, as no external torque acts on the system. In precession in an external magnetic ﬁeld, the total angular momentum associated with the magnetic moments precesses. This is the essence of gyroscopic precession: angular momentum precesses with the tangent vector for the motion of the tip of the angular momentum vector parallel to the applied torque. The total angular momentum is here not a preserved quantity, however, the projection of the angular momentum in the direction of the applied ﬁeld is a constant of motion.
At zero temperature and α > 0 (Class 2), an important relation for the energy dissipation holds for the case of a time-independent external magnetic ﬁeld, namely, that the internal energy is a decreasing function of time (D’Aquino et al., 2005). This property can be derived by ﬁrst observing that the internal magnetic energy U in a volume V can be expressed as

dU =
dt V

∂U ∂m

·

∂m ∂t

+

∂U ∂B

·

∂B ∂t

dr

=
V

–B

·

∂m ∂t

+

m

·

∂B ∂t

dr.

From the Landau–Lifshitz equation, we have

(5.35)

∂m ∂t

=

–γm

×

α ∂m

B– m

∂t

,

(5.36)

which can be used to evaluate the terms in Eqn (5.35). From scalar multiplication of the

Landau–Lifshitz

equation

with

B

–

α m

∂m ∂t

,

and

properties

of

the

scalar

triple

product,

it

can

be

established

that

∂m ∂t

· (B –

α m

∂m ∂t

)

=

0.

This

identity

can

be

substituted

into

the

expression for internal energy to give

dU

∂m 2

∂B

= –α

+m·

dr.

dt

V

∂t

∂t

(5.37)

For the case that the applied magnetic ﬁeld is constant in time, the expression simpliﬁes to

dU dt

=–

α
V

∂m ∂t

2

<

0,

that is, the internal energy is a decreasing function.

(5.38)

86 Spin Dynamics at Finite Temperature

Hexch

Hani

Figure 5.2 The ﬂow of energy between different parts of

magnetic interactions for α = 0 dynamics. The ﬁve full

lines indicate energy channels which are allowed, and the

dashed line indicates the forbidden channel between Heisen-

berg exchange (exch) and Zeeman energy (zee); ani, stands for HZee

Hdd

anisotropy; dd, stands for dipole–dipole.

Even for the case of conservative dynamics, energy can however be transferred within the magnetic system, between the different contributions to the spin Hamiltonian. The time derivative of different parts of the magnetic energy can be calculated from the commutator of each contribution and the total magnetic Hamiltonian (Safonov and Neal Bertram, 2001). The commutator between Heisenberg exchange energy and the magnetocrystalline anisotropy is, in general, not 0. This implies that, for systems with only magnetic anisotropy and Heisenberg exchange, energy can be transferred from (to) the magnetocrystalline anisotropy energy to (from) the exchange energy in the case of conservative dynamics as well. This transfer of energy is accompanied by a transfer of angular momentum. The commutator of the Heisenberg part of the interatomic exchange energy and the Zeeman energy is always 0. Consequently, for systems where these two terms dominate the spin Hamiltonian, energy cannot be exchanged between these terms.
The ﬂow of energy within a conservative magnetic system can be visualized as a graph with four vertices (shown in Fig. 5.2), all of which are mutually connected by, in total, six edges. Out of the six energy channels, some channels are always closed (e.g. exchange energy ↔ Zeeman energy), whereas some of the others can be opened or closed depending on geometry, interactions, and the magnetic conﬁguration at an instant of time. If all the four energy types are connected, directly or over the other sorts of energy, the amount of energy of different types will evolve over time, reﬂecting the nature of how the magnetic moments precess.

5.6 Finite temperature exchange
So far, we have discussed ﬁnite temperature effects via a noise term (or the stochastic magnetic ﬁeld Bﬂi ) in Eqn (4.1). In many applications, it is sufﬁcient to only consider ﬁnite temperature effects on this level of approximation, while, for example, the size of the magnetic moment or the parameters of the spin Hamiltonian used to evaluate the local ﬁeld, Bi, in Eqn (4.1) are obtained from DFT calculations at T = 0 K. On this level of approximation, two parameters of Eqn (4.1) depend on temperature. One is the stochastic ﬁeld whose strength depends on temperature according to Eqns (5.1) and (5.31), while the other is Bi, which depends on temperature via the particular spin conﬁguration

Finite temperature exchange 87
at each time step of the simulations. There are, however, examples where this is a less accurate approximation and it is desirable to include ﬁnite temperature effects also in the evaluation of all parameters of the spin Hamiltonian that are used to calculate Bi in Eqn (4.1). This involves primarily the size of the magnetic moment and the exchange parameters. We outline shortly one method to do this, as proposed by Szilva et al. (2013). The idea is to couple iteratively the information obtained from ﬁnite temperature spin dynamics with electronic structure theory in the following way. First, from Eqn (2.23), one obtains exchange parameters that are used to perform a ﬁnite temperature spindynamics simulation using Eqn (4.1). At this temperature, the atomistic spins form a non-collinear conﬁguration, and once equilibration has been realized in the simulations, information about the degree of non-collinearity is brought back to the electronic structure part of the problem. Typically, this is done by a few parameters that characterize the non-collinear magnetic state, for example, the angles θ and φ in Eqn (4.16). With

40

= 0 (T = 0 K)

= 30 (T = ~300 K)

30

bcc Fe

Energy (meV)

20

10

0

0

0.1

0.2

0.3

0.4

0.5

q (Å–1)

Figure 5.3 Spin wave dispersion relation calculated at room temperature and zero temperature in body-centred cubic (bcc) Fe, as a function of wavevector q and plotted in a direction from to H. The open circles represent magnetization measurements taken at 4.2 K (data from Pauthenet, R., (1982), Experimental veriﬁcation of spin-wave theory in high ﬁelds, J. Appl. Phys., 53, 8187–92, and Pauthenet, R., (1982), Spin-waves in nickel, iron, and yttrium-iron garnet, J. Appl. Phys., 53, 2029–31), and the ﬁlled circles refer to room temperature neutron scattering measurement data (from Lynn, J. W., (1975), Temperature dependence of the magnetic excitations in iron. Phys. Rev. B, 11, 2624–37). Reprinted ﬁgure with permission from Szilva, A., Costa, M., Bergman, A., Szunyogh, L., Nordström, L., and Eriksson, O., Phys. Rev. Lett., 111, 127204, 2013. Copyright 2013 by the American Physical Society.

88 Spin Dynamics at Finite Temperature

these parameters (angles), the electronic structure problem is solved anew (where one needs to consider Eqn (1.31) for a non-collinear description of the Kohn–Sham equation). From the solution of this new electronic structure calculation, both the magnetic moment and the Heisenberg exchange parameters are recalculated and passed on to the stochastic spin dynamics equation, Eqn (4.1). The whole procedure can then be iterated until self-consistency.
We note that Szilva et al. (2013) argued that a bilinear form of the spin Hamiltonian is not sufﬁcient in the case of non-collinear magnetism and that a smaller biquadratic term needs to be added, such that the effective spin Hamiltonian becomes

HQ

=

1 –

2

i =j

1

Jij ninj – 2

i =j
Bij

ninj 2 .

ij

ij

(5.39)

Note that a revised bilinear parameter Jij is introduced here, which dominates the problem, and it is in general different from the exchange parameter of Eqn (2.23). The parameter Bij gives the strength of the biquadratic term and may also be calculated from ﬁrst-principles theory (Szilva et al., 2013). We illustrate in Fig. 5.3 the effects of ﬁnite temperature on the exchange parameters for body-centred cubic Fe, using magnon excitation energies taken from the work by Szilva et al. (2013). Note that the ﬁgure contains experimental data at low temperature (4.2 K) and room temperature, as well as theoretical data from T = 0 K and room temperature. For simplicity, the magnon spectra shown in Fig. 5.3 are calculated with a so-called adiabatic approach (Kübler, 2009; described in detail in Chapter 9), using temperature-dependent exchange parameters. Note that, with increasing temperature, the magnon dispersion softens, an effect which is both observed experimentally as well as found in the theory. One may also note that, on a quantitative level, the agreement between theory and experiment is rather good, which naturally gives credence to the method proposed by Szilva et al. (2013).

5.7 Some ﬁnal comments
In Sections 5.1, 5.2, and 5.4 we outlined details on how ﬁnite temperature effects can be incorporated as a ﬂuctuating ﬁeld in the stochastic Landau–Lifshitz equation (Eqn (4.1)), and how the size of the ﬂuctuating ﬁeld is connected to the temperature of the atomistic spins, as well as the damping parameter of the materials (Eqns (5.1) and (5.31)). We have also outlined that interatomic exchange parameters in general should depend on temperature, and we have suggested one way to calculate such temperature effects. Sections 5.1, 5.2, and 5.4 also contained discussions of how ﬁnite temperature effects necessarily lead to a stochastic differential equation. Practical details of the implementation of the ﬁnite temperature effects of Eqn (4.1), together with general practicalities of numerical solutions to this equation, will be given in Chapter 7. Before entering into that discussion we will outline in Chapter 6 how one can evaluate from ab initio theory the strength of the damping parameter of Eqn (4.1).

6
The Damping Term, from First Principles
In Chapters 1–5, we described the basic principles of density functional theory, gave examples of how accurate it is to describe static magnetic properties in general, and derived from this basis the master equation for atomistic spin dynamics; the stochastic Landau–Lifshitz (or stochastic Landau–Lifshitz–Gilbert) equation. However, one term was not described in these chapters, namely the damping parameter. This parameter is a crucial one in the stochastic Landau–Lifshitz (or stochastic Landau–Lifshitz–Gilbert) equation, since it allows for energy and angular momentum to dissipate from the simulation cell. The damping parameter can be evaluated from density functional theory and the Kohn–Sham equation, and it is possible to determine its value experimentally. This chapter covers in detail the theoretical aspects of how to calculate the damping parameter. Chapter 8 is focused, among other things, on the experimental detection of damping via ferromagnetic resonance.
6.1 Background
Any effect that dissipates energy and angular momentum from the magnetic system to the environment is denoted ‘damping’ in the context of magnetization dynamics. The most common damping mechanism is scattering due to phonons and magnons, at elevated temperature, with associated spin-ﬂip scattering, but scattering against lattice imperfections and the generation of eddy currents may also be important. Without any damping processes present, the total energy is preserved in the magnetic system. It is clear that damping has an important impact on the magnetization dynamics properties, and reliable determination from both experiments and ﬁrst-principles calculations is important. The main driving force for damping, that is, the transfer of angular momentum from the spin system, comes from spin–orbit coupling. Normally, ﬁrst-principles calculations of damping only deal with this dominant mechanism, but it is important to remember that there are other mechanisms. Conduction electrons from the environment can transfer angular momentum to the spin system and vice versa, and this is the basic mechanism behind spin-transfer torque, which can lead to damping or
Atomistic Spin Dynamics. Olle Eriksson, Anders Bergman, Lars Bergqvist, Johan Hellsvik. First Edition. © Olle Eriksson, Anders Bergman, Lars Bergqvist, Johan Hellsvik 2017. First published in 2017 by Oxford University Press.

