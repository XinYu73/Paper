Cite This: J. Phys. Chem. Lett. 2020, 11, 272−279

Letter pubs.acs.org/JPCL

Downloaded via JILIN UNIV on February 11, 2022 at 11:11:45 (UTC). See https://pubs.acs.org/sharingguidelines for options on how to legitimately share published articles.

Nonlocal Subsystem Density Functional Theory
Wenhui Mi†,‡ and Michele Pavanello*,†,‡
†Department of Chemistry, Rutgers University, Newark, New Jersey 07102, United States ‡Department of Physics, Rutgers University, Newark, New Jersey 07102, United States
*S Supporting Information
ABSTRACT: By invoking a divide-and-conquer strategy, subsystem DFT dramatically reduces the computational cost of large-scale, ab initio electronic structure simulations of molecules and materials. The central ingredient setting subsystem DFT apart from Kohn−Sham DFT is the nonadditive kinetic energy functional (NAKE). Currently employed NAKEs are at most semilocal (i.e., they only depend on the electron density and its gradient), and as a result of this approximation, so far large-scale simulations only included systems composed of weakly interacting subsystems. In this work, we advance the state-of-the-art by introducing fully nonlocal NAKEs in subsystem DFT simulations for the ﬁrst time. A benchmark analysis based on the S22-5 test set shows that nonlocal NAKEs considerably improve the computed interaction energies and electron densities compared to commonly employed GGA NAKEs, especially when increasing intersubsystem electron density overlap is considered. Most importantly, we resolve the long-standing problem of too attractive interaction energy curves typically resulting from the use of GGA NAKEs.

T he ab-initio model of realistically sized materials has become the ultimate goal for quantum chemistry and
material science. To achieve this aim, recent years have
witnessed the development of a variety of methods, such as density functional theory (DFT),1 as well as multilevel/ multiscale computational protocols such as QM/MM.2,3
Quantum embedding methods have recently gained fame,
branching into several directions. Among them, subsystem DFT (sDFT) is becoming popular.4−10 The idea behind sDFT
is one of dividing the system into a set of interacting
subsystems whose interaction is accounted for approximately in a way that leverages pure density functionals.11−14 The
simplicity of the algorithms involved and the propensity for
massive parallelization has driven a number of implementa-
tions of sDFT methods in various mainstream quantum simulations codes15−17 and been successfully applied to a vast
array of chemical problems, for instance, structure and dynamics of molecular liquids,18,19 solvent eﬀects on diﬀerent types of spectroscopy,20,21 magnetic properties,22−26 excited states,20,27−32 charge transfer states,33−35 and bulk impurity models.36
In sDFT, the total electron density, ρ(r), is expressed as a
sum of subsystem contributions. Namely,

NS

ρ(r) = ∑ ρI (r)

I

(1)

where Ns is the total number of subsystems considered. The electron density of each subsystem is obtained by variationally minimizing the total energy functional

NS
E[{ρI }] = ∑ E[ρI , veIxt]+
I

NS

NS

+ Ts[ρ] − ∑ Ts[ρI ] + Exc[ρ] − ∑ Exc[ρI ] +

´ÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖ≠ÖÖIÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÆ ´ÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖ≠ÖÖIÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÖÆ

Tsnad[{ρI }]

Exncad[{ρI }]

∫ ∫ +

1

Ns
∑

2 I≠J

ρI (r)ρJ (r′) drdr′

+

Ns
∑

|r − r′|

I≠J

ρI (r)veJxt(r)dr

(2)

where veJxt is the external potential associated with subsystem J and by {ρI} it is intended to indicate the collection of all subsystem densities. The subsystem energy functionals, E[ρI, veIxt], are functionals of both the subsystem external potentials
and the subsystem electron densities. The external potential is

subsystem-additive (i.e., vext(r) = ∑INS veIxt(r)). Carrying out sDFT simulations involves solving one Kohn−

Sham (KS) like equation for each subsystem whose KS

potential, vKS(r), is augmented by an embedding potential that accounts for the interactions with all other subsystems.

Namely,

ÄÇÅÅÅÅÅÅÅÅÅ

−∇2 2

+ υKIS(r) + υeImb(r)ÉÖÑÑÑÑÑÑÑÑÑϕiI(r)

=

ϵiI(r)ϕiI(r)

(3)

Received: November 6, 2019 Accepted: December 9, 2019 Published: December 10, 2019

© 2019 American Chemical Society

272

DOI: 10.1021/acs.jpclett.9b03281 J. Phys. Chem. Lett. 2020, 11, 272−279

The Journal of Physical Chemistry Letters

Letter

where ϕiI(r) and υeImb(r) are the KS wave functions and the embedding potential of subsystem I, respectively. The embedding potential can be written as follows:6,7

∫ υeImb(r)

=

Ns
∑
J≠I

ÄÇÅÅÅÅÅÅÅÅÅÅÅ

ρJ (r′) dr′ |r − r′|

+

∑
J

veJxt(r)ÉÖÑÑÑÑÑÑÑÑÑÑÑ

+ δTsnad[{ρI }] + δExncad[{ρI }]

δρI (r)

δρI (r)

(4)

In the above, Ts and Exc are kinetic energy density functionals (KEDF) and exchange-correlation (xc), respectively.
In KS-DFT, Ts[ρ] is evaluated exactly from the KS orbitals of the system. Conversely, in a sDFT scheme, approximate nonadditive kinetic energy functionals (NAKE, deﬁned in eq 2) are used. Employing NAKE constitutes the most important and crucial diﬀerence between KS-DFT and sDFT.37,38
NAKEs are typically derived from semilocal KEDFs37 and have been at most of Laplacian level.39 However, it is common knowledge that semilocal NAKEs cannot approach a regime in which the subsystem electron densities strongly overlap where they typically give wrong interaction energy curves.40,41 These limitations originate from the natural nonlocality of the underlying KEDF42 and in turn of the NAKEs. In this work, we tackle these issues by employing state-of-the-art nonlocal KEDFs to generate NAKEs.
There are interesting new developments regarding nondecomposable NAKE approximants43 which are reported to be able to describe covalent bonds in the molecules Na2, Li2. Even though we do not consider them here, we will evaluate their performance in a follow up publication.
Even though nonlocal KEDFs have a long history in OFDFT simulations,44−46 to the best of our knowledge they have not yet been employed as NAKEs. This is probably because in sDFT, the distribution of electron densities is usually more localized compared to the electron density of the supersystem.47−49 Thus, when developing nonlocal NAKEs, KEDFs must be able to correctly simulate both homogeneous and nonhomogeneous systems and be numerically stable.
The ability to approach inhomogeneous systems is the most challenging property to satisfy because the nonlocal KEDFs have been historically developed for extended metallic systems whose electron density is close to uniform. The typical ansatz chosen for nonlocal functionals is

Ts[ρ] = ´TÖÖÖTÖÖFÖÖÖ[ÖÖρÖÖÖ]ÖÖÖÖ+ÖÖ≠ÖÖÖTÖÖÖvÖÖWÖÖÖÖ[ÖÖρÖÖÖÖ]ÖÆ + TNL[ρ]

TTV [ρ]

(5)

where TvW[ρ]

TTF[ρ] is is the von

the Thomas−Fermi (TF) functional,50,51 Weizsä cker (vW) functional,52 and TNL[ρ] is

the nonlocal part. The corresponding KEDF potential can be

written as

∫ ∫ TNL[ρ] =

ρα(r)ω[ρ](r, r′)ρβ(r′)drdr′

(7)

where α and β are positive numbers. The kernel is related to

the second functional derivative of the KEDF with respect to the electron density53 and is typically approximated by a

function of only |r − r′|. The available nonlocal KEDFs,54−61 can be categorized in

functionals whose kernel only depends on the average electron

density (i.e., ρ0 which is well-deﬁned only for condensed-phase systems) and functionals whose kernel instead depends on the total electron density and not just its average.57 Clearly,

nonlocal KEDFs with a density-independent kernel cannot be

directly employed as NAKEs because the presence of the

restrictive parameter, ρ0, would make the KEDF unable to approach inhomogeneous systems. Unfortunately, some

KEDFs with density dependent kernels are either too expensive (i.e., HC56 which we expect to also behave well

when employed as NAKE) or numerically unstable for arbitrary inhomogeneous systems (i.e., WGC55); thus, we

will not employ them here.

We recently proposed a new series of nonlocal KEDFs featuring local density dependent kernels which we showed62

can predict accurately the electron density, energy, and forces

for clusters of metallic and group III and V atoms. These

functionals are based on and generalize existing functionals with density independent kernels (such as WT,57 MGPA, and MGPG functionals58). The generalization allows them to

approach inhomogeneous systems because they feature fully density dependent kernels.62
In our previous study of the LMGP family of KEDFs,62 we

also analyzed the corresponding potentials and compared them

against the exact KS-DFT for isolated pseudoatoms (i.e., atoms

described by a pseudopotential). We noted that LMGP

improves upon the GGA local and semilocal potential, and

particularly it delivers potentials which are less repulsive in the

high-density regions. This results in a more localized electron

density, closer to the result obtained with the exact KEDF

functional (i.e., KS-DFT). In this work, we leverage on this

improved behavior of the LMGP family of KEDF, which will

translate into higher quality NAKEs.

Let us summarize the employed kernels, starting with the

WT kernel57 expressed in reciprocal space (q is the reciprocal

space

variable

for

|r

−

r′|)

and

η(q)

=

q 2kF

with

kF

being

the

Fermi wavevector),

ωWT(q)

=

6 5

π2 (3π 2)1/3

GNL(η(q))

(8)

which then is modiﬁed to satisfy functional integration relations58 by the addition of one correction term. Namely,

∫ ωx,y(q)

=

ωWT(q)

−

π 2x (3π 2)1/3

1 dt t y dGNL(η(q, t))

0

dt

(9)

vTs(r) =

δTTV[ρ] δρ(r)

+

δTNL[ρ] δρ(r)

= vTV(r) + vNL(r)

(6)

where vTV(r) is the Thomas−Fermi−vW potential which we will later discuss. The nonlocal part is deﬁned by a double integration of the electron density evaluated at two diﬀerent points in space and an eﬀective interaction, the so-called kernel, ω:

where

GNL(η)

=

ikjjjjj

1 2

+

1 − η2 ln
4η

1+η 1−η

y{zzzzz−1 − 3η2 − 1

(10)

( ) and MGP is given by (x, y) = 6 , 6 , MGPA by 55

( ) ( ) (x, y) = 3 , 6 , and MGPG by (x, y) = 6 , 3 . The only

55

55

273

DOI: 10.1021/acs.jpclett.9b03281 J. Phys. Chem. Lett. 2020, 11, 272−279

The Journal of Physical Chemistry Letters

Letter

diﬀerence between MGP/A/G is the way a kernel is symmetrized. We refer the interested reader to the Supporting Information of ref 58.
In ref 62 we developed a technique to generalize WT, MGP/ A/G functionals to approach localized, ﬁnite systems by invoking spline techniques to obtain kernels no longer dependent only on the average electron density but instead they are dependent (locally) on the full electron density function. In this way, we generate the LWT, LMGP/A/G functionals from the kernels mentioned in eqs 8−9.
At implementation time, we noticed that the terms TTV = TTF + TvW and TNL each can lead to numerical instability for diﬀerent reasons. The issue for TTV[ρ] originates from its quadratic dependence on the density gradient. In the typical GGA formalism:

∫ TTV[ρ] = tTF(r)FTV(s(r))dr

(11)

Figure 1. Enhancement factors associated with the following
functionals: TSTV (smooth version of the TTV) with a = 0.01 in red solid line, a = 0.1 in orange dashed line, original TTV in blue dot−dash line, and revAPBEK in black dotted line.

where s is the dimensionless reduced density gradient,

s

=

|∇ ρ| 2ρkf

=

, 1 |∇ ρ|
2(3π 2)1/3 ρ3/4

the

enhancement

factor

FTV(S)

=

1

+

5 s2,
3

and

tTF(r)

=

3 (3π 2)2/3ρ5/3(r).
10

Numerical

inaccur-

acies arise at large s because in this limit, FTV(s) is unbound and the error in the density becomes uncontrollable.

Thus, we need to ﬁnd a proper way to cap FTV(s) for large s. To achieve this aim, we borrow a formalism similar to PBE exchange63 and reshape the enhancement factor of Thomas−

Fermi (TF) plus von Weizsäcker (vW) kinetic energy

functional in a stable formalism (named STV):

FSTV (s)

=

1.0

+

5 3 1.0

s2 +

as2

(12)

In this formalism, when a = 0, FSTV(s) is the same as the original FTV; by increasing a, FSTV smoothly approaches a constant number for large s, which should ameliorate the
numerical inaccuracies. Figure 1 compares STV functionals
(for both a = 0.1 and 0.01) with the TTV and revAPBEK enhancement factors.
In addition to the numerical problem for the TTV KEDF, the nonlocal KEDF potentials also need to be carefully
implemented in the low electron density regions. The nonlocal
kinetic potentials for all the nonlocal functionals considered in
this work share the form:

vNL(r) = ρ−1/6(r)F−1[∼ρ 5/6(q)ω(q)](r)

(13)

where ∼ρ 5/6(q) = F[ρ5/6(r)](q), ω(q) is the nonlocal kernel expressed in reciprocal space, F and F−1 represent the fast Fourier transform and inverse fast Fourier transform, respectively. In eq 13 it is made clear that we approximate the real-space kernel as a function of only |r − r′| resulting in a dependence on only the magnitude of the reciprocal space vector q = |q|. In the same equation there is a ρ−1/6(r) prefactor, which is numerically noisy in the low electron density regions. To eliminate this issue, a local density weighted mix of GGA and nonlocal kinetic potential scheme is proposed:

vTs[ρ](r) = (vNL[ρ](r) + vSTV[ρ](r))W[ρ](r)

+ vGGA[ρ](r)(1 − W[ρ](r))

(14)

Figure 2. Interaction energy deviations in kcal/mol between sDFT with revAPBEK and LMGPA NAKE functionals against the corresponding KS-DFT results. PBE xc functional is adopted in both sDFT and KS-DFT calculations. All geometries are taken from the S22(0.9) set. The indices in the x-axis correspond to complexes listed in Table S1 of the Supporting Information.

Table 1. Summary of the Root-Mean-Square Deviations (RMSD) of the Interaction Energies Computed with sDFT Carried out with revAPBEK and LMGPA NAKEs and the PBE xc Functional against KS-DFT Resultsa

NAKEs

Hydrogen

Dispersion

Mixed

Total

revAPBEK

2.49

8.42

1.76

5.36

LMGPA

2.05

2.54

0.77

1.97

aAll geometries are from the S22(0.9) set, and RMSDs are in kcal/

mol.

where W[ρ](r)

=

ρ(r) ,
ρmax

ρmax

is

the

maximum

value

of

electron

density in the system, and vGGA is the KEDF potential from a

GGA functional (here we choose revAPBEK). In this way, for

the region of space with low electron density, the kinetic

potential is mainly contributed by the GGA functional instead

of the nonlocal part. The procedure in eq 14 cures the

numerical instability of the nonlocal part of the potential.

With the KEDF potential in hand, the kinetic energy can be

evaluated by line integration:

∫ ∫1
Ts[ρ] = ρ(r)dr 0 vTs[ρt ](r)dt

(15)

where ρt(r) = tρ(r).

274

DOI: 10.1021/acs.jpclett.9b03281 J. Phys. Chem. Lett. 2020, 11, 272−279

The Journal of Physical Chemistry Letters

Letter

Figure 3. Interaction energies obtained by sDFT with revAPBEK and LMGPA NAKEs in conjunction with rVV10 xc functional compared against CCSD(T).

Figure 4. Mean absolute deviations (MADs) of interaction energies per molecule for the nonlocal sDFT-rVV10/LMGPA in comparison to semilocal sDFT-PW91/PW91k and sDFT-PW91/PW91k-R results for the S22x5 test set. The semilocal sDFT results are taken from ref 41. All values are given in kJ/mol/molecule.

Table 2. RMSD of the ⟨Δρ⟩ Values (Deﬁned in Eq 16) Obtained by sDFT with Diﬀerent NAKEs (revAPBEK and
LMGPA) for the S22-5 Test Set

r/r0 revAPBEK LMGPA

0.9 0.0600 0.0583

1.0 0.0370 0.0361

1.2 0.0148 0.0148

1.5 0.0042 0.0042

2.0 0.0008 0.0008

Table 3. RMSD of ⟨Δρ⟩ Values (Deﬁned in Eq 16) Arranged by Bonding Type in the S22(0.9) Set

Bond type revAPBEK LMGPA

Hydrogen 0.0805 0.0801

Dispersion 0.0600 0.0561

Mixed 0.0270 0.0261

Total 0.0600 0.0583

We now present pilot calculations aimed at assessing the performance of our newly proposed nonlocal NAKEs based on the following KEDFs: LWT, LMGPA, and LMGPG. We select the S22-5 test set (noncovalently interacting complexes at equilibrium and displaced geometries64) as benchmarks. The molecules are placed in an orthorhombic (cubic) box where the periodic boundary condition is applied. The separations between the studied molecules and their nearest-neighbor periodic images are at least 12 Å. This is a large enough separation to ensure that spurious self-interactions are negligible. Both our new proposed nonlocal NAKEs and the GGA functionals have been implemented in a development

version of the embedded Quantum ESPRESSO (eQE) package.16 All KS-DFT benchmark calculations are performed with the Quantum ESPRESSO (QE) package.65 In both subsystem DFT and KS-DFT calculations, the Perdew− Burke−Ernzerhof (PBE) form of the GGA xc functional63 is employed. In order to show the inﬂuence of the xc functional on the results, the nonlocal rVV1066 functional is also adopted. Ultrasoft pseudopotentials are adopted67 (speciﬁcally the GBRV version 1.468). The plane wave cutoﬀs are 70 and 400 Ry, for the wave functions and density, respectively.
When comparing the interaction energies summarized in Figure S1 of the Supporting Information,69 both the revAPBEK and LMGPA functional reproduce the benchmark within 2 kcal/mol for weakly interacting systems. Decreasing the separation between two fragments from S22(2.0) to S22(0.9) (S22(x) indicates that the distance between the two fragments is given by x × Req, where Req is the equilibrium distance as computed by coupled cluster theory), as by expectations increases the deviation of sDFT and KS-DFT interaction energies. To clearly show the performance of LMGPA and the revAPBEK functionals for strongly interacting conﬁgurations, here we focus on the interaction energies and total electron densities (i.e., the sum of the two subsystems’ densities for sDFT and the total density for KS-DFT) computed for the S22(0.9) case. Results for all other systems are provided in the Supporting Information.69 Figure 2 shows that the LMGPA functional considerably improves the revAPBEK results for all systems with a maximum deviation of the interaction energy of about 5 kcal/mol. This compares quite well against more than 14 kcal/mol for revAPBEK. The only exception is the formic acid dimer in which the two fragments are bonded by a double hydrogen bond. The abnormality of this dimer is revealed in two aspects: it is the only case where the revAPBEK functional overestimates the total energy, and it also is the only case where the revAPBEK functional performs better than LMGPA. This system is also associated with the largest electron density deviation (vide infra), and thus the revAPBEK apparent good performance is due to fortuitous error cancellation.
To further quantify the performance of the LMGPA NAKE functional, we summarize the root-mean-square deviations (RMSD) of the interaction energies sDFT with diﬀerent NAKEs (revAPBEK and LMGPA) from the reference KS-DFT results shown in Table 1. Inspecting the table, it is clear that LMGPA outperforms revAPBEK. The total RMSD for LMGPA is just 1.97 kcal/mol, while revAPBEK results in a RSMD of 5.36 kcal/mol, which is about three times larger than

275

DOI: 10.1021/acs.jpclett.9b03281 J. Phys. Chem. Lett. 2020, 11, 272−279

The Journal of Physical Chemistry Letters

Letter

Figure 5. ⟨Δρ⟩ (deﬁned in eq 16) calculated with two NAKEs: revAPBEK (top) and LMGPA (bottom). PBE xc functional is adopted in both sDFT and KS-DFT calculations. Isosurface cutoﬀs are as follows (L-to-R): 10−3, 5.0 × 10−4, 5.0 × 10−4.

the LMGPA RMSD. We notice that the LMGPA particularly improves the dispersion bound systems for which it obtains much improved results (2.54 kcal/mol) compared to revAPBEK (8.42 kcal/mol). Moreover, the long-standing issue of GGA NAKEs that generate too attractive interaction energy curves (which is also clear from Figure 2) is cured by the LMGPA NAKE functional.
It is now clear that LMGPA delivers good interaction energies with deviations from KS-DFT below 5 kcal/mol (average deviation of less than 2 kcal/mol). We wish to test its ability to deliver accurate interaction energies in comparison to the benchmark CCSD(T) energies.64,70 In a previous formal work by our group40 we showed that once sDFT is associated with an exact Tsnad and a nonlocal xc functional, interaction energies become closer to benchmark results. Thus, here we compare LMGPA and revAPBEK NAKEs in conjunction with the rVV10 xc functional. Due to its nonlocal nature, rVV10 has been shown to be much more reliable than GGA xc functionals in KS-DFT calculations,71 especially for the dispersion bonded systems. In this work, we witness a similar outcome as evident from the benchmarks for each type of bonding systems showed in Figure 3. KS-DFT with both PBE and rVV10 xc functionals are available in the Supporting Information.69 As shown in Figures S4−5, KS-DFT with rVV10 functional can obtain nearly exactly the same results as CCSD(T) for all systems. Figure 3 indicates that in line with the results presented above, LMGPA obtains correct equilibrium bonding length and the order of energies. This is a major improvement in comparison to the revAPBEK results which feature a well characterized deﬁciency of too attractive energy curves.18,40,41 Moreover, in order to show the inﬂuence of the choice of xc functionals on the sDFT performance, we benchmarked the sDFT interaction energy deviations from the corresponding KS-DFT results. As shown in Figure S6, the sDFT results are nearly independent from the choice of xc functional, further reinforcing the conclusion that the nonlocal LMGPA functional resolved the long-standing problem of too attractive energy curves computed by semilocal NAKEs.
It is known that sDFT relies on error cancellation for the description of weak intermolecular interactions. For example, sDFT reproduces the structure and dynamics of molecular liquids18,19 and can reproduce some (not all) interaction energy curves such as the ones presented in Figure S9. Thus, it is not surprising that when a better NAKE is employed, the

agreement against the CCSD(T) benchmark does not necessarily improve. In Figure 4, we reproduce Figure 14 of ref 41, including our nonlocal sDFT results. It is clear from the ﬁgure that when accurate NAKE and xc functionals are used, the agreement against the benchmark improves substantially.
We list in Table S3 the numerical values of the interaction energies for the S22 set computed with PBE/revAPBEK and rVV10/LMGPA against the CCSD(T) reference. There we see that the new nonlocal sDFT does not deteriorate the documented good performance of semilocal sDFT for this data set.40,41
Reproducing the electron density is also important in evaluation of the performance of functionals.72,73 Thus, a more insightful comparison is made by calculating the number of electrons misplaced by sDFT, ⟨Δρ⟩, deﬁned as

∫ ⟨Δρ⟩ = 1 2

ρsDFT (r) − ρKS(r)|dr

(16)

This value is an important quantity, as it vanishes only when sDFT and KS-DFT electron densities coincide. The RMSD of ⟨Δρ⟩ for revAPBEK and LMGPA NAKEs results are showed in Table 2. As expected, when the interaction between the two subsystems transitions from weak to strong (corresponding to from S22(2.0) to S22(0.9)), the ⟨Δρ⟩ value also increases. For the S22(0.9) and S22(1.0) sets, LMGPA performs slightly better than revAPBEK. Since in the weak interaction regime for both NAKEs can generate nearly the same and accurate electron density, we will just focus on the set with the strongest interactions (i.e., the S22(0.9)).
The results for each bonding type are summarized in Table 3. Compared with revAPBEK, LMGPA NAKE obtains smaller ⟨Δρ⟩ for all cases indicating that it can generate more accurate electron density for all types of bonding. We select the complexes which generate the largest ⟨Δρ⟩ for each type of bonding and plot the corresponding isosurface plots of density diﬀerence (compared with KS-DFT) for sDFT with revAPBEK and LMGPA; see Figure 5. As expected, the density diﬀerence
mainly occurs on the overlap regions between the two subsystems. We now have a visual of the fact that LMGPA can generate more accurate electron densities compared to revAPBEK, since the density diﬀerence region is much smaller than the revAPBEK results.
In the previous analysis, we focused on LMGPA with a = 0.01 in the deﬁnition of the smooth Thomas−Fermi−von

276

DOI: 10.1021/acs.jpclett.9b03281 J. Phys. Chem. Lett. 2020, 11, 272−279

The Journal of Physical Chemistry Letters

Letter

Weizsäcker, STV, functional eq 12. To benchmark the inﬂuence of the choice of a and the performance of each kernel, both a = 0.01 together with a = 0.1 and other functionals (LWT and LMGPG) are also compared in the Supporting Information.69 As shown in Figure S2, all these nonlocal functionals result in improved interaction energies compared against revAPBEK. In terms of electron density, Figures S7 and S8 show that all of the new nonlocal NAKEs obtain better results than revAPBEK.
In conclusion, for the ﬁrst time we employed nonlocal nonadditive kinetic energy functionals in subsystem DFT simulations. Our approach relies on (1) adopting latestgeneration nonlocal functionals featuring a fully density dependent kernel, correctly tackling systems with localized and inhomogeneous electron density; (2) suppressing numerical instabilities in the evaluation of the von Weizsac̈ ker KEDF and nonlocal KEDF in the low electron density regions. Our approach leads to numerically stable and accurate subsystem DFT simulations. Benchmark tests against the well-known S22-5 test set indicate that our new approach not only can reproduce accurate interaction energies across bonding types (hydrogen, dispersion, and mixed), but we also better reproduce the benchmark electron density. In addition, the new nonlocal subsystem DFT approach (that includes nonlocal NAKE and nonlocal xc functional) obtains correct equilibrium bonding lengths and correct shape of the energy curves compared to CCSD(T) energy curves, which have been a long-standing challenge for semilocal sDFT.
■ ASSOCIATED CONTENT
*S Supporting Information
The Supporting Information is available free of charge at https://pubs.acs.org/doi/10.1021/acs.jpclett.9b03281.
Interaction energy deviations; S22-5 dimer/complex and corrresponding index number; total energy deviations; ⟨Δρ⟩; ⟨Δρ⟩NAKE/⟨Δρ⟩revAPBEK ratio; and potential energy curves (PDF)
■ AUTHOR INFORMATION
Corresponding Author *E-mail: m.pavanello@rutgers.edu.
ORCID
Michele Pavanello: 0000-0001-8294-7481
Notes The authors declare no competing ﬁnancial interest.
■ ACKNOWLEDGMENTS
We gratefully acknowledge discussions with Pablo Ramos and Xuecheng Shao. This material is based upon work supported by the National Science Foundation under Grant No. CHE1553993. The authors acknowledge the Oﬃce of Advanced Research Computing (OARC) at Rutgers, The State University of New Jersey for providing access to the Amarel cluster and associated research computing resources that have contributed to the results reported here. URL: http://oarc. rutgers.edu.
■ REFERENCES
(1) Kohn, W.; Sham, L. J. Self-Consistent Equations Including Exchange and Correlation Effects. Phys. Rev. 1965, 140, 1133−1138. (2) Senn, H. M.; Thiel, W. QM/MM Methods for Biomolecular Systems. Angew. Chem., Int. Ed. 2009, 48, 1198−1229.

(3) Shurki, A.; Warshel, A. Structure/Function Correlations of Proteins Using MM, QM/MM, and Related Approaches: Methods, Concepts, Pitfalls, and Current Progress. Adv. Protein Chem. 2003, 66, 249−313. (4) Wesolowski, T. A.; Shedge, S.; Zhou, X. Frozen-Density Embedding Strategy for Multilevel Simulations of Electronic Structure. Chem. Rev. 2015, 115, 5891−5928. (5) Gomes, A. S. P.; Jacob, C. R. Quantum-chemical embedding methods for treating local electronic excitations in complex chemical systems. Annu. Rep. Prog. Chem., Sect. C: Phys. Chem. 2012, 108, 222− 277. (6) Jacob, C. R.; Neugebauer, J. Subsystem density-functional theory. WIREs: Comput. Mol. Sci. 2014, 4, 325−362. (7) Krishtal, A.; Sinha, D.; Genova, A.; Pavanello, M. Subsystem Density-Functional Theory as an Effective Tool for Modeling Ground and Excited States, their Dynamics, and Many-Body Interactions. J. Phys.: Condens. Matter 2015, 27, 183202. (8) Nafziger, J.; Wasserman, A. Density-Based Partitioning Methods for Ground-State Molecular Calculations. J. Phys. Chem. A 2014, 118, 7623−7639. (9) Senatore, G.; Subbaswamy, K. Density dependence of the dielectric constant of rare-gas crystals. Phys. Rev. B: Condens. Matter Mater. Phys. 1986, 34, 5754. (10) Wesolowski, T. A.; Warshel, A. Frozen Density Functional Approach for ab Initio Calculations of Solvated Molecules. J. Phys. Chem. 1993, 97, 8050. (11) Yang, W. Direct Calculation of Electron Density in DensityFunctional Theory. Phys. Rev. Lett. 1991, 66, 1438−1441. (12) Huang, C.; Pavone, M.; Carter, E. A. Quantum mechanical embedding theory based on a unique embedding potential. J. Chem. Phys. 2011, 134, 154110. (13) Gritsenko, O. V. In Recent Advances in Orbital-Free Density Functional Theory; Wesolowski, T. A., Wang, Y. A., Eds.; World Scientiﬁc: Singapore, 2013; Chapter 12, pp 355−365. (14) Goodpaster, J. D.; Ananth, N.; Manby, F. R.; Miller, T. F., III Exact Nonadditive Kinetic Potentials for Embedded Density Functional Theory. J. Chem. Phys. 2010, 133, 084103. (15) Jacob, C. R.; Neugebauer, J.; Visscher, L. A Flexible Implementation of Frozen-Density Embedding for Use in Multilevel Simulations. J. Comput. Chem. 2008, 29, 1011−1018. (16) Genova, A.; Ceresoli, D.; Krishtal, A.; Andreussi, O.; DiStasio, R., Jr.; Pavanello, M. eQE  A Densitiy Functional Embedding Theory Code For The Condensed Phase. Int. J. Quantum Chem. 2017, 117, No. e25401. (17) Andermatt, S.; Cha, J.; Schiffmann, F.; VandeVondele, J. Combining Linear-Scaling DFT with Subsystem DFT in Born− Oppenheimer and Ehrenfest Molecular Dynamics Simulations: From Molecules to a Virus in Solution. J. Chem. Theory Comput. 2016, 12, 3214−3227. (18) Mi, W.; Ramos, P.; Maranhao, J.; Pavanello, M. Ab Initio Structure and Dynamics of CO2 at Supercritical Conditions. J. Phys. Chem. Lett. 2019, 10, 7554−7559. (19) Genova, A.; Ceresoli, D.; Pavanello, M. Avoiding Fractional Electrons in Subsystem DFT Based Ab-Initio Molecular Dynamics Yields Accurate Models For Liquid Water and Solvated OH Radical. J. Chem. Phys. 2016, 144, 234105. (20) Neugebauer, J.; Louwerse, M. J.; Baerends, E. J.; Wesolowski, T. A. The merits of the frozen-density embedding scheme to model solvatochromic shifts. J. Chem. Phys. 2005, 122, 094115. (21) Neugebauer, J. Chromophore-Specific Theoretical Spectroscopy: From Subsystem Density Functional Theory to Mode-Specific Vibrational Spectroscopy. Phys. Rep. 2010, 489, 1−87. (22) Jacob, C. R.; Visscher, L. Calculation of Nuclear Magnetic Resonance Shieldings Using Frozen-Density Embedding. J. Chem. Phys. 2006, 125, 194104. (23) Bulo, R. E.; Jacob, C. R.; Visscher, L. NMR Solvent Shifts of Acetonitrile from Frozen Density Embedding Calculations. J. Phys. Chem. A 2008, 112, 2640−2647.

277

DOI: 10.1021/acs.jpclett.9b03281 J. Phys. Chem. Lett. 2020, 11, 272−279

The Journal of Physical Chemistry Letters

Letter

(24) Neugebauer, J.; Louwerse, M. J.; Belanzoni, P.; Wesolowski, T. A.; Baerends, E. J. Modeling Solvent Effects on Electron Spin Resonance Hyperfine Couplings by Frozen-Density Embedding. J. Chem. Phys. 2005, 123, 114101. (25) Kevorkyants, R.; Wang, X.; Close, D. M.; Pavanello, M. Calculating Hyperfine Couplings in Large Ionic Crystals Containing Hundreds of QM Atoms: Subsystem DFT is the Key. J. Phys. Chem. B 2013, 117, 13967−13974. (26) Wesolowski, T. A. Application of the DFT-based embedding scheme using an explicit functional of the kinetic energy to determine the spin density of Mg+ embedded in Ne and Ar matrices. Chem. Phys. Lett. 1999, 311, 87−92. (27) Neugebauer, J.; Curutchet, C.; Munioz-Losa, A.; Mennucci, B. A Subsystem TDDFT Approach for Solvent Screening Effects on Excitation Energy Transfer Couplings. J. Chem. Theory Comput. 2010, 6, 1843−1851. (28) Casida, M. E.; Wesolowski, T. A. Generalization of the Kohn− Sham Equations with Constrained Electron Density Formalism and Its Time-Dependent Response Theory Formulation. Int. J. Quantum Chem. 2004, 96, 577−588. (29) Pavanello, M. On the Subsystem Formulation of LinearResponse Time-Dependent DFT. J. Chem. Phys. 2013, 138, 204118. (30) García-Lastra, J. M.; Wesolowski, T. A.; Barriuso, M. T.; Aramburu, J. A.; Moreno, M. Optical and vibrational properties of MnF64− complexes in cubic fluoroperovskites: insight through embedding calculations using Kohn-Sham equations with constrained electron density. J. Phys.: Condens. Matter 2006, 18, 1519−1534. (31) Ramos, P.; Pavanello, M. Constrained Subsystem DensityFunctional Theory. Phys. Chem. Chem. Phys. 2016, 18, 21172. (32) Umerbekova, A.; Zhang, S.-F.; Kumar, S. P.; Pavanello, M. Dissecting energy level renormalization and polarizability enhancement of molecules at surfaces with subsystem TDDFT. Eur. Phys. J. B 2018, 91, 214. (33) Pavanello, M.; Van Voorhis, T.; Visscher, L.; Neugebauer, J. An Accurate and Linear-Scaling Method for Calculating Charge-Transfer Excitation Energies and Diabatic Couplings. J. Chem. Phys. 2013, 138, 054101. (34) Solovyeva, A.; Pavanello, M.; Neugebauer, J. Describing longrange charge-separation processes with subsystem density-functional theory. J. Chem. Phys. 2014, 140, 164103. (35) Ramos, P.; Pavanello, M. Performance of Frozen Density Embedding for Modeling Hole Transfer Reactions. J. Phys. Chem. B 2015, 119, 7541−7557. (36) Tölle, J.; Gomes, A. S. P.; Ramos, P.; Pavanello, M. Chargedcell periodic DFT simulations via an impurity model based on density embedding: Application to the ionization potential of liquid water. Int. J. Quantum Chem. 2019, 119, No. e25801. (37) Götz, A.; Beyhan, S.; Visscher, L. Performance of Kinetic Energy Functionals for Interaction Energies in a Subsystem Formulation of Density Functional Theory. J. Chem. Theory Comput. 2009, 5, 3161−3174. (38) Wesolowski, T. A.; Chermette, H.; Weber, J. Accuracy of approximate kinetic energy functionals in the model of Kohn-Sham equations with constrained electron density: The FH···NCH complex as a test case. J. Chem. Phys. 1996, 105, 9182. (39) Laricchia, S.; Constantin, L. A.; Fabiano, E.; Sala, F. D. Laplacian-Level Kinetic Energy Approximations Based on the FourthOrder Gradient Expansion: Global Assessment and Application to the Subsystem Formulation of Density Functional Theory. J. Chem. Theory Comput. 2014, 10, 164−179. (40) Sinha, D.; Pavanello, M. Exact Kinetic Energy Enables Accurate Evaluation of Weak Interactions by the FDE-vdW Method. J. Chem. Phys. 2015, 143, 084120. (41) Schlüns, D.; Klahr, K.; Mück-Lichtenfeld, C.; Visscher, L.; Neugebauer, J. Subsystem-DFT potential-energy curves for weakly interacting systems. Phys. Chem. Chem. Phys. 2015, 17, 14323−14341. (42) Chacoń , E.; Alvarellos, J. E.; Tarazona, P. Nonlocal kinetic energy functional for nonhomogeneous electron systems. Phys. Rev. B: Condens. Matter Mater. Phys. 1985, 32, 7868−7877.

(43) Jiang, K.; Nafziger, J.; Wasserman, A. Constructing a nonadditive non-interacting kinetic energy functional approximation for covalent bonds from exact conditions. J. Chem. Phys. 2018, 149, 164112. (44) Wesolowski, T. A.; Wang, Y. A. Recent progress in orbital-free density functional theory; World Scientiﬁc, 2013; Vol. 6. (45) Karasiev, V. V.; Trickey, S. B. Issues and challenges in orbitalfree density functional calculations. Comput. Phys. Commun. 2012, 183, 2519−2527. (46) Witt, W. C.; Beatriz, G.; Dieterich, J. M.; Carter, E. A. Orbitalfree density functional theory for materials research. J. Mater. Res. 2018, 33, 777−795. (47) Nafziger, J.; Wasserman, A. Fragment-based treatment of delocalization and static correlation errors in density-functional theory. J. Chem. Phys. 2015, 143, 234105. (48) Pavanello, M.; Neugebauer, J. Modelling Charge Transfer Reactions with the Frozen Density Embedding Formalism. J. Chem. Phys. 2011, 135, 234103. (49) Ramos, P.; Mankarious, M.; Pavanello, M. Practical Aspects in Computational Chemistry IV; Springer, 2016; Chapter 4. (50) Fermi, E. Un Metodo Statistico per la Determinazione di alcune Prioprietà dell’Atomo. Rend. Accad. Naz. Lincei 1927, 6, 602− 607. (51) Thomas, L. A. The calculation of atomic fields. Math. Proc. Cambridge Philos. Soc. 1927, 23, 542−548. (52) von Weizsac̈ ker, C. F. Zur Theorie der Kernmassen. Eur. Phys. J. A 1935, 96, 431−458. (53) Wang, Y. A.; Carter, E. A. In Theoretical Methods in Condensed Phase Chemistry; Schwartz, S. D., Ed.; Kluwer: Dordrecht, 2000; pp 117−184. (54) Wang, Y. A.; Govind, N.; Carter, E. A. Orbital-free kineticenergy functionals for the nearly free electron gas. Phys. Rev. B: Condens. Matter Mater. Phys. 1998, 58, 13465−13471. (55) Wang, Y. A.; Govind, N.; Carter, E. A. Orbital-free kineticenergy density functionals with a density-dependent kernel. Phys. Rev. B: Condens. Matter Mater. Phys. 1999, 60, 16350−16358. (56) Huang, C.; Carter, E. A. Nonlocal orbital-free kinetic energy density functional for semiconductors. Phys. Rev. B: Condens. Matter Mater. Phys. 2010, 81, 045206. (57) Wang, L.-W.; Teter, M. P. Kinetic-energy functional of the electron density. Phys. Rev. B: Condens. Matter Mater. Phys. 1992, 45, 13196−13220. (58) Mi, W.; Genova, A.; Pavanello, M. Nonlocal kinetic energy functionals by functional integration. J. Chem. Phys. 2018, 148, 184107. (59) Pearson, M.; Smargiassi, E.; Madden, P. A. Ab initio molecular dynamics with an orbital-free density functional. J. Phys.: Condens. Matter 1993, 5, 3221−3240. (60) Smargiassi, E.; Madden, P. A. Orbital-free kinetic-energy functionals for first-principles molecular dynamics. Phys. Rev. B: Condens. Matter Mater. Phys. 1994, 49, 5220−5226. (61) Perrot, F. Hydrogen-hydrogen interaction in an electron gas. J. Phys.: Condens. Matter 1994, 6, 431−446. (62) Mi, W.; Pavanello, M. Orbital-Free DFT Correctly Models Quantum Dots When Asymptotics, Nonlocality and Nonhomogeneity Are Accounted For. Phys. Rev. B: Condens. Matter Mater. Phys. 2019, 100, 041105. (63) Perdew, J. P.; Burke, K.; Ernzerhof, M. Generalized Gradient Approximation Made Simple. Phys. Rev. Lett. 1996, 77, 3865−3868. (64) Grafova, L.; Pitonak, M.; Rezac, J.; Hobza, P. Comparative Study of Selected Wave Function and Density Functional Methods for Noncovalent Interaction Energy Calculations Using the Extended S22 Data Set. J. Chem. Theory Comput. 2010, 6, 2365−2376. (65) Giannozzi, P.; Baroni, S.; Bonini, N.; Calandra, M.; Car, R.; Cavazzoni, C.; Ceresoli, D.; Chiarotti, G. L.; Cococcioni, M.; Dabo, I.; et al. QUANTUM ESPRESSO: a modular and open-source software project for quantum simulations of materials. J. Phys.: Condens. Matter 2009, 21, 395502.

278

DOI: 10.1021/acs.jpclett.9b03281 J. Phys. Chem. Lett. 2020, 11, 272−279

The Journal of Physical Chemistry Letters
(66) Sabatini, R.; Gorni, T.; De Gironcoli, S. Nonlocal van der Waals density functional made simple and efficient. Phys. Rev. B: Condens. Matter Mater. Phys. 2013, 87, 041108. (67) Vanderbilt, D. Soft self-consistent pseudopotentials in a generalized eigenvalue formalism. Phys. Rev. B: Condens. Matter Mater. Phys. 1990, 41, 7892−7895. (68) Garrity, K. F.; Bennett, J. W.; Rabe, K. M.; Vanderbilt, D. Pseudopotentials for high-throughput DFT calculations. Comput. Mater. Sci. 2014, 81, 446−452. (69) See Supporting Information for additional tables and ﬁgures. (70) Raghavachari, K.; Trucks, G. W.; Pople, J. A.; Head-Gordon, M. A fifth-order perturbation comparison of electron correlation theories. Chem. Phys. Lett. 1989, 157, 479−483. (71) Vydrov, O. A.; Van Voorhis, T. Benchmark Assessment of the Accuracy of Several van der Waals Density Functionals. J. Chem. Theory Comput. 2012, 8, 1929−1934. (72) Medvedev, M. G.; Bushmarinov, I. S.; Sun, J.; Perdew, J. P.; Lyssenko, K. A. Density functional theory is straying from the path toward the exact functional. Science 2017, 355, 49−52. (73) Wasserman, A.; Nafziger, J.; Jiang, K.; Kim, M.-C.; Sim, E.; Burke, K. The Importance of Being Inconsistent. Annu. Rev. Phys. Chem. 2017, 68, 555−581.

Letter

279

DOI: 10.1021/acs.jpclett.9b03281 J. Phys. Chem. Lett. 2020, 11, 272−279

